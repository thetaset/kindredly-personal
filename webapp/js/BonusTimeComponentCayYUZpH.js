import{a as f,_ as g}from"./components.globalDizx_NTC.js";import{d as h,j as n,k as i,K as a,Q as r,F as T,P as v,z as L,s as w,r as d,i as o,R as _}from"./@vueC3Nhqlrl.js";const y=h({name:"BonusTimeComponent",mixins:[f],props:{userId:{type:String,default:null,required:!0}},data(){return{usageLimitUrlPattern:"",timeLimitSettings:null,contentUsageLimits:[],defaultUsageLimits:[],extraTimeNew:0,extraTimeUsageLimitUrlPattern:null,extraTimeOptionsMin:[{text:"5 min",value:5},{text:"15 min",value:15},{text:"30 min",value:30},{text:"1 hr",value:60}],loading:!1}},mounted(){},computed:{usageLimitUrlPatternOptions(){var t;return(t=this.contentUsageLimits)==null?void 0:t.map(e=>({text:e.data.patterns.join(", "),value:e.data.patterns.join(", ")}))}},methods:{async loadData(){var m,l;const t=await this.apiReq("/user/options/get",{userId:this.userId,refresh:!0}),e=t.result.usageLimitsData||{};(e==null?void 0:e.version)!=2,this.defaultUsageLimits=e.defaultUsageLimits||[],this.contentUsageLimits=e.contentUsageLimits||[],this.timeLimitSettings=t.result.timeLimitSettings||null,!((m=this.timeLimitSettings)!=null&&m.extraTimeExpires)||this.timeLimitSettings.extraTimeExpires<Date.now()?this.timeLimitSettings=null:this.extraTimeNew=((l=this.timeLimitSettings)==null?void 0:l.extraTimeDefault)||0},async addExtraTime(t){this.extraTimeNew+=t},async saveExtraTime(){this.loading=!0,this.extraTimeNew=Math.max(0,this.extraTimeNew);let t={...this.timeLimitSettings};if(this.extraTimeNew==0||!this.extraTimeNew)t=null;else{let e=new Date;e.setHours(23,59,59,999),t={...t,extraTimeDefault:this.extraTimeNew,extraTimeExpires:e.getTime()}}try{await this.apiReq("/user/options/update",{userId:this.userId,options:{timeLimitSettings:t}})}catch{this.showToast("Error saving extra time",{variant:"danger"})}this.loading=!1,this.$emit("updated")}},created(){this.loadData()}}),b={class:"d-flex flex-column mt-4"},N={class:"d-flex align-items-center flex-gap-sm justify-content-center mb-4"},S={class:"mb-4 d-flex flex-gap-sm flex-wrap justify-content-center"},U=["onClick"],E={class:"mb-4 d-flex align-items-center flex-gap-sm justify-content-center"},C={class:"text-muted"},k={key:0,class:"mt-2 ms-auto"};function D(t,e,m,l,V,$){const p=d("b-form-input"),u=d("b-icon"),x=d("b-button");return o(),n("div",null,[i("div",b,[i("div",null,[i("div",N,[e[2]||(e[2]=i("div",null,"Extra Time:",-1)),a(p,{type:"number",style:{width:"5rem"},modelValue:t.extraTimeNew,"onUpdate:modelValue":e[0]||(e[0]=s=>t.extraTimeNew=s)},null,8,["modelValue"]),e[3]||(e[3]=r(" minutes "))]),i("div",S,[(o(!0),n(T,null,v(t.extraTimeOptionsMin,(s,c)=>(o(),n("div",{role:"button",class:"border rounded p-1 px-2",key:c,onClick:j=>t.addExtraTime(s.value)},[a(u,{icon:"plus"}),r(" "+_(s.text),1)],8,U))),128))])]),i("div",E,[i("div",C,[a(u,{icon:"info-circle",class:"me-1"}),e[4]||(e[4]=r(" Extra time expires at end of the day "))])]),t.isAdminUser?(o(),n("div",k,[a(x,{onClick:e[1]||(e[1]=s=>t.saveExtraTime()),variant:"primary"},{default:L(()=>e[5]||(e[5]=[r("Save ")])),_:1})])):w("",!0)])])}const P=g(y,[["render",D]]);export{P as B};
