const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/SwitchUserPFuEE6Qx.js","js/TIIconDefaultCMdnLD-P.js","js/components.globalBic2x0kT.js","js/@vueC3Nhqlrl.js","js/vue3-toastifyDll2FbVh.js","assets/vue3-toastify.css","js/@capacitorCjBcbZvA.js","js/bootstrap-vue-nextDnMzdrWQ.js","assets/bootstrap-vue-next.css","assets/components.css","assets/TIIconDefault.css","js/UpdatePinCsCDl-EF.js"])))=>i.map(i=>d[i]);
import{_ as P}from"./@capacitorCjBcbZvA.js";import{P as R,T as L}from"./TIIconDefaultCMdnLD-P.js";import{I as $}from"./ItemListBk-h_1t6.js";import{P as M}from"./PublishedCollectionsByUser_czvM5BY.js";import{a as T,p as x,l as O,aX as y,_ as V}from"./components.globalBic2x0kT.js";import{U as q}from"./UsageLogComponentBOKVuFcb.js";import{d as B,aa as S,j as r,F as w,K as i,z as c,k as o,R as m,s as n,Q as d,P as j,m as v,r as u,i as t,p as E}from"./@vueC3Nhqlrl.js";import"./browserTabsB3WsZHRs.js";import"./TIFeedbackInfoC6PM9-5H.js";import"./ItemImagelPteIRA_.js";import"../kindredapp.js";import"./bootstrap-vue-nextDnMzdrWQ.js";import"./vue-routerB6Jsgi62.js";import"./vue-plugin-load-scriptXwA-LyvJ.js";import"./bootstrapDQG5F40S.js";import"./@popperjsCCtJ9KiL.js";import"./@mozillaCDB2aYYy.js";import"./vue3-toastifyDll2FbVh.js";import"./PopCollectionSelectorCwff-9C9.js";import"./CreateCollectionDxlS16jr.js";import"./ai_lookup_utilszDX_hcwM.js";import"./PlaceholderListDgoFc2vF.js";import"./UsageSummaryyVrjsInG.js";import"./BonusTimeComponentCO2fuuUD.js";import"./usageBVbzi9Go.js";const N=B({name:"UserProfile",mixins:[T],components:{ProfileImage:R,TIIconDefault:L,ItemList:$,PublishedCollectionsByUser:M,UsageLogComponent:q,SwitchUser:S(()=>P(()=>import("./SwitchUserPFuEE6Qx.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])))},data(){return{viewAsUserId:void 0,viewAsUser:void 0,userId:null,user:null,errorMessage:null,loading:!0,showVisibleCollections:!1,collections:[],fields:[{key:"name",label:"Library",sortable:!1}],reactionList:[],loadingReactions:!1,commentList:[],loadingComments:!1,recentCollections:[],loadingRecentCollection:!1}},mounted(){},computed:{isGuardianOf(){return this.user&&this.user.relationship=="account"&&this.isAdminUser&&this.user._id!=this.currentUserId&&this.user.type=="restricted"},isCurrentUser(){return this.user&&this.user._id==this.currentUserId},isInAccount(){return this.user&&this.user.relationship=="account"},items(){return this.collections==null?[]:this.collections}},methods:{prettyTimePast:x,async loadreactions(){if(!this.isInAccount)return;this.loadingReactions=!0;let e=await this.sendReq("/client/items/listWithFeedback",{userId:this.userId,feedbackType:"reactionDate",limit:10});if(e!=null&&e.success){let s=O(e.result,200,!1);s=s.slice(0,15),this.reactionList=s.map(h=>{var f;return h.feedback.reactionObj=y((f=h.feedback)==null?void 0:f.reaction),h}),this.errorMessage=null}else console.error("Error:",e.message),this.errorMessage=e.message;this.$nextTick(()=>{this.loadingReactions=!1})},getReaction:y,async loadRecentComments(){this.loadingComments=!0;let e=await this.sendReq("/client/user/comment/list",{userId:this.userId,limit:10});e!=null&&e.success?(this.commentList=e.result,this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message),this.$nextTick(()=>{this.loadingComments=!1})},async loadCollections(){this.loadingRecentCollection=!0;let e=await this.sendReq("/client/collections/recent",{userId:this.userId,limit:10});e!=null&&e.success?(this.recentCollections=e.result,this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message),this.$nextTick(()=>{this.loadingRecentCollection=!1})},async _loadUser(){const e=await this.apiReq("/user/profile/get",{userProfileId:this.userId,viewAsUserId:this.viewAsUserId});this.user=e.result},async _loadViewAsUser(){if(!this.viewAsUserId)return;const e=await this.apiReq("/user/profile/get",{userProfileId:this.viewAsUserId});this.viewAsUser=e.result},async loadPage(){this.loading=!0;try{await this._loadUser(),await this._loadViewAsUser(),await this.loadreactions()}catch(e){console.error(e),this.errorMessage=e.message}this.loading=!1}},created(){this.userId=this.$route.params.userId,this.viewAsUserId=this.$route.query.viewAsUserId,this.loadPage()}}),D={class:"container"},F={class:"d-flex flex-gap-1 align-items-center mt-3 mb-2"},G={key:0},z={class:"h2 mb-0"},H={key:0,title:"Username",class:"text-muted small"},K={key:1},Q={class:"h2 mb-0"},W={key:0,class:"mb-2"},X={class:"d-flex flex-gap-1 align-items-center justify-content-between flex-wrap"},J={class:"text-muted"},Y={key:0},Z={key:1},ee={key:0,class:"text-muted d-flex align-items-center flex-gap-sm"},se={class:"d-flex flex-gap-1 flex-wrap align-items-center my-3"},te={key:0},re={key:1},ie={key:2},oe={key:3},ne={key:1,class:"mb-4"},le={class:"d-flex flex-gap-1 align-items-center my-4 flex-wrap"},ae={key:0},de={key:1},ue={key:2},ce=["onClick"],me={class:""},pe={class:"text-muted d-flex flex-gap-1"},he={class:"nowrap"},fe=["onClick"],ge={key:0,class:"text-muted mt-2 ms-2"},ye={key:2},we={key:1,class:"card p-3 m-3 alert-info text-center mx-auto",style:{"max-width":"400px"}};function ve(e,s,h,f,be,_e){const b=u("SwitchUser"),_=u("b-modal"),I=u("ProfileImage"),l=u("b-icon"),p=u("b-link"),g=u("TIcon"),k=u("router-link"),U=u("PublishedCollectionsByUser"),C=u("UsageLogComponent");return t(),r("div",null,[e.user?(t(),r(w,{key:0},[i(_,{lazy:"true",id:"switch-user2-modal",title:"Switch User","hide-footer":"","no-close-on-backdrop":""},{default:c(()=>[i(b)]),_:1}),o("div",D,[o("div",F,[i(I,{profileImage:e.user.profileImage,width:64},null,8,["profileImage"]),e.isFamilyMemberId(e.user._id)?(t(),r("div",G,[o("div",z,m(e.user.displayedName||e.user.username),1),e.user.displayedName?(t(),r("div",H,m(e.user.username),1)):n("",!0)])):(t(),r("div",K,[o("div",Q,m(e.user.username),1)]))]),e.viewAsUser?(t(),r("div",W,[i(l,{icon:"exclamation-circle-fill"}),d(" Viewing friend profile as "+m(e.viewAsUser.username),1)])):n("",!0),o("div",X,[o("div",null,[o("div",J,[e.user.relationship=="account"&&e.user._id!=e.currentUserId?(t(),r("span",Y,"Family Member "+m(e.user.type=="admin"?" (Admin User)":"(Restricted User)"),1)):e.user.relationship=="friend"?(t(),r("span",Z,"Friend")):n("",!0)]),e.user._id==e.currentUserId?(t(),r("div",ee,[i(l,{icon:"exclamation-circle-fill"}),s[0]||(s[0]=d(" This is your profile. "))])):n("",!0)]),o("div",se,[e.user.publicId!=null?(t(),r("div",te,[i(p,{class:"px-3 py-2 hoverrow border pill text-muted nowrap",to:`/profile/${e.user.publicId}`},{default:c(()=>[i(l,{icon:"person-square"}),s[1]||(s[1]=d(" Public Profile"))]),_:1},8,["to"])])):n("",!0),e.user._id==e.currentUserId?(t(),r("div",re,[i(p,{class:"px-3 py-2 hoverrow border pill hoverrow nowrap text-muted",to:"/settings"},{default:c(()=>[i(l,{icon:"gear"}),s[2]||(s[2]=d(" My Settings"))]),_:1})])):e.isGuardianOf?(t(),r("div",ie,[i(p,{class:"px-3 py-2 hoverrow border pill nowrap text-muted",to:`/manage/user/${e.user._id}/loginprefs?menu=true`},{default:c(()=>[i(l,{icon:"gear"}),s[3]||(s[3]=d(" User Settings"))]),_:1},8,["to"])])):n("",!0),e.isGuardianOf?(t(),r("div",oe,[i(p,{class:"px-3 py-2 hoverrow border pill nowrap text-muted",to:`/manage/user/${e.user._id}/activity`},{default:c(()=>[i(l,{icon:"clock-history"}),s[4]||(s[4]=d(" Browse History "))]),_:1},8,["to"])])):n("",!0)])]),s[10]||(s[10]=o("hr",null,null,-1)),e.isInAccount?(t(),r("div",ne,[o("div",le,[e.user._id!=e.currentUserId?(t(),r("div",ae,[i(p,{to:`/userLibrary/${e.user._id}`,class:"px-3 py-2 hoverrow border larger rounded shadow-sm align-items-center d-flex flex-gap-sm nowrap dl-color"},{default:c(()=>[i(g,{name:"library",width:20}),s[5]||(s[5]=d(" Library "))]),_:1},8,["to"])])):(t(),r("div",de,[i(k,{to:"/library",class:"px-3 py-2 hoverrow border larger rounded shadow-sm align-items-center d-flex flex-gap-sm dl-color nowrap"},{default:c(()=>[i(g,{name:"library",width:20}),s[6]||(s[6]=d(" My Library "))]),_:1})])),e.isGuardianOf?(t(),r("div",ue,[i(p,{class:"px-3 py-2 hoverrow border larger rounded shadow-sm nowrap dl-color align-items-center d-flex flex-gap-sm",to:`/userLibrary/${e.user._id}?show=addContent`},{default:c(()=>[i(l,{icon:"plus-lg"}),s[7]||(s[7]=d(" Add Content"))]),_:1},8,["to"])])):n("",!0)]),o("div",null,[s[8]||(s[8]=o("div",{class:"h4"},"Recent Shared Reactions",-1)),(t(!0),r(w,null,j(e.reactionList,a=>(t(),r("div",{key:a._id,class:"d-flex flex-gap-sm align-items-center justify-content-between my-3"},[o("div",{role:"button",onClick:A=>e.visit(a),class:"d-flex flex-gap-1 align-items-center truncatetext"},[a.feedback.reactionObj?(t(),v(l,{key:0,icon:`${a.feedback.reactionObj.icon}-fill`,class:E(a.feedback.reactionObj.classes)},null,8,["icon","class"])):n("",!0),o("span",me,m(a.name||a.url),1)],8,ce),o("div",pe,[o("div",he,m(e.prettyTimePast(a.feedback.reactionDate))+" ago ",1),o("div",{role:"button",onClick:A=>e.visit(a,{},!0)},[i(l,{icon:"info-square"})],8,fe)])]))),128)),!e.loadingReactions&&e.reactionList.length==0?(t(),r("div",ge," No reactions shared yet. ")):n("",!0)])])):n("",!0),e.user.publicId?(t(),r("div",ye,[s[9]||(s[9]=o("div",{class:"h4"},"Published Collections",-1)),i(U,{publicId:e.user.publicId,viewAsUserId:e.viewAsUserId,includeAll:!0},null,8,["publicId","viewAsUserId"])])):n("",!0),e.isAdminUser&&e.user.type=="restricted"?(t(),v(C,{key:3,"hide-details":!0,userId:e.user._id},null,8,["userId"])):n("",!0)])],64)):n("",!0),e.errorMessage&&!e.loading?(t(),r("div",we," Error: "+m(e.errorMessage),1)):n("",!0)])}const Ke=V(N,[["render",ve]]);export{Ke as default};
