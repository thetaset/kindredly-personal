import{a as T,p as _,aj as x,l as B,_ as b}from"./components.globalBic2x0kT.js";import{I as U}from"./ItemListBk-h_1t6.js";import{d as C,j as h,k as a,K as n,z as c,r as o,i as u,R as p,F as L,P as k,m as D,Q as $}from"./@vueC3Nhqlrl.js";import"./vue3-toastifyDll2FbVh.js";import"./@capacitorCjBcbZvA.js";import"./bootstrap-vue-nextDnMzdrWQ.js";import"./browserTabsB3WsZHRs.js";import"./TIIconDefaultCMdnLD-P.js";import"./TIFeedbackInfoC6PM9-5H.js";import"./ItemImagelPteIRA_.js";import"../kindredapp.js";import"./vue-routerB6Jsgi62.js";import"./vue-plugin-load-scriptXwA-LyvJ.js";import"./bootstrapDQG5F40S.js";import"./@popperjsCCtJ9KiL.js";import"./@mozillaCDB2aYYy.js";import"./PopCollectionSelectorCwff-9C9.js";import"./CreateCollectionDxlS16jr.js";import"./ai_lookup_utilszDX_hcwM.js";import"./PlaceholderListDgoFc2vF.js";const q=C({name:"UserItems",mixins:[T],components:{ItemList:U},data(){return{targetUserId:null,loading:!0,results:[],searchText:void 0,feedbackField:null,loadAmount:35,errorMessage:null,listType:null,orderBy:"recentlyAdded",orderByOptions:[{value:"name",text:"Name"},{value:"recentlyAdded",text:"Date"}]}},mounted(){},computed:{orderByText(){var e;return(e=this.orderByOptions.find(t=>t.value==this.orderBy))==null?void 0:e.text}},methods:{prettyTimePast:_,async runSearch(){this.loading=!0,await this.loadData();let e=this.results;this.searchText&&(e=e.filter(t=>{const s=t==null?void 0:t.name;if(s&&s.toLowerCase().includes(this.searchText.toLowerCase()))return!0;const r=t==null?void 0:t.description;return!!(r&&r.toLowerCase().includes(this.searchText.toLowerCase()))})),this.results=e,this.loading=!1},selectOrderBy(e){this.orderBy=e.value,this.updateOrder()},updateOrder(){let e=this.results;this.results=[],this.orderBy=="recentlyAdded"?e.sort((t,s)=>{const r=s.permissionCreatedAt||s.createdAt,i=t.permissionCreatedAt||t.createdAt,m=r?new Date(r).getTime():0,d=i?new Date(i).getTime():0;return m-d}):e.sort(function(t,s){return x(t,s,"name")}),this.results=e},async loadData(){this.loading=!0;let e=null;this.listType=="feedback"?e=await this.sendReq("/client/item/listByFilter",{userId:this.targetUserId,filter:this.feedbackField}):this.listType=="sharedWithMe"?e=await this.sendReq("/client/item/listSharedWithUser",{userId:this.targetUserId}):this.listType=="sharedByMe"?e=await this.sendReq("/client/item/listSharedByUser",{userId:this.targetUserId}):this.listType=="uncategorized"?e=await this.sendReq("/client/library/uncategorized",{userId:this.targetUserId}):this.listType=="all"?this.targetUserId&&this.targetUserId!=this.currentUserId?e=await this.sendReq("/client/item/listWithInfoByUser",{userId:this.targetUserId}):e=await this.sendReq("/client/item/listByFilter",{userId:this.targetUserId,filter:"all"}):this.listType=="archived"?e=await this.sendReq("/client/library/archived",{userId:this.targetUserId}):e={success:!1,message:"Invalid list type"},e!=null&&e.success?(this.results=B(e.result,50,!1),this.searchText&&(this.results=this.results.filter(t=>{const s=t==null?void 0:t.name;if(s&&s.toLowerCase().includes(this.searchText.toLowerCase()))return!0;const r=t==null?void 0:t.description;if(r&&r.toLowerCase().includes(this.searchText.toLowerCase()))return!0;const i=t==null?void 0:t.url;return!!(i&&i.toLowerCase().includes(this.searchText.toLowerCase()))})),this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message),this.loading=!1}},created(){this.targetUserId=this.$route.params.userId,this.listType=this.$route.params.listType,this.feedbackField=this.$route.params.field||"reactionDate",this.searchText=this.$route.query.search,this.loadData()}}),A={class:"container-fluid d-flex justify-content-between"},R={class:"d-flex align-items-center"},F={class:"text-muted",title:"sort by"},O={class:"text-muted"};function S(e,t,s,r,i,m){const d=o("b-icon"),f=o("b-dropdown-divider"),y=o("b-dropdown-item"),g=o("b-dropdown"),w=o("ItemList");return u(),h("div",null,[a("div",A,[a("div",null,[a("div",R,[a("div",F,[n(d,{icon:"sort-down"})]),n(g,{"toggle-class":"pill text-muted",variant:"link",lazy:!0,right:""},{"button-content":c(()=>[a("span",O,p(e.orderByText?e.orderByText:"Select"),1)]),default:c(()=>[t[1]||(t[1]=a("div",{class:"text-muted text-center"},"Sort By:",-1)),n(f),(u(!0),h(L,null,k(e.orderByOptions,(l,I)=>(u(),D(y,{key:I,onClick:M=>e.selectOrderBy(l)},{default:c(()=>[$(p(l.text),1)]),_:2},1032,["onClick"]))),128))]),_:1})])])]),n(w,{loading:e.loading,items:e.results,onUpdate:t[0]||(t[0]=l=>e.loadData())},null,8,["loading","items"])])}const ie=b(q,[["render",S]]);export{ie as default};
