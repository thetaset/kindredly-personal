import{a as c,_ as f}from"./components.globalBic2x0kT.js";import{d as h,j as l,K as o,z as n,m as P,s as u,r as t,i as d,Q as g}from"./@vueC3Nhqlrl.js";const b=h({name:"UpdatePassword",mixins:[c],props:{user:{type:Object,default:null},needCurrentPassword:{type:Boolean,default:!0}},emits:["close","password"],data(){return{targetUser:null,currentPassword:null,password:null,confirmPassword:null,errorMessage:null}},mounted(){},computed:{userId(){var s;return(s=this.targetUser)==null?void 0:s._id}},methods:{async updatePassword(){if(this.password!=this.confirmPassword){this.errorMessage="Passwords do not match";return}if(this.errorMessage="",!this.config.debugMode&&(!this.password||this.password.length<8||!this.password.match(/[A-Z]/)||!this.password.match(/[0-9]/))){this.errorMessage="Invalid Password. Password should be 8 or more characters and contain at least one number and uppercase letter";return}const s=await this.sendReq("/client/updatePassword",{userId:this.userId,currentPassword:this.currentPassword,password:this.password,forceSkipCheck:!this.needCurrentPassword});s.success?(this.showToast("Password updated successfully",{variant:"success"}),this.$emit("password",this.password),this.$emit("close",!0)):this.errorMessage=s.message}},created(){this.targetUser=this.user||this.currentUser}}),V={key:0};function U(s,e,_,v,y,C){const a=t("b-form-input"),i=t("b-form-group"),p=t("b-form"),m=t("b-alert"),w=t("b-button");return d(),l("div",null,[o(p,null,{default:n(()=>[o(i,{class:"form-group"},{default:n(()=>[s.targetUser.hasPassword&&s.needCurrentPassword?(d(),l("div",V,[o(a,{class:"mt-2 mb-5",modelValue:s.currentPassword,"onUpdate:modelValue":e[0]||(e[0]=r=>s.currentPassword=r),placeholder:"Enter current password",type:"password"},null,8,["modelValue"])])):u("",!0),o(a,{class:"mb-2",modelValue:s.password,"onUpdate:modelValue":e[1]||(e[1]=r=>s.password=r),placeholder:"Enter new password",type:"password"},null,8,["modelValue"]),o(a,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=r=>s.confirmPassword=r),placeholder:"Confirm new password",type:"password"},null,8,["modelValue"])]),_:1})]),_:1}),s.errorMessage?(d(),P(m,{key:0,class:"m-4",variant:"danger","model-value":!0,innerHTML:s.errorMessage},null,8,["innerHTML"])):u("",!0),o(w,{variant:"primary",class:"float-right mt-4",onClick:e[3]||(e[3]=r=>s.updatePassword())},{default:n(()=>e[4]||(e[4]=[g(" Save ")])),_:1})])}const $=f(b,[["render",U]]);export{$ as U};
