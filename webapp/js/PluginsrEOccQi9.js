import{a as y,_ as b}from"./components.globalBic2x0kT.js";import{d as U,j as i,K as l,z as r,m as P,s as f,r as t,i as n,Q as h,k as V,L as E,F as x,P as R,ac as S,R as $}from"./@vueC3Nhqlrl.js";const q=U({name:"UpdateEmail",props:{userId:{type:String,default:null}},mixins:[y],data(){return{email:null,errorMessage:null}},mounted(){},computed:{},methods:{update(){this.errorMessage="",this.sendReq("/user/email/update",{userId:this.userId||this.currentUserId,email:this.email}).then(e=>{e.success?(this.email&&this.showToast("Email updated. A verification email was sent.",{variant:"success"}),this.$emit("close",!0)):this.errorMessage=e.message})}},created(){}});function C(e,s,v,I,o,m){const c=t("b-form-input"),g=t("b-form-group"),p=t("b-form"),_=t("b-alert"),u=t("b-button");return n(),i("div",null,[l(p,null,{default:r(()=>[l(g,{class:"form-group"},{default:r(()=>[l(c,{type:"email",modelValue:e.email,"onUpdate:modelValue":s[0]||(s[0]=a=>e.email=a),placeholder:"Enter Email"},null,8,["modelValue"])]),_:1})]),_:1}),e.errorMessage?(n(),P(_,{key:0,class:"m-4",variant:"danger","model-value":!0,innerHTML:e.errorMessage},null,8,["innerHTML"])):f("",!0),l(u,{variant:"primary",class:"float-right mt-4",onClick:s[1]||(s[1]=a=>e.update())},{default:r(()=>s[2]||(s[2]=[h(" Save ")])),_:1})])}const z=b(q,[["render",C]]),w={name:"Plugins",props:{userId:{type:String,default:null}},data(){return{loading:!1,allPlugins:null,userPlugins:null,selectedPluginIds:[]}},mounted(){},computed:{pluginOptions(){return!this.allPlugins||!this.userPlugins?[]:this.allPlugins.map(s=>({value:s._id,text:s.name}))}},methods:{loadUserPlugins(){this.sendReq("/user/plugin/list",{userId:this.userId}).then(e=>{e.success?(this.userPlugins=e.result,this.selectedPluginIds=this.userPlugins.map(s=>s._id),this.loadPlugins(),this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message)})},loadPlugins(){this.sendReq("/plugin/list",{}).then(e=>{e.success?(this.allPlugins=e.result,this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message)})},updatePlugins(){this.sendReq("/user/plugin/update",{userId:this.userId,pluginIds:this.selectedPluginIds}).then(e=>{e.success?(this.loadUserPlugins(),this.sendReq("/client/updatePlugins"),this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message)})}},created(){this.loadUserPlugins()}},B={class:"mb-2"},D={key:1,class:"ms-2 mt-1 small text-muted"};function L(e,s,v,I,o,m){const c=t("b-form-checkbox-group"),g=t("b-form-group"),p=t("b-form"),_=t("b-modal"),u=t("b-icon"),a=t("b-button"),k=S("b-modal");return n(),i("div",null,[l(_,{lazy:"true",id:"update-plugins-modal",title:"Select Plugins",onOk:s[1]||(s[1]=d=>m.updatePlugins())},{default:r(()=>[l(p,null,{default:r(()=>[l(g,{class:"form-group"},{default:r(()=>[l(c,{modelValue:o.selectedPluginIds,"onUpdate:modelValue":s[0]||(s[0]=d=>o.selectedPluginIds=d),options:m.pluginOptions,name:"flavour-2a",stacked:""},null,8,["modelValue","options"])]),_:1})]),_:1})]),_:1}),V("div",B,[e.isAdminUser?E((n(),P(a,{key:0,variant:"outline-primary",size:"sm"},{default:r(()=>[l(u,{icon:"pencil"}),s[2]||(s[2]=h(" Select Plugins "))]),_:1})),[[k,void 0,void 0,{"update-plugins-modal":!0}]]):f("",!0),(n(!0),i(x,null,R(o.userPlugins,(d,M)=>(n(),i("div",{class:"ms-2 mt-1 small",key:M},[l(u,{icon:"check"}),h(" "+$(d.name),1)]))),128)),!o.userPlugins||o.userPlugins.length==0?(n(),i("div",D," no plugins selected ")):f("",!0)])])}const O=b(w,[["render",L]]);export{O as P,z as U};
