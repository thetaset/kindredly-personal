import{aB as p,aC as u,a8 as h,aD as c,aE as g,f as w}from"./components.globalBic2x0kT.js";import{d as y}from"./@vueC3Nhqlrl.js";const T=y({components:{},data:function(){return{}},computed:{...p},methods:{async uploadAttachmentObj(a,e,n,t){let s={type:"file",fileData:JSON.stringify(e),filename:n,fileType:t};try{return this.uploadAttachmentInfo(a,s)}catch(i){return console.error("upload failed",i),!1}},async uploadFile(a,e,n=!0){if(!e){console.error("File Missing not specified");return}let t=await u(e),{fileData:s,fileType:i}=h(t),f=e.name,d=e.size,r={type:"file",filename:f,filesize:d,fileType:i,fileData:s};if(!n){if(i.startsWith("image")){let{imagePreviewData:o,imagePreviewType:l}=await c(t);r.imagePreview=o,r.imageType=l}else if(i.startsWith("video")){let o=await g(t),{imagePreviewData:l,imagePreviewType:m}=await c(o);r.imagePreview=l,r.imageType=m}}try{return this.uploadAttachmentInfo(a,r)}catch(o){return console.error("upload failed",o),!1}},async uploadAttachmentInfo(a,e){if(!(await w("/client/item/attachment/add",{itemId:a._id,attachmentInfo:e,encInfo:a.encInfo})).success)throw console.error("upload failed"),new Error("upload failed");return!0}},created(){}});export{T as u};
