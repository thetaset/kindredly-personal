import{a as k,_}from"./components.globalDizx_NTC.js";import{d as v,j as o,k as u,Q as a,R as f,K as i,z as n,m,s as U,r as l,i as s}from"./@vueC3Nhqlrl.js";function P(e){return!e||e.length<6||e.length>20?!1:/^[a-zA-Z0-9_]+$/.test(e)}const h={username:null,about:null,enabled:!0,blockedAt:null,blockedContext:{}},M=v({name:"PublicProfileEdit",mixins:[k],data(){return{publicId:null,errorMessage:null,publicProfileCopy:{...h}}},mounted(){},computed:{},methods:{async createPublicProfile(){if(!this.currentUser)return;if(!P(this.currentUser.username)){this.errorMessage="Invalid username";return}const e=await this.sendReq("/user/public/update",{data:h});e.success?(this.publicId=e.result,await this.RefreshCurrentUser(!0),await this.loadPublicProfile(),this.publicProfile&&(this.publicProfileCopy={...this.publicProfile},this.publicId=this.currentUser.publicId),this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message)},updatePublicProfile(){if(!P(this.publicProfileCopy.username)){this.errorMessage="Invalid username";return}this.publicProfileCopy.enabled=!0,this.sendReq("/user/public/update",{data:{...this.publicProfileCopy}}).then(e=>{e.success?(this.loadPage(),this.$emit("close"),this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message)})},async loadPage(){const e=await this.loadPublicProfile();e&&(this.publicProfileCopy={...e})}},created(){var e;this.publicId=(e=this.currentUser)==null?void 0:e.publicId,this.loadPage()}}),V={key:0},I={key:0},w={class:"alert alert-danger my-2"},$={key:1,class:"alert alert-warning my-2"},A={key:2},R={class:"d-flex mt-2"},E={key:1,class:"text-center mt-1"},B={key:1,class:"alert alert-warning my-2"};function N(e,r,z,D,T,q){var c,b;const g=l("b-form-input"),d=l("b-form-group"),y=l("b-form-textarea"),C=l("b-alert"),p=l("b-button");return s(),o("div",null,[e.publicId?(s(),o("div",V,[e.publicProfileCopy.blockedAt?(s(),o("div",I,[u("div",w,[a(" Your public profile was blocked at "+f(e.publicProfileCopy.blockedAt)+" ",1),r[4]||(r[4]=u("br",null,null,-1)),a(" "+f((b=(c=e.publicProfileCopy)==null?void 0:c.blockContext)==null?void 0:b.message),1)])])):e.isAdminUser?(s(),o("div",A,[i(d,{class:"form-group",label:"Publishing Username",dsescription:"Publishing Username"},{default:n(()=>[i(g,{autocorrect:"off",autocapitalize:"off",modelValue:e.publicProfileCopy.username,"onUpdate:modelValue":r[0]||(r[0]=t=>e.publicProfileCopy.username=t),placeholder:"Publishing Username"},null,8,["modelValue"])]),_:1}),i(d,{class:"form-group"},{default:n(()=>[i(y,{modelValue:e.publicProfileCopy.about,"onUpdate:modelValue":r[1]||(r[1]=t=>e.publicProfileCopy.about=t),placeholder:"about me"},null,8,["modelValue"])]),_:1}),e.errorMessage?(s(),m(C,{key:0,class:"m-4",variant:"danger","model-value":!0,innerHTML:e.errorMessage},null,8,["innerHTML"])):U("",!0),u("div",R,[i(p,{class:"ms-auto",variant:"primary",onClick:r[2]||(r[2]=t=>e.updatePublicProfile())},{default:n(()=>r[5]||(r[5]=[a("Save")])),_:1})])])):(s(),o("div",$,"Restircted users cannot publish publicly."))])):(s(),o("div",E,[e.isAdminUser?(s(),m(p,{key:0,variant:"primary",onClick:r[3]||(r[3]=t=>e.createPublicProfile())},{default:n(()=>r[6]||(r[6]=[a("Create public profile")])),_:1})):(s(),o("div",B,"Restircted users cannot publish publicly."))]))])}const S=_(M,[["render",N]]);export{S as P};
