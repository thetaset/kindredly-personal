import{I as w}from"./ItemAttachmentsDwgNz2q3.js";import{c as y}from"./item.storeCI0d-UrP.js";import{a as b,t as k,n as x,x as D,_ as T}from"./components.globalDizx_NTC.js";import{I as A}from"./ItemImageDmIqiyLE.js";import{u as $}from"./upload.mixinCs4F8zrX.js";import{d as P,m as h,z as n,r as o,i as m,K as i,k as a,R as f,j as S,Q as B,s as u}from"./@vueC3Nhqlrl.js";import"./UploadItemImageD8_IjZcF.js";import"./vue-advanced-cropperDRfTlVFt.js";import"./@mozillaCDB2aYYy.js";import"./TIIconDefaultB4jiNlod.js";import"./vue3-toastifyDll2FbVh.js";import"./@capacitorCjBcbZvA.js";import"./bootstrap-vue-nextDnMzdrWQ.js";const C=P({name:"AttachToItemPage",components:{ItemAttachments:w,ItemImage:A},mixins:[$,b],data(){return{itemId:null,item:null,loading:!1}},mounted(){},computed:{},methods:{textTruncate:k,closeComponent(t){t?this.$router.push("/item/"+t):this.$router.push("/")},async loadItem(){let t=await y({itemId:this.itemId});this.item=x(t)},async loadPage(){await this.loadItem(),await this.uploadingAttachments()},async uploadingAttachments(){let t=!1;try{if(this.tempShareData&&this.tempShareData.length>0){this.loading=!0;for(let e=0;e<this.tempShareData.length;e++){const s=this.tempShareData[e],l=s==null?void 0:s.preppedData;let r={type:"file",filename:s.data.filename,fileType:l.fileType,fileData:l.fileData,filesize:s.data.size,imagePreview:l.imagePreview,imageType:l.imageType};await this.uploadAttachmentInfo(this.item,r),t=!0}await D(),this.loading=!1}}finally{this.loading=!1,await this.loadItem()}t&&this.showToast("Attachments uploaded successfully")}},created(){this.itemId=this.$route.params.itemId,this.loadPage()}}),N={class:"my-4 d-flex flex-gap-1 align-items-center"},V={class:"h3"},z={class:"h3"},j={class:"text-muted small"},G={key:0};function K(t,e,s,l,r,L){const _=o("b-icon"),d=o("router-link"),g=o("b-spinner"),I=o("ItemAttachments"),c=o("b-col"),p=o("b-row"),v=o("b-container");return m(),h(v,{class:"container"},{default:n(()=>[i(p,{class:"row"},{default:n(()=>[t.item?(m(),h(c,{key:0,class:"col"},{default:n(()=>[a("div",N,[a("div",V,[i(d,{to:`/item/${t.itemId}`,class:"rounded hoverrow larger linklike-bw d-flex align-items-center flex-gap-sm"},{default:n(()=>[i(_,{icon:"chevron-left"})]),_:1},8,["to"])]),a("div",null,[a("div",z,[i(d,{to:`/item/${t.itemId}`,class:"rounded hoverrow larger linklike-bw d-flex align-items-center flex-gap-sm"},{default:n(()=>[a("div",null,f(t.item.name),1)]),_:1},8,["to"])]),a("div",j,"Item Type: "+f(t.item.typeName),1)])]),e[2]||(e[2]=a("div",null,[a("div",{class:"d-flex flex-gap-1 h5"},[a("div",{class:""}," Item Attachments ")])],-1)),e[3]||(e[3]=a("hr",null,null,-1)),t.loading?(m(),S("div",G,[i(g),e[1]||(e[1]=B(" uploading new attachments... "))])):u("",!0),a("div",null,[i(I,{item:t.item,onUpdate:e[0]||(e[0]=M=>t.loadItem())},null,8,["item"])])]),_:1})):u("",!0)]),_:1}),i(p,{class:"mt-4"},{default:n(()=>[i(c,{class:"col"})]),_:1})]),_:1})}const tt=T(C,[["render",K],["__scopeId","data-v-c03ec4c7"]]);export{tt as default};
