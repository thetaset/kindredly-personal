const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/AccessRequestsForUserd3z0D9ww.js","js/components.globalSAVxUKYX.js","js/@vueC3Nhqlrl.js","js/vue3-toastifyDll2FbVh.js","assets/vue3-toastify.css","js/@capacitorCjBcbZvA.js","js/bootstrap-vue-nextDnMzdrWQ.js","assets/bootstrap-vue-next.css","assets/components.css","js/PermissionOverrideDx-ALQS8.js","js/TIIconDefaultBACySpee.js","assets/TIIconDefault.css","js/UpdatePinD8X1bciL.js","js/AccessRequestApproverBx3Rs5iB.js","js/PopCollectionSelectorBo26MlBL.js","js/CreateCollectionC2CAQQ8x.js","js/ai_lookup_utilszDX_hcwM.js","assets/CreateCollection.css","js/ItemImageB4O-XpFn.js","assets/PopCollectionSelector.css","assets/CurateItem.css"])))=>i.map(i=>d[i]);
import{_ as A}from"./@capacitorCjBcbZvA.js";import U from"./AddItemDVLAD9ud.js";import{A as g}from"./AccessRequestNewD6Pzlz5u.js";import{P as L}from"./PermissionOverrideDx-ALQS8.js";import{A as P}from"./AccessRequestApproverBx3Rs5iB.js";import{a as I,an as h,_ as C}from"./components.globalSAVxUKYX.js";import{d as B,aa as O,j as d,K as t,z as r,k as o,Q as a,R as $,r as i,ac as D,i as n,L as v,m}from"./@vueC3Nhqlrl.js";import"./PopCollectionSelectorBo26MlBL.js";import"./CreateCollectionC2CAQQ8x.js";import"./TIIconDefaultBACySpee.js";import"./ai_lookup_utilszDX_hcwM.js";import"./ItemImageB4O-XpFn.js";import"./vue3-toastifyDll2FbVh.js";import"./bootstrap-vue-nextDnMzdrWQ.js";import"./CollectionButtonListCK1eTpTV.js";import"./ItemTypesLjCsMI_T.js";import"./AddItemFromLibraryResultsDW-vejij.js";import"./UpdatePinD8X1bciL.js";const T=B({name:"BlockedPage",mixins:[I],components:{AddItem:U,AccessRequestNew:g,PermissionOverride:L,AccessRequestApprover:P,AccessRequestsForUser:O(()=>A(()=>import("./AccessRequestsForUserd3z0D9ww.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20])))},data(){return{refreshKey:0,blockedURL:null,refreshing:!1,requested:!1,showRequests:!1,requests:[],loading:!0}},mounted(){},computed:{},methods:{async forceRefresh(){this.refreshing=!0;try{await h()}finally{this.refreshing=!1,this.blockedURL!=null&&window.location.replace(this.blockedURL)}},async loadAccessRequests(){this.loading=!0;const s=await this.sendReq("/access_request/listForUser");this.requests=s.result,this.requested=this.requests.some(e=>e.key==this.blockedURL),this.loading=!1},async refresh(){await h(),(await this.sendReq("/client/checkIfPermitted",{url:this.blockedURL})).result&&this.blockedURL!=null?window.location.replace(this.blockedURL):setTimeout(()=>{this.refresh()},1e4)},closeAddItem(s){this.closeModal("add-item-accessrequest-modal"),s&&this.blockedURL!=null&&window.location.replace(this.blockedURL)},closeAccessRequest(s){this.requested=s,this.closeModal("request-access-modal"),this.refreshKey++},async loadPage(){await this.loadAccessRequests(),await this.refresh()},async openAddItem(){this.closeModal("permission-override-modal"),this.showModal("add-item-accessrequest-modal")},async approverDone(s){this.closeModal("add-item-accessrequest-modal"),await this.forceRefresh()}},created(){this.blockedURL=this.$route.query.blockedURL,this.clearPermissionOverrideInfo(),this.loadPage()}}),M={class:"mt-2 pt-4 mx-1"},N={class:"text-center"},x=["title"],z={key:0,class:"d-flex justify-content-center flex-wrap"},j={key:1,class:"mt-3 text-center"},F={class:"mt-3"},K={key:0},S={key:1},V={class:"mt-3 text-center"},E={key:1,class:"text-left"},G={class:"mt-3 p-3 text-center"},Q={class:"d-flex align-items-center justify-content-center flex-gap-sm"};function H(s,e,J,W,X,Y){const k=i("AccessRequestApprover"),u=i("b-modal"),R=i("PermissionOverride"),q=i("AccessRequestNew"),l=i("b-icon"),c=i("b-button"),b=i("AccessRequestsForUser"),_=i("TIcon"),w=i("router-link"),y=i("b-container"),p=D("b-modal");return n(),d("div",M,[t(u,{lazy:"true",id:"add-item-accessrequest-modal",title:"Grant Permission","hide-footer":"",onClose:e[0]||(e[0]=f=>s.clearPermissionOverrideInfo()),size:"lg"},{default:r(()=>[t(k,{url:s.blockedURL,userId:s.currentUserId,onClose:s.approverDone,requestId:null},null,8,["url","userId","onClose"])]),_:1}),t(u,{lazy:"true",id:"permission-override-modal",title:"Permission Override","hide-footer":""},{default:r(()=>[t(R,{onSuccess:s.openAddItem},null,8,["onSuccess"])]),_:1}),t(u,{lazy:"true",id:"request-access-modal",title:"Request Access","hide-footer":""},{default:r(()=>[t(q,{url:s.blockedURL,onClose:s.closeAccessRequest},null,8,["url","onClose"])]),_:1}),o("div",N,[o("h2",null,[e[3]||(e[3]=a("Uh oh! ")),t(l,{icon:"emoji-frown"})]),e[4]||(e[4]=o("div",{class:"mb-4"},null,-1)),e[5]||(e[5]=o("h3",null,"This page has been blocked.",-1)),e[6]||(e[6]=o("div",{class:"mb-4"},null,-1)),o("div",{class:"d-inline-block font-weight-bolder p-2 border rounded",title:s.blockedURL},$(s.textTruncate(s.blockedURL,150)),9,x)]),e[13]||(e[13]=o("div",{class:"mb-4"},null,-1)),t(y,{class:"container"},{default:r(()=>[e[12]||(e[12]=o("div",{class:"mb-4"},null,-1)),s.requested?(n(),d("div",j,[o("div",null,[t(l,{icon:"check-circle-fill",variant:"success"}),e[8]||(e[8]=a(" Permission request submitted"))]),o("div",F,[t(c,{variant:"outline-primary",onClick:e[1]||(e[1]=f=>s.forceRefresh()),disabled:s.refreshing,title:"Refresh"},{default:r(()=>[e[9]||(e[9]=a(" Refresh ")),s.refreshing?(n(),d("span",S,[t(l,{icon:"arrow-clockwise",animation:"spin"})])):(n(),d("span",K,[t(l,{icon:"arrow-clockwise"})]))]),_:1},8,["disabled"])])])):(n(),d("div",z,[v((n(),m(c,{class:"mx-1",variant:"primary",id:"requestAccessButton"},{default:r(()=>[t(l,{icon:"person-plus-fill"}),e[7]||(e[7]=a(" Ask for Permission "))]),_:1})),[[p,void 0,void 0,{"request-access-modal":!0}]]),v((n(),m(c,{"data-test-id":"grandAccessOverrideButton",variant:"outline-warning",class:"mx-1",title:"Grant Access as Account Admin"},{default:r(()=>[t(l,{icon:"shield-lock"})]),_:1})),[[p,void 0,void 0,{"permission-override-modal":!0}]])])),o("div",V,[s.showRequests?(n(),d("div",E,[e[11]||(e[11]=o("h4",null,"My Requests",-1)),t(b)])):(n(),m(c,{key:0,variant:"link",onClick:e[2]||(e[2]=f=>s.showRequests=!0)},{default:r(()=>[t(l,{icon:"key"}),e[10]||(e[10]=a(" Show my requests"))]),_:1}))]),o("div",G,[t(w,{to:"/",title:"Kindredly Home"},{default:r(()=>[o("div",Q,[t(_,{class:"rotateonhover",name:"kindred-simple2",width:60})])]),_:1})])]),_:1})])}const ke=C(T,[["render",H]]);export{ke as default};
