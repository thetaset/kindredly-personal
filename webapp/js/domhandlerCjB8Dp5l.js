import{n as P,E as r,o as a,p as O}from"./domelementtypeCGHdmTnT.js";let b=class{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(t){this.parent=t}get previousSibling(){return this.prev}set previousSibling(t){this.prev=t}get nextSibling(){return this.next}set nextSibling(t){this.next=t}cloneNode(t=!1){return S(this,t)}},f=class extends b{constructor(t){super(),this.data=t}get nodeValue(){return this.data}set nodeValue(t){this.data=t}},d=class extends f{constructor(){super(...arguments),this.type=r.Text}get nodeType(){return 3}},I=class extends f{constructor(){super(...arguments),this.type=r.Comment}get nodeType(){return 8}},w=class extends f{constructor(t,s){super(s),this.name=t,this.type=r.Directive}get nodeType(){return 1}},x=class extends b{constructor(t){super(),this.children=t}get firstChild(){var t;return(t=this.children[0])!==null&&t!==void 0?t:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(t){this.children=t}},C=class extends x{constructor(){super(...arguments),this.type=r.CDATA}get nodeType(){return 4}},c=class extends x{constructor(){super(...arguments),this.type=r.Root}get nodeType(){return 9}},T=class extends x{constructor(t,s,n=[],i=t==="script"?r.Script:t==="style"?r.Style:r.Tag){super(n),this.name=t,this.attribs=s,this.type=i}get nodeType(){return 1}get tagName(){return this.name}set tagName(t){this.name=t}get attributes(){return Object.keys(this.attribs).map(t=>{var s,n;return{name:t,value:this.attribs[t],namespace:(s=this["x-attribsNamespace"])===null||s===void 0?void 0:s[t],prefix:(n=this["x-attribsPrefix"])===null||n===void 0?void 0:n[t]}})}};function j(e){return P(e)}function L(e){return e.type===r.CDATA}function _(e){return e.type===r.Text}function M(e){return e.type===r.Comment}function R(e){return e.type===r.Directive}function V(e){return e.type===r.Root}function st(e){return Object.prototype.hasOwnProperty.call(e,"children")}function S(e,t=!1){let s;if(_(e))s=new d(e.data);else if(M(e))s=new I(e.data);else if(j(e)){const n=t?o(e.children):[],i=new T(e.name,{...e.attribs},n);n.forEach(l=>l.parent=i),e.namespace!=null&&(i.namespace=e.namespace),e["x-attribsNamespace"]&&(i["x-attribsNamespace"]={...e["x-attribsNamespace"]}),e["x-attribsPrefix"]&&(i["x-attribsPrefix"]={...e["x-attribsPrefix"]}),s=i}else if(L(e)){const n=t?o(e.children):[],i=new C(n);n.forEach(l=>l.parent=i),s=i}else if(V(e)){const n=t?o(e.children):[],i=new c(n);n.forEach(l=>l.parent=i),e["x-mode"]&&(i["x-mode"]=e["x-mode"]),s=i}else if(R(e)){const n=new w(e.name,e.data);e["x-name"]!=null&&(n["x-name"]=e["x-name"],n["x-publicId"]=e["x-publicId"],n["x-systemId"]=e["x-systemId"]),s=n}else throw new Error(`Not implemented yet: ${e.type}`);return s.startIndex=e.startIndex,s.endIndex=e.endIndex,e.sourceCodeLocation!=null&&(s.sourceCodeLocation=e.sourceCodeLocation),s}function o(e){const t=e.map(s=>S(s,!0));for(let s=1;s<t.length;s++)t[s].prev=t[s-1],t[s-1].next=t[s];return t}const N={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};let nt=class{constructor(t,s,n){this.dom=[],this.root=new c(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof s=="function"&&(n=s,s=N),typeof t=="object"&&(s=t,t=void 0),this.callback=t??null,this.options=s??N,this.elementCB=n??null}onparserinit(t){this.parser=t}onreset(){this.dom=[],this.root=new c(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(t){this.handleCallback(t)}onclosetag(){this.lastNode=null;const t=this.tagStack.pop();this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(t)}onopentag(t,s){const n=this.options.xmlMode?r.Tag:void 0,i=new T(t,s,void 0,n);this.addNode(i),this.tagStack.push(i)}ontext(t){const{lastNode:s}=this;if(s&&s.type===r.Text)s.data+=t,this.options.withEndIndices&&(s.endIndex=this.parser.endIndex);else{const n=new d(t);this.addNode(n),this.lastNode=n}}oncomment(t){if(this.lastNode&&this.lastNode.type===r.Comment){this.lastNode.data+=t;return}const s=new I(t);this.addNode(s),this.lastNode=s}oncommentend(){this.lastNode=null}oncdatastart(){const t=new d(""),s=new C([t]);this.addNode(s),t.parent=s,this.lastNode=t}oncdataend(){this.lastNode=null}onprocessinginstruction(t,s){const n=new w(t,s);this.addNode(n)}handleCallback(t){if(typeof this.callback=="function")this.callback(t,this.dom);else if(t)throw t}addNode(t){const s=this.tagStack[this.tagStack.length-1],n=s.children[s.children.length-1];this.options.withStartIndices&&(t.startIndex=this.parser.startIndex),this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),s.children.push(t),n&&(t.prev=n,n.next=t),t.parent=s,this.lastNode=null}};class D{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(t){this.parent=t}get previousSibling(){return this.prev}set previousSibling(t){this.prev=t}get nextSibling(){return this.next}set nextSibling(t){this.next=t}cloneNode(t=!1){return k(this,t)}}class m extends D{constructor(t){super(),this.data=t}get nodeValue(){return this.data}set nodeValue(t){this.data=t}}class u extends m{constructor(){super(...arguments),this.type=a.Text}get nodeType(){return 3}}class v extends m{constructor(){super(...arguments),this.type=a.Comment}get nodeType(){return 8}}class $ extends m{constructor(t,s){super(s),this.name=t,this.type=a.Directive}get nodeType(){return 1}}class g extends D{constructor(t){super(),this.children=t}get firstChild(){var t;return(t=this.children[0])!==null&&t!==void 0?t:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(t){this.children=t}}class E extends g{constructor(){super(...arguments),this.type=a.CDATA}get nodeType(){return 4}}class p extends g{constructor(){super(...arguments),this.type=a.Root}get nodeType(){return 9}}class A extends g{constructor(t,s,n=[],i=t==="script"?a.Script:t==="style"?a.Style:a.Tag){super(n),this.name=t,this.attribs=s,this.type=i}get nodeType(){return 1}get tagName(){return this.name}set tagName(t){this.name=t}get attributes(){return Object.keys(this.attribs).map(t=>{var s,n;return{name:t,value:this.attribs[t],namespace:(s=this["x-attribsNamespace"])===null||s===void 0?void 0:s[t],prefix:(n=this["x-attribsPrefix"])===null||n===void 0?void 0:n[t]}})}}function H(e){return O(e)}function W(e){return e.type===a.CDATA}function q(e){return e.type===a.Text}function z(e){return e.type===a.Comment}function B(e){return e.type===a.Directive}function F(e){return e.type===a.Root}function rt(e){return Object.prototype.hasOwnProperty.call(e,"children")}function k(e,t=!1){let s;if(q(e))s=new u(e.data);else if(z(e))s=new v(e.data);else if(H(e)){const n=t?h(e.children):[],i=new A(e.name,{...e.attribs},n);n.forEach(l=>l.parent=i),e.namespace!=null&&(i.namespace=e.namespace),e["x-attribsNamespace"]&&(i["x-attribsNamespace"]={...e["x-attribsNamespace"]}),e["x-attribsPrefix"]&&(i["x-attribsPrefix"]={...e["x-attribsPrefix"]}),s=i}else if(W(e)){const n=t?h(e.children):[],i=new E(n);n.forEach(l=>l.parent=i),s=i}else if(F(e)){const n=t?h(e.children):[],i=new p(n);n.forEach(l=>l.parent=i),e["x-mode"]&&(i["x-mode"]=e["x-mode"]),s=i}else if(B(e)){const n=new $(e.name,e.data);e["x-name"]!=null&&(n["x-name"]=e["x-name"],n["x-publicId"]=e["x-publicId"],n["x-systemId"]=e["x-systemId"]),s=n}else throw new Error(`Not implemented yet: ${e.type}`);return s.startIndex=e.startIndex,s.endIndex=e.endIndex,e.sourceCodeLocation!=null&&(s.sourceCodeLocation=e.sourceCodeLocation),s}function h(e){const t=e.map(s=>k(s,!0));for(let s=1;s<t.length;s++)t[s].prev=t[s-1],t[s-1].next=t[s];return t}const y={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class at{constructor(t,s,n){this.dom=[],this.root=new p(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof s=="function"&&(n=s,s=y),typeof t=="object"&&(s=t,t=void 0),this.callback=t??null,this.options=s??y,this.elementCB=n??null}onparserinit(t){this.parser=t}onreset(){this.dom=[],this.root=new p(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(t){this.handleCallback(t)}onclosetag(){this.lastNode=null;const t=this.tagStack.pop();this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(t)}onopentag(t,s){const n=this.options.xmlMode?a.Tag:void 0,i=new A(t,s,void 0,n);this.addNode(i),this.tagStack.push(i)}ontext(t){const{lastNode:s}=this;if(s&&s.type===a.Text)s.data+=t,this.options.withEndIndices&&(s.endIndex=this.parser.endIndex);else{const n=new u(t);this.addNode(n),this.lastNode=n}}oncomment(t){if(this.lastNode&&this.lastNode.type===a.Comment){this.lastNode.data+=t;return}const s=new v(t);this.addNode(s),this.lastNode=s}oncommentend(){this.lastNode=null}oncdatastart(){const t=new u(""),s=new E([t]);this.addNode(s),t.parent=s,this.lastNode=t}oncdataend(){this.lastNode=null}onprocessinginstruction(t,s){const n=new $(t,s);this.addNode(n)}handleCallback(t){if(typeof this.callback=="function")this.callback(t,this.dom);else if(t)throw t}addNode(t){const s=this.tagStack[this.tagStack.length-1],n=s.children[s.children.length-1];this.options.withStartIndices&&(t.startIndex=this.parser.startIndex),this.options.withEndIndices&&(t.endIndex=this.parser.endIndex),s.children.push(t),n&&(t.prev=n,n.next=t),t.parent=s,this.lastNode=null}}export{I as C,c as D,T as E,w as P,d as T,V as a,H as b,S as c,F as d,rt as e,p as f,k as g,st as h,j as i,u as j,M as k,_ as l,L as m,z as n,q as o,W as p,nt as q,at as r,R as s,A as t,v as u,B as v,$ as w};
