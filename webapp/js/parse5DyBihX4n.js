import{h as $,g as Fs,B as nt,b as Us,a as ks,E as ys,k as xs,D as it,f as Ys,d as ws}from"./entitiesL-JVAG0g.js";const vs=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),g="ï¿½";var i;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.NUMBER_SIGN=35]="NUMBER_SIGN",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_F=70]="LATIN_CAPITAL_F",e[e.LATIN_CAPITAL_X=88]="LATIN_CAPITAL_X",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_F=102]="LATIN_SMALL_F",e[e.LATIN_SMALL_X=120]="LATIN_SMALL_X",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z",e[e.REPLACEMENT_CHARACTER=65533]="REPLACEMENT_CHARACTER"})(i=i||(i={}));const b={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function gt(e){return e>=55296&&e<=57343}function Qs(e){return e>=56320&&e<=57343}function Xs(e,t){return(e-55296)*1024+9216+t}function Pt(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function pt(e){return e>=64976&&e<=65007||vs.has(e)}var d;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(d=d||(d={}));const Ws=65536;let Ks=class{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=Ws,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t){const{line:s,col:n,offset:T}=this;return{code:t,startLine:s,endLine:s,startCol:n,endCol:n,startOffset:T,endOffset:T}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const s=this.html.charCodeAt(this.pos+1);if(Qs(s))return this.pos++,this._addGap(),Xs(t,s)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,i.EOF;return this._err(d.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,s){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=s}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,s){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(s)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){const s=this.pos+t;if(s>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,i.EOF;const n=this.html.charCodeAt(s);return n===i.CARRIAGE_RETURN?i.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,i.EOF;let t=this.html.charCodeAt(this.pos);return t===i.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,i.LINE_FEED):t===i.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,gt(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===i.LINE_FEED||t===i.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){Pt(t)?this._err(d.controlCharacterInInputStream):pt(t)&&this._err(d.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}};var L;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(L=L||(L={}));function Mt(e,t){for(let s=e.attrs.length-1;s>=0;s--)if(e.attrs[s].name===t)return e.attrs[s].value;return null}var C;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(C=C||(C={}));var G;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(G=G||(G={}));var k;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(k=k||(k={}));var A;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(A=A||(A={}));var a;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SECTION=94]="SECTION",e[e.SELECT=95]="SELECT",e[e.SOURCE=96]="SOURCE",e[e.SMALL=97]="SMALL",e[e.SPAN=98]="SPAN",e[e.STRIKE=99]="STRIKE",e[e.STRONG=100]="STRONG",e[e.STYLE=101]="STYLE",e[e.SUB=102]="SUB",e[e.SUMMARY=103]="SUMMARY",e[e.SUP=104]="SUP",e[e.TABLE=105]="TABLE",e[e.TBODY=106]="TBODY",e[e.TEMPLATE=107]="TEMPLATE",e[e.TEXTAREA=108]="TEXTAREA",e[e.TFOOT=109]="TFOOT",e[e.TD=110]="TD",e[e.TH=111]="TH",e[e.THEAD=112]="THEAD",e[e.TITLE=113]="TITLE",e[e.TR=114]="TR",e[e.TRACK=115]="TRACK",e[e.TT=116]="TT",e[e.U=117]="U",e[e.UL=118]="UL",e[e.SVG=119]="SVG",e[e.VAR=120]="VAR",e[e.WBR=121]="WBR",e[e.XMP=122]="XMP"})(a=a||(a={}));const Gs=new Map([[A.A,a.A],[A.ADDRESS,a.ADDRESS],[A.ANNOTATION_XML,a.ANNOTATION_XML],[A.APPLET,a.APPLET],[A.AREA,a.AREA],[A.ARTICLE,a.ARTICLE],[A.ASIDE,a.ASIDE],[A.B,a.B],[A.BASE,a.BASE],[A.BASEFONT,a.BASEFONT],[A.BGSOUND,a.BGSOUND],[A.BIG,a.BIG],[A.BLOCKQUOTE,a.BLOCKQUOTE],[A.BODY,a.BODY],[A.BR,a.BR],[A.BUTTON,a.BUTTON],[A.CAPTION,a.CAPTION],[A.CENTER,a.CENTER],[A.CODE,a.CODE],[A.COL,a.COL],[A.COLGROUP,a.COLGROUP],[A.DD,a.DD],[A.DESC,a.DESC],[A.DETAILS,a.DETAILS],[A.DIALOG,a.DIALOG],[A.DIR,a.DIR],[A.DIV,a.DIV],[A.DL,a.DL],[A.DT,a.DT],[A.EM,a.EM],[A.EMBED,a.EMBED],[A.FIELDSET,a.FIELDSET],[A.FIGCAPTION,a.FIGCAPTION],[A.FIGURE,a.FIGURE],[A.FONT,a.FONT],[A.FOOTER,a.FOOTER],[A.FOREIGN_OBJECT,a.FOREIGN_OBJECT],[A.FORM,a.FORM],[A.FRAME,a.FRAME],[A.FRAMESET,a.FRAMESET],[A.H1,a.H1],[A.H2,a.H2],[A.H3,a.H3],[A.H4,a.H4],[A.H5,a.H5],[A.H6,a.H6],[A.HEAD,a.HEAD],[A.HEADER,a.HEADER],[A.HGROUP,a.HGROUP],[A.HR,a.HR],[A.HTML,a.HTML],[A.I,a.I],[A.IMG,a.IMG],[A.IMAGE,a.IMAGE],[A.INPUT,a.INPUT],[A.IFRAME,a.IFRAME],[A.KEYGEN,a.KEYGEN],[A.LABEL,a.LABEL],[A.LI,a.LI],[A.LINK,a.LINK],[A.LISTING,a.LISTING],[A.MAIN,a.MAIN],[A.MALIGNMARK,a.MALIGNMARK],[A.MARQUEE,a.MARQUEE],[A.MATH,a.MATH],[A.MENU,a.MENU],[A.META,a.META],[A.MGLYPH,a.MGLYPH],[A.MI,a.MI],[A.MO,a.MO],[A.MN,a.MN],[A.MS,a.MS],[A.MTEXT,a.MTEXT],[A.NAV,a.NAV],[A.NOBR,a.NOBR],[A.NOFRAMES,a.NOFRAMES],[A.NOEMBED,a.NOEMBED],[A.NOSCRIPT,a.NOSCRIPT],[A.OBJECT,a.OBJECT],[A.OL,a.OL],[A.OPTGROUP,a.OPTGROUP],[A.OPTION,a.OPTION],[A.P,a.P],[A.PARAM,a.PARAM],[A.PLAINTEXT,a.PLAINTEXT],[A.PRE,a.PRE],[A.RB,a.RB],[A.RP,a.RP],[A.RT,a.RT],[A.RTC,a.RTC],[A.RUBY,a.RUBY],[A.S,a.S],[A.SCRIPT,a.SCRIPT],[A.SECTION,a.SECTION],[A.SELECT,a.SELECT],[A.SOURCE,a.SOURCE],[A.SMALL,a.SMALL],[A.SPAN,a.SPAN],[A.STRIKE,a.STRIKE],[A.STRONG,a.STRONG],[A.STYLE,a.STYLE],[A.SUB,a.SUB],[A.SUMMARY,a.SUMMARY],[A.SUP,a.SUP],[A.TABLE,a.TABLE],[A.TBODY,a.TBODY],[A.TEMPLATE,a.TEMPLATE],[A.TEXTAREA,a.TEXTAREA],[A.TFOOT,a.TFOOT],[A.TD,a.TD],[A.TH,a.TH],[A.THEAD,a.THEAD],[A.TITLE,a.TITLE],[A.TR,a.TR],[A.TRACK,a.TRACK],[A.TT,a.TT],[A.U,a.U],[A.UL,a.UL],[A.SVG,a.SVG],[A.VAR,a.VAR],[A.WBR,a.WBR],[A.XMP,a.XMP]]);function be(e){var t;return(t=Gs.get(e))!==null&&t!==void 0?t:a.UNKNOWN}const I=a,$s={[C.HTML]:new Set([I.ADDRESS,I.APPLET,I.AREA,I.ARTICLE,I.ASIDE,I.BASE,I.BASEFONT,I.BGSOUND,I.BLOCKQUOTE,I.BODY,I.BR,I.BUTTON,I.CAPTION,I.CENTER,I.COL,I.COLGROUP,I.DD,I.DETAILS,I.DIR,I.DIV,I.DL,I.DT,I.EMBED,I.FIELDSET,I.FIGCAPTION,I.FIGURE,I.FOOTER,I.FORM,I.FRAME,I.FRAMESET,I.H1,I.H2,I.H3,I.H4,I.H5,I.H6,I.HEAD,I.HEADER,I.HGROUP,I.HR,I.HTML,I.IFRAME,I.IMG,I.INPUT,I.LI,I.LINK,I.LISTING,I.MAIN,I.MARQUEE,I.MENU,I.META,I.NAV,I.NOEMBED,I.NOFRAMES,I.NOSCRIPT,I.OBJECT,I.OL,I.P,I.PARAM,I.PLAINTEXT,I.PRE,I.SCRIPT,I.SECTION,I.SELECT,I.SOURCE,I.STYLE,I.SUMMARY,I.TABLE,I.TBODY,I.TD,I.TEMPLATE,I.TEXTAREA,I.TFOOT,I.TH,I.THEAD,I.TITLE,I.TR,I.TRACK,I.UL,I.WBR,I.XMP]),[C.MATHML]:new Set([I.MI,I.MO,I.MN,I.MS,I.MTEXT,I.ANNOTATION_XML]),[C.SVG]:new Set([I.TITLE,I.FOREIGN_OBJECT,I.DESC]),[C.XLINK]:new Set,[C.XML]:new Set,[C.XMLNS]:new Set};function bt(e){return e===I.H1||e===I.H2||e===I.H3||e===I.H4||e===I.H5||e===I.H6}const Vs=new Set([A.STYLE,A.SCRIPT,A.XMP,A.IFRAME,A.NOEMBED,A.NOFRAMES,A.PLAINTEXT]);function zs(e,t){return Vs.has(e)||t&&e===A.NOSCRIPT}const qs=new Map([[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]);var E;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.NAMED_CHARACTER_REFERENCE=72]="NAMED_CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=73]="AMBIGUOUS_AMPERSAND",e[e.NUMERIC_CHARACTER_REFERENCE=74]="NUMERIC_CHARACTER_REFERENCE",e[e.HEXADEMICAL_CHARACTER_REFERENCE_START=75]="HEXADEMICAL_CHARACTER_REFERENCE_START",e[e.HEXADEMICAL_CHARACTER_REFERENCE=76]="HEXADEMICAL_CHARACTER_REFERENCE",e[e.DECIMAL_CHARACTER_REFERENCE=77]="DECIMAL_CHARACTER_REFERENCE",e[e.NUMERIC_CHARACTER_REFERENCE_END=78]="NUMERIC_CHARACTER_REFERENCE_END"})(E||(E={}));const H={DATA:E.DATA,RCDATA:E.RCDATA,RAWTEXT:E.RAWTEXT,SCRIPT_DATA:E.SCRIPT_DATA,PLAINTEXT:E.PLAINTEXT,CDATA_SECTION:E.CDATA_SECTION};function ie(e){return e>=i.DIGIT_0&&e<=i.DIGIT_9}function re(e){return e>=i.LATIN_CAPITAL_A&&e<=i.LATIN_CAPITAL_Z}function Js(e){return e>=i.LATIN_SMALL_A&&e<=i.LATIN_SMALL_Z}function W(e){return Js(e)||re(e)}function Ke(e){return W(e)||ie(e)}function Bt(e){return e>=i.LATIN_CAPITAL_A&&e<=i.LATIN_CAPITAL_F}function Ht(e){return e>=i.LATIN_SMALL_A&&e<=i.LATIN_SMALL_F}function js(e){return ie(e)||Bt(e)||Ht(e)}function fe(e){return e+32}function Ft(e){return e===i.SPACE||e===i.LINE_FEED||e===i.TABULATION||e===i.FORM_FEED}function Zs(e){return e===i.EQUALS_SIGN||Ke(e)}function ot(e){return Ft(e)||e===i.SOLIDUS||e===i.GREATER_THAN_SIGN}let ea=class{constructor(t,s){this.options=t,this.handler=s,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=E.DATA,this.returnState=E.DATA,this.charRefCode=-1,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new Ks(s),this.currentLocation=this.getCurrentLocation(-1)}_err(t){var s,n;(n=(s=this.handler).onParseError)===null||n===void 0||n.call(s,this.preprocessor.getError(t))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,s,n){this.active=!0,this.preprocessor.write(t,s),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this._unconsume(this.consumedAfterSnapshot),this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_unconsume(t){this.consumedAfterSnapshot-=t,this.preprocessor.retreat(t)}_reconsumeInState(t,s){this.state=t,this._callState(s)}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let s=0;s<t;s++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,s){return this.preprocessor.startsWith(t,s)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:L.START_TAG,tagName:"",tagID:a.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:L.END_TAG,tagName:"",tagID:a.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:L.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:L.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,s){this.currentCharacterToken={type:t,chars:s,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,s;const n=this.currentToken;if(Mt(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const T=(t=(s=n.location).attrs)!==null&&t!==void 0?t:s.attrs=Object.create(null);T[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(d.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=be(t.tagName),t.type===L.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(d.endTagWithAttributes),t.selfClosing&&this._err(d.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case L.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case L.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case L.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:L.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,s){if(this.currentCharacterToken)if(this.currentCharacterToken.type!==t)this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();else{this.currentCharacterToken.chars+=s;return}this._createCharacterToken(t,s)}_emitCodePoint(t){const s=Ft(t)?L.WHITESPACE_CHARACTER:t===i.NULL?L.NULL_CHARACTER:L.CHARACTER;this._appendCharToCurrentCharacterToken(s,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(L.CHARACTER,t)}_matchNamedCharacterReference(t){let s=null,n=0,T=!1;for(let m=0,O=$[0];m>=0&&(m=Fs($,O,m+1,t),!(m<0));t=this._consume()){n+=1,O=$[m];const R=O&nt.VALUE_LENGTH;if(R){const D=(R>>14)-1;if(t!==i.SEMICOLON&&this._isCharacterReferenceInAttribute()&&Zs(this.preprocessor.peek(1))?(s=[i.AMPERSAND],m+=D):(s=D===0?[$[m]&~nt.VALUE_LENGTH]:D===1?[$[++m]]:[$[++m],$[++m]],n=0,T=t!==i.SEMICOLON),D===0){this._consume();break}}}return this._unconsume(n),T&&!this.preprocessor.endOfChunkHit&&this._err(d.missingSemicolonAfterCharacterReference),this._unconsume(1),s}_isCharacterReferenceInAttribute(){return this.returnState===E.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===E.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===E.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case E.DATA:{this._stateData(t);break}case E.RCDATA:{this._stateRcdata(t);break}case E.RAWTEXT:{this._stateRawtext(t);break}case E.SCRIPT_DATA:{this._stateScriptData(t);break}case E.PLAINTEXT:{this._statePlaintext(t);break}case E.TAG_OPEN:{this._stateTagOpen(t);break}case E.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case E.TAG_NAME:{this._stateTagName(t);break}case E.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case E.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case E.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case E.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case E.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case E.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case E.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case E.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case E.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case E.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case E.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case E.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case E.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case E.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case E.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case E.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case E.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case E.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case E.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case E.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case E.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case E.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case E.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case E.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case E.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case E.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case E.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case E.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case E.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case E.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case E.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case E.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case E.BOGUS_COMMENT:{this._stateBogusComment(t);break}case E.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case E.COMMENT_START:{this._stateCommentStart(t);break}case E.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case E.COMMENT:{this._stateComment(t);break}case E.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case E.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case E.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case E.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case E.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case E.COMMENT_END:{this._stateCommentEnd(t);break}case E.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case E.DOCTYPE:{this._stateDoctype(t);break}case E.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case E.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case E.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case E.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case E.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case E.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case E.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case E.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case E.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case E.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case E.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case E.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case E.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case E.CDATA_SECTION:{this._stateCdataSection(t);break}case E.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case E.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case E.CHARACTER_REFERENCE:{this._stateCharacterReference(t);break}case E.NAMED_CHARACTER_REFERENCE:{this._stateNamedCharacterReference(t);break}case E.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}case E.NUMERIC_CHARACTER_REFERENCE:{this._stateNumericCharacterReference(t);break}case E.HEXADEMICAL_CHARACTER_REFERENCE_START:{this._stateHexademicalCharacterReferenceStart(t);break}case E.HEXADEMICAL_CHARACTER_REFERENCE:{this._stateHexademicalCharacterReference(t);break}case E.DECIMAL_CHARACTER_REFERENCE:{this._stateDecimalCharacterReference(t);break}case E.NUMERIC_CHARACTER_REFERENCE_END:{this._stateNumericCharacterReferenceEnd(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case i.LESS_THAN_SIGN:{this.state=E.TAG_OPEN;break}case i.AMPERSAND:{this.returnState=E.DATA,this.state=E.CHARACTER_REFERENCE;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitCodePoint(t);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case i.AMPERSAND:{this.returnState=E.RCDATA,this.state=E.CHARACTER_REFERENCE;break}case i.LESS_THAN_SIGN:{this.state=E.RCDATA_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(g);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case i.LESS_THAN_SIGN:{this.state=E.RAWTEXT_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(g);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case i.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(g);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(g);break}case i.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(W(t))this._createStartTagToken(),this.state=E.TAG_NAME,this._stateTagName(t);else switch(t){case i.EXCLAMATION_MARK:{this.state=E.MARKUP_DECLARATION_OPEN;break}case i.SOLIDUS:{this.state=E.END_TAG_OPEN;break}case i.QUESTION_MARK:{this._err(d.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=E.BOGUS_COMMENT,this._stateBogusComment(t);break}case i.EOF:{this._err(d.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(d.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=E.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(W(t))this._createEndTagToken(),this.state=E.TAG_NAME,this._stateTagName(t);else switch(t){case i.GREATER_THAN_SIGN:{this._err(d.missingEndTagName),this.state=E.DATA;break}case i.EOF:{this._err(d.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(d.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=E.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=E.BEFORE_ATTRIBUTE_NAME;break}case i.SOLIDUS:{this.state=E.SELF_CLOSING_START_TAG;break}case i.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentTagToken();break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.tagName+=g;break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:s.tagName+=String.fromCodePoint(re(t)?fe(t):t)}}_stateRcdataLessThanSign(t){t===i.SOLIDUS?this.state=E.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=E.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){W(t)?(this.state=E.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=E.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const s=this.currentToken;switch(s.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=E.BEFORE_ATTRIBUTE_NAME,!1;case i.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=E.SELF_CLOSING_START_TAG,!1;case i.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=E.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=E.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===i.SOLIDUS?this.state=E.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=E.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){W(t)?(this.state=E.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=E.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=E.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case i.SOLIDUS:{this.state=E.SCRIPT_DATA_END_TAG_OPEN;break}case i.EXCLAMATION_MARK:{this.state=E.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=E.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){W(t)?(this.state=E.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=E.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=E.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===i.HYPHEN_MINUS?(this.state=E.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=E.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===i.HYPHEN_MINUS?(this.state=E.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=E.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case i.HYPHEN_MINUS:{this.state=E.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(g);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case i.HYPHEN_MINUS:{this.state=E.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.state=E.SCRIPT_DATA_ESCAPED,this._emitChars(g);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=E.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case i.HYPHEN_MINUS:{this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case i.GREATER_THAN_SIGN:{this.state=E.SCRIPT_DATA,this._emitChars(">");break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.state=E.SCRIPT_DATA_ESCAPED,this._emitChars(g);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=E.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===i.SOLIDUS?this.state=E.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:W(t)?(this._emitChars("<"),this.state=E.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=E.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){W(t)?(this.state=E.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=E.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=E.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(b.SCRIPT,!1)&&ot(this.preprocessor.peek(b.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<b.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=E.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case i.HYPHEN_MINUS:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.NULL:{this._err(d.unexpectedNullCharacter),this._emitChars(g);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case i.HYPHEN_MINUS:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(g);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case i.HYPHEN_MINUS:{this._emitChars("-");break}case i.LESS_THAN_SIGN:{this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case i.GREATER_THAN_SIGN:{this.state=E.SCRIPT_DATA,this._emitChars(">");break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(g);break}case i.EOF:{this._err(d.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===i.SOLIDUS?(this.state=E.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(b.SCRIPT,!1)&&ot(this.preprocessor.peek(b.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<b.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=E.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=E.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.SOLIDUS:case i.GREATER_THAN_SIGN:case i.EOF:{this.state=E.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case i.EQUALS_SIGN:{this._err(d.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=E.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=E.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:case i.SOLIDUS:case i.GREATER_THAN_SIGN:case i.EOF:{this._leaveAttrName(),this.state=E.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case i.EQUALS_SIGN:{this._leaveAttrName(),this.state=E.BEFORE_ATTRIBUTE_VALUE;break}case i.QUOTATION_MARK:case i.APOSTROPHE:case i.LESS_THAN_SIGN:{this._err(d.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.currentAttr.name+=g;break}default:this.currentAttr.name+=String.fromCodePoint(re(t)?fe(t):t)}}_stateAfterAttributeName(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.SOLIDUS:{this.state=E.SELF_CLOSING_START_TAG;break}case i.EQUALS_SIGN:{this.state=E.BEFORE_ATTRIBUTE_VALUE;break}case i.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=E.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{this.state=E.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this.state=E.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingAttributeValue),this.state=E.DATA,this.emitCurrentTagToken();break}default:this.state=E.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case i.QUOTATION_MARK:{this.state=E.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case i.AMPERSAND:{this.returnState=E.ATTRIBUTE_VALUE_DOUBLE_QUOTED,this.state=E.CHARACTER_REFERENCE;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.currentAttr.value+=g;break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case i.APOSTROPHE:{this.state=E.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case i.AMPERSAND:{this.returnState=E.ATTRIBUTE_VALUE_SINGLE_QUOTED,this.state=E.CHARACTER_REFERENCE;break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.currentAttr.value+=g;break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this._leaveAttrValue(),this.state=E.BEFORE_ATTRIBUTE_NAME;break}case i.AMPERSAND:{this.returnState=E.ATTRIBUTE_VALUE_UNQUOTED,this.state=E.CHARACTER_REFERENCE;break}case i.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=E.DATA,this.emitCurrentTagToken();break}case i.NULL:{this._err(d.unexpectedNullCharacter),this.currentAttr.value+=g;break}case i.QUOTATION_MARK:case i.APOSTROPHE:case i.LESS_THAN_SIGN:case i.EQUALS_SIGN:case i.GRAVE_ACCENT:{this._err(d.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this._leaveAttrValue(),this.state=E.BEFORE_ATTRIBUTE_NAME;break}case i.SOLIDUS:{this._leaveAttrValue(),this.state=E.SELF_CLOSING_START_TAG;break}case i.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=E.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this._err(d.missingWhitespaceBetweenAttributes),this.state=E.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case i.GREATER_THAN_SIGN:{const s=this.currentToken;s.selfClosing=!0,this.state=E.DATA,this.emitCurrentTagToken();break}case i.EOF:{this._err(d.eofInTag),this._emitEOFToken();break}default:this._err(d.unexpectedSolidusInTag),this.state=E.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentComment(s);break}case i.EOF:{this.emitCurrentComment(s),this._emitEOFToken();break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.data+=g;break}default:s.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(b.DASH_DASH,!0)?(this._createCommentToken(b.DASH_DASH.length+1),this.state=E.COMMENT_START):this._consumeSequenceIfMatch(b.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(b.DOCTYPE.length+1),this.state=E.DOCTYPE):this._consumeSequenceIfMatch(b.CDATA_START,!0)?this.inForeignNode?this.state=E.CDATA_SECTION:(this._err(d.cdataInHtmlContent),this._createCommentToken(b.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=E.BOGUS_COMMENT):this._ensureHibernation()||(this._err(d.incorrectlyOpenedComment),this._createCommentToken(2),this.state=E.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case i.HYPHEN_MINUS:{this.state=E.COMMENT_START_DASH;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptClosingOfEmptyComment),this.state=E.DATA;const s=this.currentToken;this.emitCurrentComment(s);break}default:this.state=E.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=E.COMMENT_END;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptClosingOfEmptyComment),this.state=E.DATA,this.emitCurrentComment(s);break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=E.COMMENT,this._stateComment(t)}}_stateComment(t){const s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=E.COMMENT_END_DASH;break}case i.LESS_THAN_SIGN:{s.data+="<",this.state=E.COMMENT_LESS_THAN_SIGN;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.data+=g;break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const s=this.currentToken;switch(t){case i.EXCLAMATION_MARK:{s.data+="!",this.state=E.COMMENT_LESS_THAN_SIGN_BANG;break}case i.LESS_THAN_SIGN:{s.data+="<";break}default:this.state=E.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===i.HYPHEN_MINUS?this.state=E.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=E.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===i.HYPHEN_MINUS?this.state=E.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=E.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==i.GREATER_THAN_SIGN&&t!==i.EOF&&this._err(d.nestedComment),this.state=E.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{this.state=E.COMMENT_END;break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=E.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentComment(s);break}case i.EXCLAMATION_MARK:{this.state=E.COMMENT_END_BANG;break}case i.HYPHEN_MINUS:{s.data+="-";break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--",this.state=E.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const s=this.currentToken;switch(t){case i.HYPHEN_MINUS:{s.data+="--!",this.state=E.COMMENT_END_DASH;break}case i.GREATER_THAN_SIGN:{this._err(d.incorrectlyClosedComment),this.state=E.DATA,this.emitCurrentComment(s);break}case i.EOF:{this._err(d.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--!",this.state=E.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=E.BEFORE_DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this.state=E.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case i.EOF:{this._err(d.eofInDoctype),this._createDoctypeToken(null);const s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingWhitespaceBeforeDoctypeName),this.state=E.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(re(t))this._createDoctypeToken(String.fromCharCode(fe(t))),this.state=E.DOCTYPE_NAME;else switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.NULL:{this._err(d.unexpectedNullCharacter),this._createDoctypeToken(g),this.state=E.DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypeName),this._createDoctypeToken(null);const s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=E.DATA;break}case i.EOF:{this._err(d.eofInDoctype),this._createDoctypeToken(null);const s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=E.DOCTYPE_NAME}}_stateDoctypeName(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=E.AFTER_DOCTYPE_NAME;break}case i.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentDoctype(s);break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.name+=g;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.name+=String.fromCodePoint(re(t)?fe(t):t)}}_stateAfterDoctypeName(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(b.PUBLIC,!1)?this.state=E.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(b.SYSTEM,!1)?this.state=E.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(d.invalidCharacterSequenceAfterDoctypeName),s.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=E.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.QUOTATION_MARK:{this._err(d.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=E.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(d.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=E.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=E.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{s.publicId="",this.state=E.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.publicId="",this.state=E.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=E.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const s=this.currentToken;switch(t){case i.QUOTATION_MARK:{this.state=E.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.publicId+=g;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=E.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const s=this.currentToken;switch(t){case i.APOSTROPHE:{this.state=E.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.publicId+=g;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=E.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=E.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case i.GREATER_THAN_SIGN:{this.state=E.DATA,this.emitCurrentDoctype(s);break}case i.QUOTATION_MARK:{this._err(d.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(d.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=E.DATA;break}case i.QUOTATION_MARK:{s.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:{this.state=E.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.QUOTATION_MARK:{this._err(d.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{this._err(d.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=E.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.QUOTATION_MARK:{s.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case i.APOSTROPHE:{s.systemId="",this.state=E.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case i.GREATER_THAN_SIGN:{this._err(d.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=E.DATA,this.emitCurrentDoctype(s);break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const s=this.currentToken;switch(t){case i.QUOTATION_MARK:{this.state=E.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.systemId+=g;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=E.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const s=this.currentToken;switch(t){case i.APOSTROPHE:{this.state=E.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case i.NULL:{this._err(d.unexpectedNullCharacter),s.systemId+=g;break}case i.GREATER_THAN_SIGN:{this._err(d.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=E.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const s=this.currentToken;switch(t){case i.SPACE:case i.LINE_FEED:case i.TABULATION:case i.FORM_FEED:break;case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=E.DATA;break}case i.EOF:{this._err(d.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(d.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=E.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const s=this.currentToken;switch(t){case i.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=E.DATA;break}case i.NULL:{this._err(d.unexpectedNullCharacter);break}case i.EOF:{this.emitCurrentDoctype(s),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case i.RIGHT_SQUARE_BRACKET:{this.state=E.CDATA_SECTION_BRACKET;break}case i.EOF:{this._err(d.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===i.RIGHT_SQUARE_BRACKET?this.state=E.CDATA_SECTION_END:(this._emitChars("]"),this.state=E.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case i.GREATER_THAN_SIGN:{this.state=E.DATA;break}case i.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=E.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(t){t===i.NUMBER_SIGN?this.state=E.NUMERIC_CHARACTER_REFERENCE:Ke(t)?(this.state=E.NAMED_CHARACTER_REFERENCE,this._stateNamedCharacterReference(t)):(this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._reconsumeInState(this.returnState,t))}_stateNamedCharacterReference(t){const s=this._matchNamedCharacterReference(t);if(!this._ensureHibernation())if(s){for(let n=0;n<s.length;n++)this._flushCodePointConsumedAsCharacterReference(s[n]);this.state=this.returnState}else this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this.state=E.AMBIGUOUS_AMPERSAND}_stateAmbiguousAmpersand(t){Ke(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===i.SEMICOLON&&this._err(d.unknownNamedCharacterReference),this._reconsumeInState(this.returnState,t))}_stateNumericCharacterReference(t){this.charRefCode=0,t===i.LATIN_SMALL_X||t===i.LATIN_CAPITAL_X?this.state=E.HEXADEMICAL_CHARACTER_REFERENCE_START:ie(t)?(this.state=E.DECIMAL_CHARACTER_REFERENCE,this._stateDecimalCharacterReference(t)):(this._err(d.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(i.NUMBER_SIGN),this._reconsumeInState(this.returnState,t))}_stateHexademicalCharacterReferenceStart(t){js(t)?(this.state=E.HEXADEMICAL_CHARACTER_REFERENCE,this._stateHexademicalCharacterReference(t)):(this._err(d.absenceOfDigitsInNumericCharacterReference),this._flushCodePointConsumedAsCharacterReference(i.AMPERSAND),this._flushCodePointConsumedAsCharacterReference(i.NUMBER_SIGN),this._unconsume(2),this.state=this.returnState)}_stateHexademicalCharacterReference(t){Bt(t)?this.charRefCode=this.charRefCode*16+t-55:Ht(t)?this.charRefCode=this.charRefCode*16+t-87:ie(t)?this.charRefCode=this.charRefCode*16+t-48:t===i.SEMICOLON?this.state=E.NUMERIC_CHARACTER_REFERENCE_END:(this._err(d.missingSemicolonAfterCharacterReference),this.state=E.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateDecimalCharacterReference(t){ie(t)?this.charRefCode=this.charRefCode*10+t-48:t===i.SEMICOLON?this.state=E.NUMERIC_CHARACTER_REFERENCE_END:(this._err(d.missingSemicolonAfterCharacterReference),this.state=E.NUMERIC_CHARACTER_REFERENCE_END,this._stateNumericCharacterReferenceEnd(t))}_stateNumericCharacterReferenceEnd(t){if(this.charRefCode===i.NULL)this._err(d.nullCharacterReference),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(this.charRefCode>1114111)this._err(d.characterReferenceOutsideUnicodeRange),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(gt(this.charRefCode))this._err(d.surrogateCharacterReference),this.charRefCode=i.REPLACEMENT_CHARACTER;else if(pt(this.charRefCode))this._err(d.noncharacterCharacterReference);else if(Pt(this.charRefCode)||this.charRefCode===i.CARRIAGE_RETURN){this._err(d.controlCharacterReference);const s=qs.get(this.charRefCode);s!==void 0&&(this.charRefCode=s)}this._flushCodePointConsumedAsCharacterReference(this.charRefCode),this._reconsumeInState(this.returnState,t)}};const Ut=new Set([a.DD,a.DT,a.LI,a.OPTGROUP,a.OPTION,a.P,a.RB,a.RP,a.RT,a.RTC]),Et=new Set([...Ut,a.CAPTION,a.COLGROUP,a.TBODY,a.TD,a.TFOOT,a.TH,a.THEAD,a.TR]),Oe=new Map([[a.APPLET,C.HTML],[a.CAPTION,C.HTML],[a.HTML,C.HTML],[a.MARQUEE,C.HTML],[a.OBJECT,C.HTML],[a.TABLE,C.HTML],[a.TD,C.HTML],[a.TEMPLATE,C.HTML],[a.TH,C.HTML],[a.ANNOTATION_XML,C.MATHML],[a.MI,C.MATHML],[a.MN,C.MATHML],[a.MO,C.MATHML],[a.MS,C.MATHML],[a.MTEXT,C.MATHML],[a.DESC,C.SVG],[a.FOREIGN_OBJECT,C.SVG],[a.TITLE,C.SVG]]),ta=[a.H1,a.H2,a.H3,a.H4,a.H5,a.H6],sa=[a.TR,a.TEMPLATE,a.HTML],aa=[a.TBODY,a.TFOOT,a.THEAD,a.TEMPLATE,a.HTML],ra=[a.TABLE,a.TEMPLATE,a.HTML],na=[a.TD,a.TH];let ia=class{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,s,n){this.treeAdapter=s,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=a.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===a.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===C.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,s){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=s,this.currentTagId=s,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,s,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,s){const n=this._indexOf(t);this.items[n]=s,n===this.stackTop&&(this.current=s)}insertAfter(t,s,n){const T=this._indexOf(t)+1;this.items.splice(T,0,s),this.tagIDs.splice(T,0,n),this.stackTop++,T===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,T===this.stackTop)}popUntilTagNamePopped(t){let s=this.stackTop+1;do s=this.tagIDs.lastIndexOf(t,s-1);while(s>0&&this.treeAdapter.getNamespaceURI(this.items[s])!==C.HTML);this.shortenToLength(s<0?0:s)}shortenToLength(t){for(;this.stackTop>=t;){const s=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(s,this.stackTop<t)}}popUntilElementPopped(t){const s=this._indexOf(t);this.shortenToLength(s<0?0:s)}popUntilPopped(t,s){const n=this._indexOfTagNames(t,s);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(ta,C.HTML)}popUntilTableCellPopped(){this.popUntilPopped(na,C.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,s){for(let n=this.stackTop;n>=0;n--)if(t.includes(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===s)return n;return-1}clearBackTo(t,s){const n=this._indexOfTagNames(t,s);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(ra,C.HTML)}clearBackToTableBodyContext(){this.clearBackTo(aa,C.HTML)}clearBackToTableRowContext(){this.clearBackTo(sa,C.HTML)}remove(t){const s=this._indexOf(t);s>=0&&(s===this.stackTop?this.pop():(this.items.splice(s,1),this.tagIDs.splice(s,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===a.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const s=this._indexOf(t)-1;return s>=0?this.items[s]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===a.HTML}hasInScope(t){for(let s=this.stackTop;s>=0;s--){const n=this.tagIDs[s],T=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&T===C.HTML)return!0;if(Oe.get(n)===T)return!1}return!0}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const s=this.tagIDs[t],n=this.treeAdapter.getNamespaceURI(this.items[t]);if(bt(s)&&n===C.HTML)return!0;if(Oe.get(s)===n)return!1}return!0}hasInListItemScope(t){for(let s=this.stackTop;s>=0;s--){const n=this.tagIDs[s],T=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&T===C.HTML)return!0;if((n===a.UL||n===a.OL)&&T===C.HTML||Oe.get(n)===T)return!1}return!0}hasInButtonScope(t){for(let s=this.stackTop;s>=0;s--){const n=this.tagIDs[s],T=this.treeAdapter.getNamespaceURI(this.items[s]);if(n===t&&T===C.HTML)return!0;if(n===a.BUTTON&&T===C.HTML||Oe.get(n)===T)return!1}return!0}hasInTableScope(t){for(let s=this.stackTop;s>=0;s--){const n=this.tagIDs[s];if(this.treeAdapter.getNamespaceURI(this.items[s])===C.HTML){if(n===t)return!0;if(n===a.TABLE||n===a.TEMPLATE||n===a.HTML)return!1}}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--){const s=this.tagIDs[t];if(this.treeAdapter.getNamespaceURI(this.items[t])===C.HTML){if(s===a.TBODY||s===a.THEAD||s===a.TFOOT)return!0;if(s===a.TABLE||s===a.HTML)return!1}}return!0}hasInSelectScope(t){for(let s=this.stackTop;s>=0;s--){const n=this.tagIDs[s];if(this.treeAdapter.getNamespaceURI(this.items[s])===C.HTML){if(n===t)return!0;if(n!==a.OPTION&&n!==a.OPTGROUP)return!1}}return!0}generateImpliedEndTags(){for(;Ut.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;Et.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&Et.has(this.currentTagId);)this.pop()}};const ve=3;var x;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(x=x||(x={}));const ct={type:x.Marker};let oa=class{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,s){const n=[],T=s.length,m=this.treeAdapter.getTagName(t),O=this.treeAdapter.getNamespaceURI(t);for(let R=0;R<this.entries.length;R++){const D=this.entries[R];if(D.type===x.Marker)break;const{element:U}=D;if(this.treeAdapter.getTagName(U)===m&&this.treeAdapter.getNamespaceURI(U)===O){const Q=this.treeAdapter.getAttrList(U);Q.length===T&&n.push({idx:R,attrs:Q})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<ve)return;const s=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,s);if(n.length<ve)return;const T=new Map(s.map(O=>[O.name,O.value]));let m=0;for(let O=0;O<n.length;O++){const R=n[O];R.attrs.every(D=>T.get(D.name)===D.value)&&(m+=1,m>=ve&&this.entries.splice(R.idx,1))}}insertMarker(){this.entries.unshift(ct)}pushElement(t,s){this._ensureNoahArkCondition(t),this.entries.unshift({type:x.Element,element:t,token:s})}insertElementAfterBookmark(t,s){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:x.Element,element:t,token:s})}removeEntry(t){const s=this.entries.indexOf(t);s>=0&&this.entries.splice(s,1)}clearToLastMarker(){const t=this.entries.indexOf(ct);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const s=this.entries.find(n=>n.type===x.Marker||this.treeAdapter.getTagName(n.element)===t);return s&&s.type===x.Element?s:null}getElementEntry(t){return this.entries.find(s=>s.type===x.Element&&s.element===t)}};function Tt(e){return{nodeName:"#text",value:e,parentNode:null}}const V={createDocument(){return{nodeName:"#document",mode:k.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,s){return{nodeName:e,tagName:e,attrs:s,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,s){const n=e.childNodes.indexOf(s);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,s,n){const T=e.childNodes.find(m=>m.nodeName==="#documentType");if(T)T.name=t,T.publicId=s,T.systemId=n;else{const m={nodeName:"#documentType",name:t,publicId:s,systemId:n,parentNode:null};V.appendChild(e,m)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const s=e.childNodes[e.childNodes.length-1];if(V.isTextNode(s)){s.value+=t;return}}V.appendChild(e,Tt(t))},insertTextBefore(e,t,s){const n=e.childNodes[e.childNodes.indexOf(s)-1];n&&V.isTextNode(n)?n.value+=t:V.insertBefore(e,Tt(t),s)},adoptAttributes(e,t){const s=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)s.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},kt="html",Ea="about:legacy-compat",ca="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",yt=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],Ta=[...yt,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],ha=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),xt=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],_a=[...xt,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function ht(e,t){return t.some(s=>e.startsWith(s))}function la(e){return e.name===kt&&e.publicId===null&&(e.systemId===null||e.systemId===Ea)}function Aa(e){if(e.name!==kt)return k.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===ca)return k.QUIRKS;let{publicId:s}=e;if(s!==null){if(s=s.toLowerCase(),ha.has(s))return k.QUIRKS;let n=t===null?Ta:yt;if(ht(s,n))return k.QUIRKS;if(n=t===null?xt:_a,ht(s,n))return k.LIMITED_QUIRKS}return k.NO_QUIRKS}const _t={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},ma="definitionurl",da="definitionURL",ua=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),Ca=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:C.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:C.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:C.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:C.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:C.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:C.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:C.XLINK}],["xml:base",{prefix:"xml",name:"base",namespace:C.XML}],["xml:lang",{prefix:"xml",name:"lang",namespace:C.XML}],["xml:space",{prefix:"xml",name:"space",namespace:C.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:C.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:C.XMLNS}]]),Na=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),Ia=new Set([a.B,a.BIG,a.BLOCKQUOTE,a.BODY,a.BR,a.CENTER,a.CODE,a.DD,a.DIV,a.DL,a.DT,a.EM,a.EMBED,a.H1,a.H2,a.H3,a.H4,a.H5,a.H6,a.HEAD,a.HR,a.I,a.IMG,a.LI,a.LISTING,a.MENU,a.META,a.NOBR,a.OL,a.P,a.PRE,a.RUBY,a.S,a.SMALL,a.SPAN,a.STRONG,a.STRIKE,a.SUB,a.SUP,a.TABLE,a.TT,a.U,a.UL,a.VAR]);function fa(e){const t=e.tagID;return t===a.FONT&&e.attrs.some(({name:n})=>n===G.COLOR||n===G.SIZE||n===G.FACE)||Ia.has(t)}function Yt(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===ma){e.attrs[t].name=da;break}}function wt(e){for(let t=0;t<e.attrs.length;t++){const s=ua.get(e.attrs[t].name);s!=null&&(e.attrs[t].name=s)}}function Je(e){for(let t=0;t<e.attrs.length;t++){const s=Ca.get(e.attrs[t].name);s&&(e.attrs[t].prefix=s.prefix,e.attrs[t].name=s.name,e.attrs[t].namespace=s.namespace)}}function Oa(e){const t=Na.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=be(e.tagName))}function Ra(e,t){return t===C.MATHML&&(e===a.MI||e===a.MO||e===a.MN||e===a.MS||e===a.MTEXT)}function La(e,t,s){if(t===C.MATHML&&e===a.ANNOTATION_XML){for(let n=0;n<s.length;n++)if(s[n].name===G.ENCODING){const T=s[n].value.toLowerCase();return T===_t.TEXT_HTML||T===_t.APPLICATION_XML}}return t===C.SVG&&(e===a.FOREIGN_OBJECT||e===a.DESC||e===a.TITLE)}function Sa(e,t,s,n){return(!n||n===C.HTML)&&La(e,t,s)||(!n||n===C.MATHML)&&Ra(e,t)}const Da="hidden",ga=8,Pa=3;var h;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(h||(h={}));const pa={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},vt=new Set([a.TABLE,a.TBODY,a.TFOOT,a.THEAD,a.TR]),lt={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:V,onParseError:null};let Qt=class{constructor(t,s,n=null,T=null){this.fragmentContext=n,this.scriptHandler=T,this.currentToken=null,this.stopped=!1,this.insertionMode=h.INITIAL,this.originalInsertionMode=h.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...lt,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=s??this.treeAdapter.createDocument(),this.tokenizer=new ea(this.options,this),this.activeFormattingElements=new oa(this.treeAdapter),this.fragmentContextID=n?be(this.treeAdapter.getTagName(n)):a.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new ia(this.document,this.treeAdapter,this)}static parse(t,s){const n=new this(s);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,s){const n={...lt,...s};t??(t=n.treeAdapter.createElement(A.TEMPLATE,C.HTML,[]));const T=n.treeAdapter.createElement("documentmock",C.HTML,[]),m=new this(n,T,t);return m.fragmentContextID===a.TEMPLATE&&m.tmplInsertionModeStack.unshift(h.IN_TEMPLATE),m._initTokenizerForFragmentParsing(),m._insertFakeRootElement(),m._resetInsertionMode(),m._findFormInFragmentContext(),m}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),s=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,s),s}_err(t,s,n){var T;if(!this.onParseError)return;const m=(T=t.location)!==null&&T!==void 0?T:pa,O={code:s,startLine:m.startLine,startCol:m.startCol,startOffset:m.startOffset,endLine:n?m.startLine:m.endLine,endCol:n?m.startCol:m.endCol,endOffset:n?m.startOffset:m.endOffset};this.onParseError(O)}onItemPush(t,s,n){var T,m;(m=(T=this.treeAdapter).onItemPush)===null||m===void 0||m.call(T,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,s)}onItemPop(t,s){var n,T;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(T=(n=this.treeAdapter).onItemPop)===null||T===void 0||T.call(n,t,this.openElements.current),s){let m,O;this.openElements.stackTop===0&&this.fragmentContext?(m=this.fragmentContext,O=this.fragmentContextID):{current:m,currentTagId:O}=this.openElements,this._setContextModes(m,O)}}_setContextModes(t,s){const n=t===this.document||this.treeAdapter.getNamespaceURI(t)===C.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(s,t)}_switchToTextParsing(t,s){this._insertElement(t,C.HTML),this.tokenizer.state=s,this.originalInsertionMode=this.insertionMode,this.insertionMode=h.TEXT}switchToPlaintextParsing(){this.insertionMode=h.TEXT,this.originalInsertionMode=h.IN_BODY,this.tokenizer.state=H.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===A.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==C.HTML))switch(this.fragmentContextID){case a.TITLE:case a.TEXTAREA:{this.tokenizer.state=H.RCDATA;break}case a.STYLE:case a.XMP:case a.IFRAME:case a.NOEMBED:case a.NOFRAMES:case a.NOSCRIPT:{this.tokenizer.state=H.RAWTEXT;break}case a.SCRIPT:{this.tokenizer.state=H.SCRIPT_DATA;break}case a.PLAINTEXT:{this.tokenizer.state=H.PLAINTEXT;break}}}_setDocumentType(t){const s=t.name||"",n=t.publicId||"",T=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,s,n,T),t.location){const O=this.treeAdapter.getChildNodes(this.document).find(R=>this.treeAdapter.isDocumentTypeNode(R));O&&this.treeAdapter.setNodeSourceCodeLocation(O,t.location)}}_attachElementToTree(t,s){if(this.options.sourceCodeLocationInfo){const n=s&&{...s,startTag:s};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,s){const n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,s){const n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,s){const n=this.treeAdapter.createElement(t,C.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,s)}_insertTemplate(t){const s=this.treeAdapter.createElement(t.tagName,C.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(s,n),this._attachElementToTree(s,t.location),this.openElements.push(s,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(A.HTML,C.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,a.HTML)}_appendCommentNode(t,s){const n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(s,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let s,n;if(this._shouldFosterParentOnInsertion()?({parent:s,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(s,t.chars,n):this.treeAdapter.insertText(s,t.chars)):(s=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(s,t.chars)),!t.location)return;const T=this.treeAdapter.getChildNodes(s),m=n?T.lastIndexOf(n):T.length,O=T[m-1];if(this.treeAdapter.getNodeSourceCodeLocation(O)){const{endLine:D,endCol:U,endOffset:Q}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(O,{endLine:D,endCol:U,endOffset:Q})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(O,t.location)}_adoptNodes(t,s){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(s,n)}_setEndLocation(t,s){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&s.location){const n=s.location,T=this.treeAdapter.getTagName(t),m=s.type===L.END_TAG&&T===s.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,m)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let s,n;return this.openElements.stackTop===0&&this.fragmentContext?(s=this.fragmentContext,n=this.fragmentContextID):{current:s,currentTagId:n}=this.openElements,t.tagID===a.SVG&&this.treeAdapter.getTagName(s)===A.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(s)===C.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===a.MGLYPH||t.tagID===a.MALIGNMARK)&&!this._isIntegrationPoint(n,s,C.HTML)}_processToken(t){switch(t.type){case L.CHARACTER:{this.onCharacter(t);break}case L.NULL_CHARACTER:{this.onNullCharacter(t);break}case L.COMMENT:{this.onComment(t);break}case L.DOCTYPE:{this.onDoctype(t);break}case L.START_TAG:{this._processStartTag(t);break}case L.END_TAG:{this.onEndTag(t);break}case L.EOF:{this.onEof(t);break}case L.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,s,n){const T=this.treeAdapter.getNamespaceURI(s),m=this.treeAdapter.getAttrList(s);return Sa(t,T,m,n)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const s=this.activeFormattingElements.entries.findIndex(T=>T.type===x.Marker||this.openElements.contains(T.element)),n=s<0?t-1:s-1;for(let T=n;T>=0;T--){const m=this.activeFormattingElements.entries[T];this._insertElement(m.token,this.treeAdapter.getNamespaceURI(m.element)),m.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=h.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(a.P),this.openElements.popUntilTagNamePopped(a.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case a.TR:{this.insertionMode=h.IN_ROW;return}case a.TBODY:case a.THEAD:case a.TFOOT:{this.insertionMode=h.IN_TABLE_BODY;return}case a.CAPTION:{this.insertionMode=h.IN_CAPTION;return}case a.COLGROUP:{this.insertionMode=h.IN_COLUMN_GROUP;return}case a.TABLE:{this.insertionMode=h.IN_TABLE;return}case a.BODY:{this.insertionMode=h.IN_BODY;return}case a.FRAMESET:{this.insertionMode=h.IN_FRAMESET;return}case a.SELECT:{this._resetInsertionModeForSelect(t);return}case a.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case a.HTML:{this.insertionMode=this.headElement?h.AFTER_HEAD:h.BEFORE_HEAD;return}case a.TD:case a.TH:{if(t>0){this.insertionMode=h.IN_CELL;return}break}case a.HEAD:{if(t>0){this.insertionMode=h.IN_HEAD;return}break}}this.insertionMode=h.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let s=t-1;s>0;s--){const n=this.openElements.tagIDs[s];if(n===a.TEMPLATE)break;if(n===a.TABLE){this.insertionMode=h.IN_SELECT_IN_TABLE;return}}this.insertionMode=h.IN_SELECT}_isElementCausesFosterParenting(t){return vt.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const s=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case a.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(s)===C.HTML)return{parent:this.treeAdapter.getTemplateContent(s),beforeElement:null};break}case a.TABLE:{const n=this.treeAdapter.getParentNode(s);return n?{parent:n,beforeElement:s}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const s=this._findFosterParentingLocation();s.beforeElement?this.treeAdapter.insertBefore(s.parent,t,s.beforeElement):this.treeAdapter.appendChild(s.parent,t)}_isSpecialElement(t,s){const n=this.treeAdapter.getNamespaceURI(t);return $s[n].has(s)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){nn(this,t);return}switch(this.insertionMode){case h.INITIAL:{ee(this,t);break}case h.BEFORE_HTML:{oe(this,t);break}case h.BEFORE_HEAD:{Ee(this,t);break}case h.IN_HEAD:{ce(this,t);break}case h.IN_HEAD_NO_SCRIPT:{Te(this,t);break}case h.AFTER_HEAD:{he(this,t);break}case h.IN_BODY:case h.IN_CAPTION:case h.IN_CELL:case h.IN_TEMPLATE:{Wt(this,t);break}case h.TEXT:case h.IN_SELECT:case h.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case h.IN_TABLE:case h.IN_TABLE_BODY:case h.IN_ROW:{Qe(this,t);break}case h.IN_TABLE_TEXT:{qt(this,t);break}case h.IN_COLUMN_GROUP:{De(this,t);break}case h.AFTER_BODY:{ge(this,t);break}case h.AFTER_AFTER_BODY:{Le(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){rn(this,t);return}switch(this.insertionMode){case h.INITIAL:{ee(this,t);break}case h.BEFORE_HTML:{oe(this,t);break}case h.BEFORE_HEAD:{Ee(this,t);break}case h.IN_HEAD:{ce(this,t);break}case h.IN_HEAD_NO_SCRIPT:{Te(this,t);break}case h.AFTER_HEAD:{he(this,t);break}case h.TEXT:{this._insertCharacters(t);break}case h.IN_TABLE:case h.IN_TABLE_BODY:case h.IN_ROW:{Qe(this,t);break}case h.IN_COLUMN_GROUP:{De(this,t);break}case h.AFTER_BODY:{ge(this,t);break}case h.AFTER_AFTER_BODY:{Le(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){Ge(this,t);return}switch(this.insertionMode){case h.INITIAL:case h.BEFORE_HTML:case h.BEFORE_HEAD:case h.IN_HEAD:case h.IN_HEAD_NO_SCRIPT:case h.AFTER_HEAD:case h.IN_BODY:case h.IN_TABLE:case h.IN_CAPTION:case h.IN_COLUMN_GROUP:case h.IN_TABLE_BODY:case h.IN_ROW:case h.IN_CELL:case h.IN_SELECT:case h.IN_SELECT_IN_TABLE:case h.IN_TEMPLATE:case h.IN_FRAMESET:case h.AFTER_FRAMESET:{Ge(this,t);break}case h.IN_TABLE_TEXT:{te(this,t);break}case h.AFTER_BODY:{ka(this,t);break}case h.AFTER_AFTER_BODY:case h.AFTER_AFTER_FRAMESET:{ya(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case h.INITIAL:{xa(this,t);break}case h.BEFORE_HEAD:case h.IN_HEAD:case h.IN_HEAD_NO_SCRIPT:case h.AFTER_HEAD:{this._err(t,d.misplacedDoctype);break}case h.IN_TABLE_TEXT:{te(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,d.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?on(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case h.INITIAL:{ee(this,t);break}case h.BEFORE_HTML:{Ya(this,t);break}case h.BEFORE_HEAD:{va(this,t);break}case h.IN_HEAD:{Y(this,t);break}case h.IN_HEAD_NO_SCRIPT:{Wa(this,t);break}case h.AFTER_HEAD:{Ga(this,t);break}case h.IN_BODY:{p(this,t);break}case h.IN_TABLE:{j(this,t);break}case h.IN_TABLE_TEXT:{te(this,t);break}case h.IN_CAPTION:{Qr(this,t);break}case h.IN_COLUMN_GROUP:{et(this,t);break}case h.IN_TABLE_BODY:{Fe(this,t);break}case h.IN_ROW:{Ue(this,t);break}case h.IN_CELL:{Kr(this,t);break}case h.IN_SELECT:{Zt(this,t);break}case h.IN_SELECT_IN_TABLE:{$r(this,t);break}case h.IN_TEMPLATE:{zr(this,t);break}case h.AFTER_BODY:{Jr(this,t);break}case h.IN_FRAMESET:{jr(this,t);break}case h.AFTER_FRAMESET:{en(this,t);break}case h.AFTER_AFTER_BODY:{sn(this,t);break}case h.AFTER_AFTER_FRAMESET:{an(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?En(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case h.INITIAL:{ee(this,t);break}case h.BEFORE_HTML:{wa(this,t);break}case h.BEFORE_HEAD:{Qa(this,t);break}case h.IN_HEAD:{Xa(this,t);break}case h.IN_HEAD_NO_SCRIPT:{Ka(this,t);break}case h.AFTER_HEAD:{$a(this,t);break}case h.IN_BODY:{He(this,t);break}case h.TEXT:{Br(this,t);break}case h.IN_TABLE:{ue(this,t);break}case h.IN_TABLE_TEXT:{te(this,t);break}case h.IN_CAPTION:{Xr(this,t);break}case h.IN_COLUMN_GROUP:{Wr(this,t);break}case h.IN_TABLE_BODY:{$e(this,t);break}case h.IN_ROW:{jt(this,t);break}case h.IN_CELL:{Gr(this,t);break}case h.IN_SELECT:{es(this,t);break}case h.IN_SELECT_IN_TABLE:{Vr(this,t);break}case h.IN_TEMPLATE:{qr(this,t);break}case h.AFTER_BODY:{ss(this,t);break}case h.IN_FRAMESET:{Zr(this,t);break}case h.AFTER_FRAMESET:{tn(this,t);break}case h.AFTER_AFTER_BODY:{Le(this,t);break}}}onEof(t){switch(this.insertionMode){case h.INITIAL:{ee(this,t);break}case h.BEFORE_HTML:{oe(this,t);break}case h.BEFORE_HEAD:{Ee(this,t);break}case h.IN_HEAD:{ce(this,t);break}case h.IN_HEAD_NO_SCRIPT:{Te(this,t);break}case h.AFTER_HEAD:{he(this,t);break}case h.IN_BODY:case h.IN_TABLE:case h.IN_CAPTION:case h.IN_COLUMN_GROUP:case h.IN_TABLE_BODY:case h.IN_ROW:case h.IN_CELL:case h.IN_SELECT:case h.IN_SELECT_IN_TABLE:{Vt(this,t);break}case h.TEXT:{Hr(this,t);break}case h.IN_TABLE_TEXT:{te(this,t);break}case h.IN_TEMPLATE:{ts(this,t);break}case h.AFTER_BODY:case h.IN_FRAMESET:case h.AFTER_FRAMESET:case h.AFTER_AFTER_BODY:case h.AFTER_AFTER_FRAMESET:{Ze(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===i.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case h.IN_HEAD:case h.IN_HEAD_NO_SCRIPT:case h.AFTER_HEAD:case h.TEXT:case h.IN_COLUMN_GROUP:case h.IN_SELECT:case h.IN_SELECT_IN_TABLE:case h.IN_FRAMESET:case h.AFTER_FRAMESET:{this._insertCharacters(t);break}case h.IN_BODY:case h.IN_CAPTION:case h.IN_CELL:case h.IN_TEMPLATE:case h.AFTER_BODY:case h.AFTER_AFTER_BODY:case h.AFTER_AFTER_FRAMESET:{Xt(this,t);break}case h.IN_TABLE:case h.IN_TABLE_BODY:case h.IN_ROW:{Qe(this,t);break}case h.IN_TABLE_TEXT:{zt(this,t);break}}}};function Ma(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return s?e.openElements.contains(s.element)?e.openElements.hasInScope(t.tagID)||(s=null):(e.activeFormattingElements.removeEntry(s),s=null):$t(e,t),s}function ba(e,t){let s=null,n=e.openElements.stackTop;for(;n>=0;n--){const T=e.openElements.items[n];if(T===t.element)break;e._isSpecialElement(T,e.openElements.tagIDs[n])&&(s=T)}return s||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),s}function Ba(e,t,s){let n=t,T=e.openElements.getCommonAncestor(t);for(let m=0,O=T;O!==s;m++,O=T){T=e.openElements.getCommonAncestor(O);const R=e.activeFormattingElements.getElementEntry(O),D=R&&m>=Pa;!R||D?(D&&e.activeFormattingElements.removeEntry(R),e.openElements.remove(O)):(O=Ha(e,R),n===t&&(e.activeFormattingElements.bookmark=R),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(O,n),n=O)}return n}function Ha(e,t){const s=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,s,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function Fa(e,t,s){const n=e.treeAdapter.getTagName(t),T=be(n);if(e._isElementCausesFosterParenting(T))e._fosterParentElement(s);else{const m=e.treeAdapter.getNamespaceURI(t);T===a.TEMPLATE&&m===C.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,s)}}function Ua(e,t,s){const n=e.treeAdapter.getNamespaceURI(s.element),{token:T}=s,m=e.treeAdapter.createElement(T.tagName,n,T.attrs);e._adoptNodes(t,m),e.treeAdapter.appendChild(t,m),e.activeFormattingElements.insertElementAfterBookmark(m,T),e.activeFormattingElements.removeEntry(s),e.openElements.remove(s.element),e.openElements.insertAfter(t,m,T.tagID)}function je(e,t){for(let s=0;s<ga;s++){const n=Ma(e,t);if(!n)break;const T=ba(e,n);if(!T)break;e.activeFormattingElements.bookmark=n;const m=Ba(e,T,n.element),O=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(m),O&&Fa(e,O,m),Ua(e,T,n)}}function Ge(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function ka(e,t){e._appendCommentNode(t,e.openElements.items[0])}function ya(e,t){e._appendCommentNode(t,e.document)}function Ze(e,t){if(e.stopped=!0,t.location){const s=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=s;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],T=e.treeAdapter.getNodeSourceCodeLocation(n);if(T&&!T.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const m=e.openElements.items[1],O=e.treeAdapter.getNodeSourceCodeLocation(m);O&&!O.endTag&&e._setEndLocation(m,t)}}}}function xa(e,t){e._setDocumentType(t);const s=t.forceQuirks?k.QUIRKS:Aa(t);la(t)||e._err(t,d.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,s),e.insertionMode=h.BEFORE_HTML}function ee(e,t){e._err(t,d.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,k.QUIRKS),e.insertionMode=h.BEFORE_HTML,e._processToken(t)}function Ya(e,t){t.tagID===a.HTML?(e._insertElement(t,C.HTML),e.insertionMode=h.BEFORE_HEAD):oe(e,t)}function wa(e,t){const s=t.tagID;(s===a.HTML||s===a.HEAD||s===a.BODY||s===a.BR)&&oe(e,t)}function oe(e,t){e._insertFakeRootElement(),e.insertionMode=h.BEFORE_HEAD,e._processToken(t)}function va(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.HEAD:{e._insertElement(t,C.HTML),e.headElement=e.openElements.current,e.insertionMode=h.IN_HEAD;break}default:Ee(e,t)}}function Qa(e,t){const s=t.tagID;s===a.HEAD||s===a.BODY||s===a.HTML||s===a.BR?Ee(e,t):e._err(t,d.endTagWithoutMatchingOpenElement)}function Ee(e,t){e._insertFakeElement(A.HEAD,a.HEAD),e.headElement=e.openElements.current,e.insertionMode=h.IN_HEAD,e._processToken(t)}function Y(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.BASE:case a.BASEFONT:case a.BGSOUND:case a.LINK:case a.META:{e._appendElement(t,C.HTML),t.ackSelfClosing=!0;break}case a.TITLE:{e._switchToTextParsing(t,H.RCDATA);break}case a.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,H.RAWTEXT):(e._insertElement(t,C.HTML),e.insertionMode=h.IN_HEAD_NO_SCRIPT);break}case a.NOFRAMES:case a.STYLE:{e._switchToTextParsing(t,H.RAWTEXT);break}case a.SCRIPT:{e._switchToTextParsing(t,H.SCRIPT_DATA);break}case a.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=h.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(h.IN_TEMPLATE);break}case a.HEAD:{e._err(t,d.misplacedStartTagForHeadElement);break}default:ce(e,t)}}function Xa(e,t){switch(t.tagID){case a.HEAD:{e.openElements.pop(),e.insertionMode=h.AFTER_HEAD;break}case a.BODY:case a.BR:case a.HTML:{ce(e,t);break}case a.TEMPLATE:{q(e,t);break}default:e._err(t,d.endTagWithoutMatchingOpenElement)}}function q(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==a.TEMPLATE&&e._err(t,d.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(a.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,d.endTagWithoutMatchingOpenElement)}function ce(e,t){e.openElements.pop(),e.insertionMode=h.AFTER_HEAD,e._processToken(t)}function Wa(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.BASEFONT:case a.BGSOUND:case a.HEAD:case a.LINK:case a.META:case a.NOFRAMES:case a.STYLE:{Y(e,t);break}case a.NOSCRIPT:{e._err(t,d.nestedNoscriptInHead);break}default:Te(e,t)}}function Ka(e,t){switch(t.tagID){case a.NOSCRIPT:{e.openElements.pop(),e.insertionMode=h.IN_HEAD;break}case a.BR:{Te(e,t);break}default:e._err(t,d.endTagWithoutMatchingOpenElement)}}function Te(e,t){const s=t.type===L.EOF?d.openElementsLeftAfterEof:d.disallowedContentInNoscriptInHead;e._err(t,s),e.openElements.pop(),e.insertionMode=h.IN_HEAD,e._processToken(t)}function Ga(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.BODY:{e._insertElement(t,C.HTML),e.framesetOk=!1,e.insertionMode=h.IN_BODY;break}case a.FRAMESET:{e._insertElement(t,C.HTML),e.insertionMode=h.IN_FRAMESET;break}case a.BASE:case a.BASEFONT:case a.BGSOUND:case a.LINK:case a.META:case a.NOFRAMES:case a.SCRIPT:case a.STYLE:case a.TEMPLATE:case a.TITLE:{e._err(t,d.abandonedHeadElementChild),e.openElements.push(e.headElement,a.HEAD),Y(e,t),e.openElements.remove(e.headElement);break}case a.HEAD:{e._err(t,d.misplacedStartTagForHeadElement);break}default:he(e,t)}}function $a(e,t){switch(t.tagID){case a.BODY:case a.HTML:case a.BR:{he(e,t);break}case a.TEMPLATE:{q(e,t);break}default:e._err(t,d.endTagWithoutMatchingOpenElement)}}function he(e,t){e._insertFakeElement(A.BODY,a.BODY),e.insertionMode=h.IN_BODY,Be(e,t)}function Be(e,t){switch(t.type){case L.CHARACTER:{Wt(e,t);break}case L.WHITESPACE_CHARACTER:{Xt(e,t);break}case L.COMMENT:{Ge(e,t);break}case L.START_TAG:{p(e,t);break}case L.END_TAG:{He(e,t);break}case L.EOF:{Vt(e,t);break}}}function Xt(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function Wt(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function Va(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function za(e,t){const s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(s,t.attrs))}function qa(e,t){const s=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&s&&(e.treeAdapter.detachNode(s),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,C.HTML),e.insertionMode=h.IN_FRAMESET)}function Ja(e,t){e.openElements.hasInButtonScope(a.P)&&e._closePElement(),e._insertElement(t,C.HTML)}function ja(e,t){e.openElements.hasInButtonScope(a.P)&&e._closePElement(),bt(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,C.HTML)}function Za(e,t){e.openElements.hasInButtonScope(a.P)&&e._closePElement(),e._insertElement(t,C.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function er(e,t){const s=e.openElements.tmplCount>0;(!e.formElement||s)&&(e.openElements.hasInButtonScope(a.P)&&e._closePElement(),e._insertElement(t,C.HTML),s||(e.formElement=e.openElements.current))}function tr(e,t){e.framesetOk=!1;const s=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){const T=e.openElements.tagIDs[n];if(s===a.LI&&T===a.LI||(s===a.DD||s===a.DT)&&(T===a.DD||T===a.DT)){e.openElements.generateImpliedEndTagsWithExclusion(T),e.openElements.popUntilTagNamePopped(T);break}if(T!==a.ADDRESS&&T!==a.DIV&&T!==a.P&&e._isSpecialElement(e.openElements.items[n],T))break}e.openElements.hasInButtonScope(a.P)&&e._closePElement(),e._insertElement(t,C.HTML)}function sr(e,t){e.openElements.hasInButtonScope(a.P)&&e._closePElement(),e._insertElement(t,C.HTML),e.tokenizer.state=H.PLAINTEXT}function ar(e,t){e.openElements.hasInScope(a.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(a.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,C.HTML),e.framesetOk=!1}function rr(e,t){const s=e.activeFormattingElements.getElementEntryInScopeWithTagName(A.A);s&&(je(e,t),e.openElements.remove(s.element),e.activeFormattingElements.removeEntry(s)),e._reconstructActiveFormattingElements(),e._insertElement(t,C.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function nr(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,C.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function ir(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(a.NOBR)&&(je(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,C.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function or(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,C.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function Er(e,t){e.treeAdapter.getDocumentMode(e.document)!==k.QUIRKS&&e.openElements.hasInButtonScope(a.P)&&e._closePElement(),e._insertElement(t,C.HTML),e.framesetOk=!1,e.insertionMode=h.IN_TABLE}function Kt(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,C.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Gt(e){const t=Mt(e,G.TYPE);return t!=null&&t.toLowerCase()===Da}function cr(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,C.HTML),Gt(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function Tr(e,t){e._appendElement(t,C.HTML),t.ackSelfClosing=!0}function hr(e,t){e.openElements.hasInButtonScope(a.P)&&e._closePElement(),e._appendElement(t,C.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function _r(e,t){t.tagName=A.IMG,t.tagID=a.IMG,Kt(e,t)}function lr(e,t){e._insertElement(t,C.HTML),e.skipNextNewLine=!0,e.tokenizer.state=H.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=h.TEXT}function Ar(e,t){e.openElements.hasInButtonScope(a.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,H.RAWTEXT)}function mr(e,t){e.framesetOk=!1,e._switchToTextParsing(t,H.RAWTEXT)}function At(e,t){e._switchToTextParsing(t,H.RAWTEXT)}function dr(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,C.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===h.IN_TABLE||e.insertionMode===h.IN_CAPTION||e.insertionMode===h.IN_TABLE_BODY||e.insertionMode===h.IN_ROW||e.insertionMode===h.IN_CELL?h.IN_SELECT_IN_TABLE:h.IN_SELECT}function ur(e,t){e.openElements.currentTagId===a.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,C.HTML)}function Cr(e,t){e.openElements.hasInScope(a.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,C.HTML)}function Nr(e,t){e.openElements.hasInScope(a.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(a.RTC),e._insertElement(t,C.HTML)}function Ir(e,t){e._reconstructActiveFormattingElements(),Yt(t),Je(t),t.selfClosing?e._appendElement(t,C.MATHML):e._insertElement(t,C.MATHML),t.ackSelfClosing=!0}function fr(e,t){e._reconstructActiveFormattingElements(),wt(t),Je(t),t.selfClosing?e._appendElement(t,C.SVG):e._insertElement(t,C.SVG),t.ackSelfClosing=!0}function mt(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,C.HTML)}function p(e,t){switch(t.tagID){case a.I:case a.S:case a.B:case a.U:case a.EM:case a.TT:case a.BIG:case a.CODE:case a.FONT:case a.SMALL:case a.STRIKE:case a.STRONG:{nr(e,t);break}case a.A:{rr(e,t);break}case a.H1:case a.H2:case a.H3:case a.H4:case a.H5:case a.H6:{ja(e,t);break}case a.P:case a.DL:case a.OL:case a.UL:case a.DIV:case a.DIR:case a.NAV:case a.MAIN:case a.MENU:case a.ASIDE:case a.CENTER:case a.FIGURE:case a.FOOTER:case a.HEADER:case a.HGROUP:case a.DIALOG:case a.DETAILS:case a.ADDRESS:case a.ARTICLE:case a.SECTION:case a.SUMMARY:case a.FIELDSET:case a.BLOCKQUOTE:case a.FIGCAPTION:{Ja(e,t);break}case a.LI:case a.DD:case a.DT:{tr(e,t);break}case a.BR:case a.IMG:case a.WBR:case a.AREA:case a.EMBED:case a.KEYGEN:{Kt(e,t);break}case a.HR:{hr(e,t);break}case a.RB:case a.RTC:{Cr(e,t);break}case a.RT:case a.RP:{Nr(e,t);break}case a.PRE:case a.LISTING:{Za(e,t);break}case a.XMP:{Ar(e,t);break}case a.SVG:{fr(e,t);break}case a.HTML:{Va(e,t);break}case a.BASE:case a.LINK:case a.META:case a.STYLE:case a.TITLE:case a.SCRIPT:case a.BGSOUND:case a.BASEFONT:case a.TEMPLATE:{Y(e,t);break}case a.BODY:{za(e,t);break}case a.FORM:{er(e,t);break}case a.NOBR:{ir(e,t);break}case a.MATH:{Ir(e,t);break}case a.TABLE:{Er(e,t);break}case a.INPUT:{cr(e,t);break}case a.PARAM:case a.TRACK:case a.SOURCE:{Tr(e,t);break}case a.IMAGE:{_r(e,t);break}case a.BUTTON:{ar(e,t);break}case a.APPLET:case a.OBJECT:case a.MARQUEE:{or(e,t);break}case a.IFRAME:{mr(e,t);break}case a.SELECT:{dr(e,t);break}case a.OPTION:case a.OPTGROUP:{ur(e,t);break}case a.NOEMBED:{At(e,t);break}case a.FRAMESET:{qa(e,t);break}case a.TEXTAREA:{lr(e,t);break}case a.NOSCRIPT:{e.options.scriptingEnabled?At(e,t):mt(e,t);break}case a.PLAINTEXT:{sr(e,t);break}case a.COL:case a.TH:case a.TD:case a.TR:case a.HEAD:case a.FRAME:case a.TBODY:case a.TFOOT:case a.THEAD:case a.CAPTION:case a.COLGROUP:break;default:mt(e,t)}}function Or(e,t){if(e.openElements.hasInScope(a.BODY)&&(e.insertionMode=h.AFTER_BODY,e.options.sourceCodeLocationInfo)){const s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e._setEndLocation(s,t)}}function Rr(e,t){e.openElements.hasInScope(a.BODY)&&(e.insertionMode=h.AFTER_BODY,ss(e,t))}function Lr(e,t){const s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s))}function Sr(e){const t=e.openElements.tmplCount>0,{formElement:s}=e;t||(e.formElement=null),(s||t)&&e.openElements.hasInScope(a.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(a.FORM):s&&e.openElements.remove(s))}function Dr(e){e.openElements.hasInButtonScope(a.P)||e._insertFakeElement(A.P,a.P),e._closePElement()}function gr(e){e.openElements.hasInListItemScope(a.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(a.LI),e.openElements.popUntilTagNamePopped(a.LI))}function Pr(e,t){const s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s))}function pr(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function Mr(e,t){const s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker())}function br(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(A.BR,a.BR),e.openElements.pop(),e.framesetOk=!1}function $t(e,t){const s=t.tagName,n=t.tagID;for(let T=e.openElements.stackTop;T>0;T--){const m=e.openElements.items[T],O=e.openElements.tagIDs[T];if(n===O&&(n!==a.UNKNOWN||e.treeAdapter.getTagName(m)===s)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=T&&e.openElements.shortenToLength(T);break}if(e._isSpecialElement(m,O))break}}function He(e,t){switch(t.tagID){case a.A:case a.B:case a.I:case a.S:case a.U:case a.EM:case a.TT:case a.BIG:case a.CODE:case a.FONT:case a.NOBR:case a.SMALL:case a.STRIKE:case a.STRONG:{je(e,t);break}case a.P:{Dr(e);break}case a.DL:case a.UL:case a.OL:case a.DIR:case a.DIV:case a.NAV:case a.PRE:case a.MAIN:case a.MENU:case a.ASIDE:case a.BUTTON:case a.CENTER:case a.FIGURE:case a.FOOTER:case a.HEADER:case a.HGROUP:case a.DIALOG:case a.ADDRESS:case a.ARTICLE:case a.DETAILS:case a.SECTION:case a.SUMMARY:case a.LISTING:case a.FIELDSET:case a.BLOCKQUOTE:case a.FIGCAPTION:{Lr(e,t);break}case a.LI:{gr(e);break}case a.DD:case a.DT:{Pr(e,t);break}case a.H1:case a.H2:case a.H3:case a.H4:case a.H5:case a.H6:{pr(e);break}case a.BR:{br(e);break}case a.BODY:{Or(e,t);break}case a.HTML:{Rr(e,t);break}case a.FORM:{Sr(e);break}case a.APPLET:case a.OBJECT:case a.MARQUEE:{Mr(e,t);break}case a.TEMPLATE:{q(e,t);break}default:$t(e,t)}}function Vt(e,t){e.tmplInsertionModeStack.length>0?ts(e,t):Ze(e,t)}function Br(e,t){var s;t.tagID===a.SCRIPT&&((s=e.scriptHandler)===null||s===void 0||s.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function Hr(e,t){e._err(t,d.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function Qe(e,t){if(vt.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=h.IN_TABLE_TEXT,t.type){case L.CHARACTER:{qt(e,t);break}case L.WHITESPACE_CHARACTER:{zt(e,t);break}}else Ne(e,t)}function Fr(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,C.HTML),e.insertionMode=h.IN_CAPTION}function Ur(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,C.HTML),e.insertionMode=h.IN_COLUMN_GROUP}function kr(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(A.COLGROUP,a.COLGROUP),e.insertionMode=h.IN_COLUMN_GROUP,et(e,t)}function yr(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,C.HTML),e.insertionMode=h.IN_TABLE_BODY}function xr(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(A.TBODY,a.TBODY),e.insertionMode=h.IN_TABLE_BODY,Fe(e,t)}function Yr(e,t){e.openElements.hasInTableScope(a.TABLE)&&(e.openElements.popUntilTagNamePopped(a.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function wr(e,t){Gt(t)?e._appendElement(t,C.HTML):Ne(e,t),t.ackSelfClosing=!0}function vr(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,C.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function j(e,t){switch(t.tagID){case a.TD:case a.TH:case a.TR:{xr(e,t);break}case a.STYLE:case a.SCRIPT:case a.TEMPLATE:{Y(e,t);break}case a.COL:{kr(e,t);break}case a.FORM:{vr(e,t);break}case a.TABLE:{Yr(e,t);break}case a.TBODY:case a.TFOOT:case a.THEAD:{yr(e,t);break}case a.INPUT:{wr(e,t);break}case a.CAPTION:{Fr(e,t);break}case a.COLGROUP:{Ur(e,t);break}default:Ne(e,t)}}function ue(e,t){switch(t.tagID){case a.TABLE:{e.openElements.hasInTableScope(a.TABLE)&&(e.openElements.popUntilTagNamePopped(a.TABLE),e._resetInsertionMode());break}case a.TEMPLATE:{q(e,t);break}case a.BODY:case a.CAPTION:case a.COL:case a.COLGROUP:case a.HTML:case a.TBODY:case a.TD:case a.TFOOT:case a.TH:case a.THEAD:case a.TR:break;default:Ne(e,t)}}function Ne(e,t){const s=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,Be(e,t),e.fosterParentingEnabled=s}function zt(e,t){e.pendingCharacterTokens.push(t)}function qt(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function te(e,t){let s=0;if(e.hasNonWhitespacePendingCharacterToken)for(;s<e.pendingCharacterTokens.length;s++)Ne(e,e.pendingCharacterTokens[s]);else for(;s<e.pendingCharacterTokens.length;s++)e._insertCharacters(e.pendingCharacterTokens[s]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const Jt=new Set([a.CAPTION,a.COL,a.COLGROUP,a.TBODY,a.TD,a.TFOOT,a.TH,a.THEAD,a.TR]);function Qr(e,t){const s=t.tagID;Jt.has(s)?e.openElements.hasInTableScope(a.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(a.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=h.IN_TABLE,j(e,t)):p(e,t)}function Xr(e,t){const s=t.tagID;switch(s){case a.CAPTION:case a.TABLE:{e.openElements.hasInTableScope(a.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(a.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=h.IN_TABLE,s===a.TABLE&&ue(e,t));break}case a.BODY:case a.COL:case a.COLGROUP:case a.HTML:case a.TBODY:case a.TD:case a.TFOOT:case a.TH:case a.THEAD:case a.TR:break;default:He(e,t)}}function et(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.COL:{e._appendElement(t,C.HTML),t.ackSelfClosing=!0;break}case a.TEMPLATE:{Y(e,t);break}default:De(e,t)}}function Wr(e,t){switch(t.tagID){case a.COLGROUP:{e.openElements.currentTagId===a.COLGROUP&&(e.openElements.pop(),e.insertionMode=h.IN_TABLE);break}case a.TEMPLATE:{q(e,t);break}case a.COL:break;default:De(e,t)}}function De(e,t){e.openElements.currentTagId===a.COLGROUP&&(e.openElements.pop(),e.insertionMode=h.IN_TABLE,e._processToken(t))}function Fe(e,t){switch(t.tagID){case a.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,C.HTML),e.insertionMode=h.IN_ROW;break}case a.TH:case a.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(A.TR,a.TR),e.insertionMode=h.IN_ROW,Ue(e,t);break}case a.CAPTION:case a.COL:case a.COLGROUP:case a.TBODY:case a.TFOOT:case a.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=h.IN_TABLE,j(e,t));break}default:j(e,t)}}function $e(e,t){const s=t.tagID;switch(t.tagID){case a.TBODY:case a.TFOOT:case a.THEAD:{e.openElements.hasInTableScope(s)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=h.IN_TABLE);break}case a.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=h.IN_TABLE,ue(e,t));break}case a.BODY:case a.CAPTION:case a.COL:case a.COLGROUP:case a.HTML:case a.TD:case a.TH:case a.TR:break;default:ue(e,t)}}function Ue(e,t){switch(t.tagID){case a.TH:case a.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,C.HTML),e.insertionMode=h.IN_CELL,e.activeFormattingElements.insertMarker();break}case a.CAPTION:case a.COL:case a.COLGROUP:case a.TBODY:case a.TFOOT:case a.THEAD:case a.TR:{e.openElements.hasInTableScope(a.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=h.IN_TABLE_BODY,Fe(e,t));break}default:j(e,t)}}function jt(e,t){switch(t.tagID){case a.TR:{e.openElements.hasInTableScope(a.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=h.IN_TABLE_BODY);break}case a.TABLE:{e.openElements.hasInTableScope(a.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=h.IN_TABLE_BODY,$e(e,t));break}case a.TBODY:case a.TFOOT:case a.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(a.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=h.IN_TABLE_BODY,$e(e,t));break}case a.BODY:case a.CAPTION:case a.COL:case a.COLGROUP:case a.HTML:case a.TD:case a.TH:break;default:ue(e,t)}}function Kr(e,t){const s=t.tagID;Jt.has(s)?(e.openElements.hasInTableScope(a.TD)||e.openElements.hasInTableScope(a.TH))&&(e._closeTableCell(),Ue(e,t)):p(e,t)}function Gr(e,t){const s=t.tagID;switch(s){case a.TD:case a.TH:{e.openElements.hasInTableScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=h.IN_ROW);break}case a.TABLE:case a.TBODY:case a.TFOOT:case a.THEAD:case a.TR:{e.openElements.hasInTableScope(s)&&(e._closeTableCell(),jt(e,t));break}case a.BODY:case a.CAPTION:case a.COL:case a.COLGROUP:case a.HTML:break;default:He(e,t)}}function Zt(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.OPTION:{e.openElements.currentTagId===a.OPTION&&e.openElements.pop(),e._insertElement(t,C.HTML);break}case a.OPTGROUP:{e.openElements.currentTagId===a.OPTION&&e.openElements.pop(),e.openElements.currentTagId===a.OPTGROUP&&e.openElements.pop(),e._insertElement(t,C.HTML);break}case a.INPUT:case a.KEYGEN:case a.TEXTAREA:case a.SELECT:{e.openElements.hasInSelectScope(a.SELECT)&&(e.openElements.popUntilTagNamePopped(a.SELECT),e._resetInsertionMode(),t.tagID!==a.SELECT&&e._processStartTag(t));break}case a.SCRIPT:case a.TEMPLATE:{Y(e,t);break}}}function es(e,t){switch(t.tagID){case a.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===a.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===a.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===a.OPTGROUP&&e.openElements.pop();break}case a.OPTION:{e.openElements.currentTagId===a.OPTION&&e.openElements.pop();break}case a.SELECT:{e.openElements.hasInSelectScope(a.SELECT)&&(e.openElements.popUntilTagNamePopped(a.SELECT),e._resetInsertionMode());break}case a.TEMPLATE:{q(e,t);break}}}function $r(e,t){const s=t.tagID;s===a.CAPTION||s===a.TABLE||s===a.TBODY||s===a.TFOOT||s===a.THEAD||s===a.TR||s===a.TD||s===a.TH?(e.openElements.popUntilTagNamePopped(a.SELECT),e._resetInsertionMode(),e._processStartTag(t)):Zt(e,t)}function Vr(e,t){const s=t.tagID;s===a.CAPTION||s===a.TABLE||s===a.TBODY||s===a.TFOOT||s===a.THEAD||s===a.TR||s===a.TD||s===a.TH?e.openElements.hasInTableScope(s)&&(e.openElements.popUntilTagNamePopped(a.SELECT),e._resetInsertionMode(),e.onEndTag(t)):es(e,t)}function zr(e,t){switch(t.tagID){case a.BASE:case a.BASEFONT:case a.BGSOUND:case a.LINK:case a.META:case a.NOFRAMES:case a.SCRIPT:case a.STYLE:case a.TEMPLATE:case a.TITLE:{Y(e,t);break}case a.CAPTION:case a.COLGROUP:case a.TBODY:case a.TFOOT:case a.THEAD:{e.tmplInsertionModeStack[0]=h.IN_TABLE,e.insertionMode=h.IN_TABLE,j(e,t);break}case a.COL:{e.tmplInsertionModeStack[0]=h.IN_COLUMN_GROUP,e.insertionMode=h.IN_COLUMN_GROUP,et(e,t);break}case a.TR:{e.tmplInsertionModeStack[0]=h.IN_TABLE_BODY,e.insertionMode=h.IN_TABLE_BODY,Fe(e,t);break}case a.TD:case a.TH:{e.tmplInsertionModeStack[0]=h.IN_ROW,e.insertionMode=h.IN_ROW,Ue(e,t);break}default:e.tmplInsertionModeStack[0]=h.IN_BODY,e.insertionMode=h.IN_BODY,p(e,t)}}function qr(e,t){t.tagID===a.TEMPLATE&&q(e,t)}function ts(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(a.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):Ze(e,t)}function Jr(e,t){t.tagID===a.HTML?p(e,t):ge(e,t)}function ss(e,t){var s;if(t.tagID===a.HTML){if(e.fragmentContext||(e.insertionMode=h.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===a.HTML){e._setEndLocation(e.openElements.items[0],t);const n=e.openElements.items[1];n&&!(!((s=e.treeAdapter.getNodeSourceCodeLocation(n))===null||s===void 0)&&s.endTag)&&e._setEndLocation(n,t)}}else ge(e,t)}function ge(e,t){e.insertionMode=h.IN_BODY,Be(e,t)}function jr(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.FRAMESET:{e._insertElement(t,C.HTML);break}case a.FRAME:{e._appendElement(t,C.HTML),t.ackSelfClosing=!0;break}case a.NOFRAMES:{Y(e,t);break}}}function Zr(e,t){t.tagID===a.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==a.FRAMESET&&(e.insertionMode=h.AFTER_FRAMESET))}function en(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.NOFRAMES:{Y(e,t);break}}}function tn(e,t){t.tagID===a.HTML&&(e.insertionMode=h.AFTER_AFTER_FRAMESET)}function sn(e,t){t.tagID===a.HTML?p(e,t):Le(e,t)}function Le(e,t){e.insertionMode=h.IN_BODY,Be(e,t)}function an(e,t){switch(t.tagID){case a.HTML:{p(e,t);break}case a.NOFRAMES:{Y(e,t);break}}}function rn(e,t){t.chars=g,e._insertCharacters(t)}function nn(e,t){e._insertCharacters(t),e.framesetOk=!1}function as(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==C.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function on(e,t){if(fa(t))as(e),e._startTagOutsideForeignContent(t);else{const s=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(s);n===C.MATHML?Yt(t):n===C.SVG&&(Oa(t),wt(t)),Je(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function En(e,t){if(t.tagID===a.P||t.tagID===a.BR){as(e),e._endTagOutsideForeignContent(t);return}for(let s=e.openElements.stackTop;s>0;s--){const n=e.openElements.items[s];if(e.treeAdapter.getNamespaceURI(n)===C.HTML){e._endTagOutsideForeignContent(t);break}const T=e.treeAdapter.getTagName(n);if(T.toLowerCase()===t.tagName){t.tagName=T,e.openElements.shortenToLength(s);break}}}const cn=new Set([A.AREA,A.BASE,A.BASEFONT,A.BGSOUND,A.BR,A.COL,A.EMBED,A.FRAME,A.HR,A.IMG,A.INPUT,A.KEYGEN,A.LINK,A.META,A.PARAM,A.SOURCE,A.TRACK,A.WBR]);function Tn(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===C.HTML&&cn.has(t.treeAdapter.getTagName(e))}const hn={treeAdapter:V,scriptingEnabled:!0};function tE(e,t){const s={...hn,...t};return rs(e,s)}function _n(e,t){let s="";const n=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===A.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===C.HTML?t.treeAdapter.getTemplateContent(e):e,T=t.treeAdapter.getChildNodes(n);if(T)for(const m of T)s+=rs(m,t);return s}function rs(e,t){return t.treeAdapter.isElementNode(e)?ln(e,t):t.treeAdapter.isTextNode(e)?mn(e,t):t.treeAdapter.isCommentNode(e)?dn(e,t):t.treeAdapter.isDocumentTypeNode(e)?un(e,t):""}function ln(e,t){const s=t.treeAdapter.getTagName(e);return`<${s}${An(e,t)}>${Tn(e,t)?"":`${_n(e,t)}</${s}>`}`}function An(e,{treeAdapter:t}){let s="";for(const n of t.getAttrList(e)){if(s+=" ",!n.namespace)s+=n.name;else switch(n.namespace){case C.XML:{s+=`xml:${n.name}`;break}case C.XMLNS:{n.name!=="xmlns"&&(s+="xmlns:"),s+=n.name;break}case C.XLINK:{s+=`xlink:${n.name}`;break}default:s+=`${n.prefix}:${n.name}`}s+=`="${Us(n.value)}"`}return s}function mn(e,t){const{treeAdapter:s}=t,n=s.getTextNodeContent(e),T=s.getParentNode(e),m=T&&s.isElementNode(T)&&s.getTagName(T);return m&&s.getNamespaceURI(T)===C.HTML&&zs(m,t.scriptingEnabled)?n:ks(n)}function dn(e,{treeAdapter:t}){return`<!--${t.getCommentNodeContent(e)}-->`}function un(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}function sE(e,t){return Qt.parse(e,t)}function aE(e,t,s){typeof e=="string"&&(s=t,t=e,e=null);const n=Qt.getFragmentParser(e,s);return n.tokenizer.write(t,!0),n.getFragment()}const Cn=new Set([65534,65535,131070,131071,196606,196607,262142,262143,327678,327679,393214,393215,458750,458751,524286,524287,589822,589823,655358,655359,720894,720895,786430,786431,851966,851967,917502,917503,983038,983039,1048574,1048575,1114110,1114111]),P="ï¿½";var o;(function(e){e[e.EOF=-1]="EOF",e[e.NULL=0]="NULL",e[e.TABULATION=9]="TABULATION",e[e.CARRIAGE_RETURN=13]="CARRIAGE_RETURN",e[e.LINE_FEED=10]="LINE_FEED",e[e.FORM_FEED=12]="FORM_FEED",e[e.SPACE=32]="SPACE",e[e.EXCLAMATION_MARK=33]="EXCLAMATION_MARK",e[e.QUOTATION_MARK=34]="QUOTATION_MARK",e[e.AMPERSAND=38]="AMPERSAND",e[e.APOSTROPHE=39]="APOSTROPHE",e[e.HYPHEN_MINUS=45]="HYPHEN_MINUS",e[e.SOLIDUS=47]="SOLIDUS",e[e.DIGIT_0=48]="DIGIT_0",e[e.DIGIT_9=57]="DIGIT_9",e[e.SEMICOLON=59]="SEMICOLON",e[e.LESS_THAN_SIGN=60]="LESS_THAN_SIGN",e[e.EQUALS_SIGN=61]="EQUALS_SIGN",e[e.GREATER_THAN_SIGN=62]="GREATER_THAN_SIGN",e[e.QUESTION_MARK=63]="QUESTION_MARK",e[e.LATIN_CAPITAL_A=65]="LATIN_CAPITAL_A",e[e.LATIN_CAPITAL_Z=90]="LATIN_CAPITAL_Z",e[e.RIGHT_SQUARE_BRACKET=93]="RIGHT_SQUARE_BRACKET",e[e.GRAVE_ACCENT=96]="GRAVE_ACCENT",e[e.LATIN_SMALL_A=97]="LATIN_SMALL_A",e[e.LATIN_SMALL_Z=122]="LATIN_SMALL_Z"})(o||(o={}));const B={DASH_DASH:"--",CDATA_START:"[CDATA[",DOCTYPE:"doctype",SCRIPT:"script",PUBLIC:"public",SYSTEM:"system"};function ns(e){return e>=55296&&e<=57343}function Nn(e){return e>=56320&&e<=57343}function In(e,t){return(e-55296)*1024+9216+t}function is(e){return e!==32&&e!==10&&e!==13&&e!==9&&e!==12&&e>=1&&e<=31||e>=127&&e<=159}function os(e){return e>=64976&&e<=65007||Cn.has(e)}var u;(function(e){e.controlCharacterInInputStream="control-character-in-input-stream",e.noncharacterInInputStream="noncharacter-in-input-stream",e.surrogateInInputStream="surrogate-in-input-stream",e.nonVoidHtmlElementStartTagWithTrailingSolidus="non-void-html-element-start-tag-with-trailing-solidus",e.endTagWithAttributes="end-tag-with-attributes",e.endTagWithTrailingSolidus="end-tag-with-trailing-solidus",e.unexpectedSolidusInTag="unexpected-solidus-in-tag",e.unexpectedNullCharacter="unexpected-null-character",e.unexpectedQuestionMarkInsteadOfTagName="unexpected-question-mark-instead-of-tag-name",e.invalidFirstCharacterOfTagName="invalid-first-character-of-tag-name",e.unexpectedEqualsSignBeforeAttributeName="unexpected-equals-sign-before-attribute-name",e.missingEndTagName="missing-end-tag-name",e.unexpectedCharacterInAttributeName="unexpected-character-in-attribute-name",e.unknownNamedCharacterReference="unknown-named-character-reference",e.missingSemicolonAfterCharacterReference="missing-semicolon-after-character-reference",e.unexpectedCharacterAfterDoctypeSystemIdentifier="unexpected-character-after-doctype-system-identifier",e.unexpectedCharacterInUnquotedAttributeValue="unexpected-character-in-unquoted-attribute-value",e.eofBeforeTagName="eof-before-tag-name",e.eofInTag="eof-in-tag",e.missingAttributeValue="missing-attribute-value",e.missingWhitespaceBetweenAttributes="missing-whitespace-between-attributes",e.missingWhitespaceAfterDoctypePublicKeyword="missing-whitespace-after-doctype-public-keyword",e.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers="missing-whitespace-between-doctype-public-and-system-identifiers",e.missingWhitespaceAfterDoctypeSystemKeyword="missing-whitespace-after-doctype-system-keyword",e.missingQuoteBeforeDoctypePublicIdentifier="missing-quote-before-doctype-public-identifier",e.missingQuoteBeforeDoctypeSystemIdentifier="missing-quote-before-doctype-system-identifier",e.missingDoctypePublicIdentifier="missing-doctype-public-identifier",e.missingDoctypeSystemIdentifier="missing-doctype-system-identifier",e.abruptDoctypePublicIdentifier="abrupt-doctype-public-identifier",e.abruptDoctypeSystemIdentifier="abrupt-doctype-system-identifier",e.cdataInHtmlContent="cdata-in-html-content",e.incorrectlyOpenedComment="incorrectly-opened-comment",e.eofInScriptHtmlCommentLikeText="eof-in-script-html-comment-like-text",e.eofInDoctype="eof-in-doctype",e.nestedComment="nested-comment",e.abruptClosingOfEmptyComment="abrupt-closing-of-empty-comment",e.eofInComment="eof-in-comment",e.incorrectlyClosedComment="incorrectly-closed-comment",e.eofInCdata="eof-in-cdata",e.absenceOfDigitsInNumericCharacterReference="absence-of-digits-in-numeric-character-reference",e.nullCharacterReference="null-character-reference",e.surrogateCharacterReference="surrogate-character-reference",e.characterReferenceOutsideUnicodeRange="character-reference-outside-unicode-range",e.controlCharacterReference="control-character-reference",e.noncharacterCharacterReference="noncharacter-character-reference",e.missingWhitespaceBeforeDoctypeName="missing-whitespace-before-doctype-name",e.missingDoctypeName="missing-doctype-name",e.invalidCharacterSequenceAfterDoctypeName="invalid-character-sequence-after-doctype-name",e.duplicateAttribute="duplicate-attribute",e.nonConformingDoctype="non-conforming-doctype",e.missingDoctype="missing-doctype",e.misplacedDoctype="misplaced-doctype",e.endTagWithoutMatchingOpenElement="end-tag-without-matching-open-element",e.closingOfElementWithOpenChildElements="closing-of-element-with-open-child-elements",e.disallowedContentInNoscriptInHead="disallowed-content-in-noscript-in-head",e.openElementsLeftAfterEof="open-elements-left-after-eof",e.abandonedHeadElementChild="abandoned-head-element-child",e.misplacedStartTagForHeadElement="misplaced-start-tag-for-head-element",e.nestedNoscriptInHead="nested-noscript-in-head",e.eofInElementThatCanContainOnlyText="eof-in-element-that-can-contain-only-text"})(u||(u={}));const fn=65536;class On{constructor(t){this.handler=t,this.html="",this.pos=-1,this.lastGapPos=-2,this.gapStack=[],this.skipNextNewLine=!1,this.lastChunkWritten=!1,this.endOfChunkHit=!1,this.bufferWaterline=fn,this.isEol=!1,this.lineStartPos=0,this.droppedBufferSize=0,this.line=1,this.lastErrOffset=-1}get col(){return this.pos-this.lineStartPos+ +(this.lastGapPos!==this.pos)}get offset(){return this.droppedBufferSize+this.pos}getError(t,s){const{line:n,col:T,offset:m}=this,O=T+s,R=m+s;return{code:t,startLine:n,endLine:n,startCol:O,endCol:O,startOffset:R,endOffset:R}}_err(t){this.handler.onParseError&&this.lastErrOffset!==this.offset&&(this.lastErrOffset=this.offset,this.handler.onParseError(this.getError(t,0)))}_addGap(){this.gapStack.push(this.lastGapPos),this.lastGapPos=this.pos}_processSurrogate(t){if(this.pos!==this.html.length-1){const s=this.html.charCodeAt(this.pos+1);if(Nn(s))return this.pos++,this._addGap(),In(t,s)}else if(!this.lastChunkWritten)return this.endOfChunkHit=!0,o.EOF;return this._err(u.surrogateInInputStream),t}willDropParsedChunk(){return this.pos>this.bufferWaterline}dropParsedChunk(){this.willDropParsedChunk()&&(this.html=this.html.substring(this.pos),this.lineStartPos-=this.pos,this.droppedBufferSize+=this.pos,this.pos=0,this.lastGapPos=-2,this.gapStack.length=0)}write(t,s){this.html.length>0?this.html+=t:this.html=t,this.endOfChunkHit=!1,this.lastChunkWritten=s}insertHtmlAtCurrentPos(t){this.html=this.html.substring(0,this.pos+1)+t+this.html.substring(this.pos+1),this.endOfChunkHit=!1}startsWith(t,s){if(this.pos+t.length>this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,!1;if(s)return this.html.startsWith(t,this.pos);for(let n=0;n<t.length;n++)if((this.html.charCodeAt(this.pos+n)|32)!==t.charCodeAt(n))return!1;return!0}peek(t){const s=this.pos+t;if(s>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,o.EOF;const n=this.html.charCodeAt(s);return n===o.CARRIAGE_RETURN?o.LINE_FEED:n}advance(){if(this.pos++,this.isEol&&(this.isEol=!1,this.line++,this.lineStartPos=this.pos),this.pos>=this.html.length)return this.endOfChunkHit=!this.lastChunkWritten,o.EOF;let t=this.html.charCodeAt(this.pos);return t===o.CARRIAGE_RETURN?(this.isEol=!0,this.skipNextNewLine=!0,o.LINE_FEED):t===o.LINE_FEED&&(this.isEol=!0,this.skipNextNewLine)?(this.line--,this.skipNextNewLine=!1,this._addGap(),this.advance()):(this.skipNextNewLine=!1,ns(t)&&(t=this._processSurrogate(t)),this.handler.onParseError===null||t>31&&t<127||t===o.LINE_FEED||t===o.CARRIAGE_RETURN||t>159&&t<64976||this._checkForProblematicCharacters(t),t)}_checkForProblematicCharacters(t){is(t)?this._err(u.controlCharacterInInputStream):os(t)&&this._err(u.noncharacterInInputStream)}retreat(t){for(this.pos-=t;this.pos<this.lastGapPos;)this.lastGapPos=this.gapStack.pop(),this.pos--;this.isEol=!1}}var S;(function(e){e[e.CHARACTER=0]="CHARACTER",e[e.NULL_CHARACTER=1]="NULL_CHARACTER",e[e.WHITESPACE_CHARACTER=2]="WHITESPACE_CHARACTER",e[e.START_TAG=3]="START_TAG",e[e.END_TAG=4]="END_TAG",e[e.COMMENT=5]="COMMENT",e[e.DOCTYPE=6]="DOCTYPE",e[e.EOF=7]="EOF",e[e.HIBERNATION=8]="HIBERNATION"})(S||(S={}));function Es(e,t){for(let s=e.attrs.length-1;s>=0;s--)if(e.attrs[s].name===t)return e.attrs[s].value;return null}var N;(function(e){e.HTML="http://www.w3.org/1999/xhtml",e.MATHML="http://www.w3.org/1998/Math/MathML",e.SVG="http://www.w3.org/2000/svg",e.XLINK="http://www.w3.org/1999/xlink",e.XML="http://www.w3.org/XML/1998/namespace",e.XMLNS="http://www.w3.org/2000/xmlns/"})(N||(N={}));var z;(function(e){e.TYPE="type",e.ACTION="action",e.ENCODING="encoding",e.PROMPT="prompt",e.NAME="name",e.COLOR="color",e.FACE="face",e.SIZE="size"})(z||(z={}));var y;(function(e){e.NO_QUIRKS="no-quirks",e.QUIRKS="quirks",e.LIMITED_QUIRKS="limited-quirks"})(y||(y={}));var l;(function(e){e.A="a",e.ADDRESS="address",e.ANNOTATION_XML="annotation-xml",e.APPLET="applet",e.AREA="area",e.ARTICLE="article",e.ASIDE="aside",e.B="b",e.BASE="base",e.BASEFONT="basefont",e.BGSOUND="bgsound",e.BIG="big",e.BLOCKQUOTE="blockquote",e.BODY="body",e.BR="br",e.BUTTON="button",e.CAPTION="caption",e.CENTER="center",e.CODE="code",e.COL="col",e.COLGROUP="colgroup",e.DD="dd",e.DESC="desc",e.DETAILS="details",e.DIALOG="dialog",e.DIR="dir",e.DIV="div",e.DL="dl",e.DT="dt",e.EM="em",e.EMBED="embed",e.FIELDSET="fieldset",e.FIGCAPTION="figcaption",e.FIGURE="figure",e.FONT="font",e.FOOTER="footer",e.FOREIGN_OBJECT="foreignObject",e.FORM="form",e.FRAME="frame",e.FRAMESET="frameset",e.H1="h1",e.H2="h2",e.H3="h3",e.H4="h4",e.H5="h5",e.H6="h6",e.HEAD="head",e.HEADER="header",e.HGROUP="hgroup",e.HR="hr",e.HTML="html",e.I="i",e.IMG="img",e.IMAGE="image",e.INPUT="input",e.IFRAME="iframe",e.KEYGEN="keygen",e.LABEL="label",e.LI="li",e.LINK="link",e.LISTING="listing",e.MAIN="main",e.MALIGNMARK="malignmark",e.MARQUEE="marquee",e.MATH="math",e.MENU="menu",e.META="meta",e.MGLYPH="mglyph",e.MI="mi",e.MO="mo",e.MN="mn",e.MS="ms",e.MTEXT="mtext",e.NAV="nav",e.NOBR="nobr",e.NOFRAMES="noframes",e.NOEMBED="noembed",e.NOSCRIPT="noscript",e.OBJECT="object",e.OL="ol",e.OPTGROUP="optgroup",e.OPTION="option",e.P="p",e.PARAM="param",e.PLAINTEXT="plaintext",e.PRE="pre",e.RB="rb",e.RP="rp",e.RT="rt",e.RTC="rtc",e.RUBY="ruby",e.S="s",e.SCRIPT="script",e.SEARCH="search",e.SECTION="section",e.SELECT="select",e.SOURCE="source",e.SMALL="small",e.SPAN="span",e.STRIKE="strike",e.STRONG="strong",e.STYLE="style",e.SUB="sub",e.SUMMARY="summary",e.SUP="sup",e.TABLE="table",e.TBODY="tbody",e.TEMPLATE="template",e.TEXTAREA="textarea",e.TFOOT="tfoot",e.TD="td",e.TH="th",e.THEAD="thead",e.TITLE="title",e.TR="tr",e.TRACK="track",e.TT="tt",e.U="u",e.UL="ul",e.SVG="svg",e.VAR="var",e.WBR="wbr",e.XMP="xmp"})(l||(l={}));var r;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.A=1]="A",e[e.ADDRESS=2]="ADDRESS",e[e.ANNOTATION_XML=3]="ANNOTATION_XML",e[e.APPLET=4]="APPLET",e[e.AREA=5]="AREA",e[e.ARTICLE=6]="ARTICLE",e[e.ASIDE=7]="ASIDE",e[e.B=8]="B",e[e.BASE=9]="BASE",e[e.BASEFONT=10]="BASEFONT",e[e.BGSOUND=11]="BGSOUND",e[e.BIG=12]="BIG",e[e.BLOCKQUOTE=13]="BLOCKQUOTE",e[e.BODY=14]="BODY",e[e.BR=15]="BR",e[e.BUTTON=16]="BUTTON",e[e.CAPTION=17]="CAPTION",e[e.CENTER=18]="CENTER",e[e.CODE=19]="CODE",e[e.COL=20]="COL",e[e.COLGROUP=21]="COLGROUP",e[e.DD=22]="DD",e[e.DESC=23]="DESC",e[e.DETAILS=24]="DETAILS",e[e.DIALOG=25]="DIALOG",e[e.DIR=26]="DIR",e[e.DIV=27]="DIV",e[e.DL=28]="DL",e[e.DT=29]="DT",e[e.EM=30]="EM",e[e.EMBED=31]="EMBED",e[e.FIELDSET=32]="FIELDSET",e[e.FIGCAPTION=33]="FIGCAPTION",e[e.FIGURE=34]="FIGURE",e[e.FONT=35]="FONT",e[e.FOOTER=36]="FOOTER",e[e.FOREIGN_OBJECT=37]="FOREIGN_OBJECT",e[e.FORM=38]="FORM",e[e.FRAME=39]="FRAME",e[e.FRAMESET=40]="FRAMESET",e[e.H1=41]="H1",e[e.H2=42]="H2",e[e.H3=43]="H3",e[e.H4=44]="H4",e[e.H5=45]="H5",e[e.H6=46]="H6",e[e.HEAD=47]="HEAD",e[e.HEADER=48]="HEADER",e[e.HGROUP=49]="HGROUP",e[e.HR=50]="HR",e[e.HTML=51]="HTML",e[e.I=52]="I",e[e.IMG=53]="IMG",e[e.IMAGE=54]="IMAGE",e[e.INPUT=55]="INPUT",e[e.IFRAME=56]="IFRAME",e[e.KEYGEN=57]="KEYGEN",e[e.LABEL=58]="LABEL",e[e.LI=59]="LI",e[e.LINK=60]="LINK",e[e.LISTING=61]="LISTING",e[e.MAIN=62]="MAIN",e[e.MALIGNMARK=63]="MALIGNMARK",e[e.MARQUEE=64]="MARQUEE",e[e.MATH=65]="MATH",e[e.MENU=66]="MENU",e[e.META=67]="META",e[e.MGLYPH=68]="MGLYPH",e[e.MI=69]="MI",e[e.MO=70]="MO",e[e.MN=71]="MN",e[e.MS=72]="MS",e[e.MTEXT=73]="MTEXT",e[e.NAV=74]="NAV",e[e.NOBR=75]="NOBR",e[e.NOFRAMES=76]="NOFRAMES",e[e.NOEMBED=77]="NOEMBED",e[e.NOSCRIPT=78]="NOSCRIPT",e[e.OBJECT=79]="OBJECT",e[e.OL=80]="OL",e[e.OPTGROUP=81]="OPTGROUP",e[e.OPTION=82]="OPTION",e[e.P=83]="P",e[e.PARAM=84]="PARAM",e[e.PLAINTEXT=85]="PLAINTEXT",e[e.PRE=86]="PRE",e[e.RB=87]="RB",e[e.RP=88]="RP",e[e.RT=89]="RT",e[e.RTC=90]="RTC",e[e.RUBY=91]="RUBY",e[e.S=92]="S",e[e.SCRIPT=93]="SCRIPT",e[e.SEARCH=94]="SEARCH",e[e.SECTION=95]="SECTION",e[e.SELECT=96]="SELECT",e[e.SOURCE=97]="SOURCE",e[e.SMALL=98]="SMALL",e[e.SPAN=99]="SPAN",e[e.STRIKE=100]="STRIKE",e[e.STRONG=101]="STRONG",e[e.STYLE=102]="STYLE",e[e.SUB=103]="SUB",e[e.SUMMARY=104]="SUMMARY",e[e.SUP=105]="SUP",e[e.TABLE=106]="TABLE",e[e.TBODY=107]="TBODY",e[e.TEMPLATE=108]="TEMPLATE",e[e.TEXTAREA=109]="TEXTAREA",e[e.TFOOT=110]="TFOOT",e[e.TD=111]="TD",e[e.TH=112]="TH",e[e.THEAD=113]="THEAD",e[e.TITLE=114]="TITLE",e[e.TR=115]="TR",e[e.TRACK=116]="TRACK",e[e.TT=117]="TT",e[e.U=118]="U",e[e.UL=119]="UL",e[e.SVG=120]="SVG",e[e.VAR=121]="VAR",e[e.WBR=122]="WBR",e[e.XMP=123]="XMP"})(r||(r={}));const Rn=new Map([[l.A,r.A],[l.ADDRESS,r.ADDRESS],[l.ANNOTATION_XML,r.ANNOTATION_XML],[l.APPLET,r.APPLET],[l.AREA,r.AREA],[l.ARTICLE,r.ARTICLE],[l.ASIDE,r.ASIDE],[l.B,r.B],[l.BASE,r.BASE],[l.BASEFONT,r.BASEFONT],[l.BGSOUND,r.BGSOUND],[l.BIG,r.BIG],[l.BLOCKQUOTE,r.BLOCKQUOTE],[l.BODY,r.BODY],[l.BR,r.BR],[l.BUTTON,r.BUTTON],[l.CAPTION,r.CAPTION],[l.CENTER,r.CENTER],[l.CODE,r.CODE],[l.COL,r.COL],[l.COLGROUP,r.COLGROUP],[l.DD,r.DD],[l.DESC,r.DESC],[l.DETAILS,r.DETAILS],[l.DIALOG,r.DIALOG],[l.DIR,r.DIR],[l.DIV,r.DIV],[l.DL,r.DL],[l.DT,r.DT],[l.EM,r.EM],[l.EMBED,r.EMBED],[l.FIELDSET,r.FIELDSET],[l.FIGCAPTION,r.FIGCAPTION],[l.FIGURE,r.FIGURE],[l.FONT,r.FONT],[l.FOOTER,r.FOOTER],[l.FOREIGN_OBJECT,r.FOREIGN_OBJECT],[l.FORM,r.FORM],[l.FRAME,r.FRAME],[l.FRAMESET,r.FRAMESET],[l.H1,r.H1],[l.H2,r.H2],[l.H3,r.H3],[l.H4,r.H4],[l.H5,r.H5],[l.H6,r.H6],[l.HEAD,r.HEAD],[l.HEADER,r.HEADER],[l.HGROUP,r.HGROUP],[l.HR,r.HR],[l.HTML,r.HTML],[l.I,r.I],[l.IMG,r.IMG],[l.IMAGE,r.IMAGE],[l.INPUT,r.INPUT],[l.IFRAME,r.IFRAME],[l.KEYGEN,r.KEYGEN],[l.LABEL,r.LABEL],[l.LI,r.LI],[l.LINK,r.LINK],[l.LISTING,r.LISTING],[l.MAIN,r.MAIN],[l.MALIGNMARK,r.MALIGNMARK],[l.MARQUEE,r.MARQUEE],[l.MATH,r.MATH],[l.MENU,r.MENU],[l.META,r.META],[l.MGLYPH,r.MGLYPH],[l.MI,r.MI],[l.MO,r.MO],[l.MN,r.MN],[l.MS,r.MS],[l.MTEXT,r.MTEXT],[l.NAV,r.NAV],[l.NOBR,r.NOBR],[l.NOFRAMES,r.NOFRAMES],[l.NOEMBED,r.NOEMBED],[l.NOSCRIPT,r.NOSCRIPT],[l.OBJECT,r.OBJECT],[l.OL,r.OL],[l.OPTGROUP,r.OPTGROUP],[l.OPTION,r.OPTION],[l.P,r.P],[l.PARAM,r.PARAM],[l.PLAINTEXT,r.PLAINTEXT],[l.PRE,r.PRE],[l.RB,r.RB],[l.RP,r.RP],[l.RT,r.RT],[l.RTC,r.RTC],[l.RUBY,r.RUBY],[l.S,r.S],[l.SCRIPT,r.SCRIPT],[l.SEARCH,r.SEARCH],[l.SECTION,r.SECTION],[l.SELECT,r.SELECT],[l.SOURCE,r.SOURCE],[l.SMALL,r.SMALL],[l.SPAN,r.SPAN],[l.STRIKE,r.STRIKE],[l.STRONG,r.STRONG],[l.STYLE,r.STYLE],[l.SUB,r.SUB],[l.SUMMARY,r.SUMMARY],[l.SUP,r.SUP],[l.TABLE,r.TABLE],[l.TBODY,r.TBODY],[l.TEMPLATE,r.TEMPLATE],[l.TEXTAREA,r.TEXTAREA],[l.TFOOT,r.TFOOT],[l.TD,r.TD],[l.TH,r.TH],[l.THEAD,r.THEAD],[l.TITLE,r.TITLE],[l.TR,r.TR],[l.TRACK,r.TRACK],[l.TT,r.TT],[l.U,r.U],[l.UL,r.UL],[l.SVG,r.SVG],[l.VAR,r.VAR],[l.WBR,r.WBR],[l.XMP,r.XMP]]);function ke(e){var t;return(t=Rn.get(e))!==null&&t!==void 0?t:r.UNKNOWN}const f=r,Ln={[N.HTML]:new Set([f.ADDRESS,f.APPLET,f.AREA,f.ARTICLE,f.ASIDE,f.BASE,f.BASEFONT,f.BGSOUND,f.BLOCKQUOTE,f.BODY,f.BR,f.BUTTON,f.CAPTION,f.CENTER,f.COL,f.COLGROUP,f.DD,f.DETAILS,f.DIR,f.DIV,f.DL,f.DT,f.EMBED,f.FIELDSET,f.FIGCAPTION,f.FIGURE,f.FOOTER,f.FORM,f.FRAME,f.FRAMESET,f.H1,f.H2,f.H3,f.H4,f.H5,f.H6,f.HEAD,f.HEADER,f.HGROUP,f.HR,f.HTML,f.IFRAME,f.IMG,f.INPUT,f.LI,f.LINK,f.LISTING,f.MAIN,f.MARQUEE,f.MENU,f.META,f.NAV,f.NOEMBED,f.NOFRAMES,f.NOSCRIPT,f.OBJECT,f.OL,f.P,f.PARAM,f.PLAINTEXT,f.PRE,f.SCRIPT,f.SECTION,f.SELECT,f.SOURCE,f.STYLE,f.SUMMARY,f.TABLE,f.TBODY,f.TD,f.TEMPLATE,f.TEXTAREA,f.TFOOT,f.TH,f.THEAD,f.TITLE,f.TR,f.TRACK,f.UL,f.WBR,f.XMP]),[N.MATHML]:new Set([f.MI,f.MO,f.MN,f.MS,f.MTEXT,f.ANNOTATION_XML]),[N.SVG]:new Set([f.TITLE,f.FOREIGN_OBJECT,f.DESC]),[N.XLINK]:new Set,[N.XML]:new Set,[N.XMLNS]:new Set},Ve=new Set([f.H1,f.H2,f.H3,f.H4,f.H5,f.H6]),Sn=new Set([l.STYLE,l.SCRIPT,l.XMP,l.IFRAME,l.NOEMBED,l.NOFRAMES,l.PLAINTEXT]);function Dn(e,t){return Sn.has(e)||t&&e===l.NOSCRIPT}var c;(function(e){e[e.DATA=0]="DATA",e[e.RCDATA=1]="RCDATA",e[e.RAWTEXT=2]="RAWTEXT",e[e.SCRIPT_DATA=3]="SCRIPT_DATA",e[e.PLAINTEXT=4]="PLAINTEXT",e[e.TAG_OPEN=5]="TAG_OPEN",e[e.END_TAG_OPEN=6]="END_TAG_OPEN",e[e.TAG_NAME=7]="TAG_NAME",e[e.RCDATA_LESS_THAN_SIGN=8]="RCDATA_LESS_THAN_SIGN",e[e.RCDATA_END_TAG_OPEN=9]="RCDATA_END_TAG_OPEN",e[e.RCDATA_END_TAG_NAME=10]="RCDATA_END_TAG_NAME",e[e.RAWTEXT_LESS_THAN_SIGN=11]="RAWTEXT_LESS_THAN_SIGN",e[e.RAWTEXT_END_TAG_OPEN=12]="RAWTEXT_END_TAG_OPEN",e[e.RAWTEXT_END_TAG_NAME=13]="RAWTEXT_END_TAG_NAME",e[e.SCRIPT_DATA_LESS_THAN_SIGN=14]="SCRIPT_DATA_LESS_THAN_SIGN",e[e.SCRIPT_DATA_END_TAG_OPEN=15]="SCRIPT_DATA_END_TAG_OPEN",e[e.SCRIPT_DATA_END_TAG_NAME=16]="SCRIPT_DATA_END_TAG_NAME",e[e.SCRIPT_DATA_ESCAPE_START=17]="SCRIPT_DATA_ESCAPE_START",e[e.SCRIPT_DATA_ESCAPE_START_DASH=18]="SCRIPT_DATA_ESCAPE_START_DASH",e[e.SCRIPT_DATA_ESCAPED=19]="SCRIPT_DATA_ESCAPED",e[e.SCRIPT_DATA_ESCAPED_DASH=20]="SCRIPT_DATA_ESCAPED_DASH",e[e.SCRIPT_DATA_ESCAPED_DASH_DASH=21]="SCRIPT_DATA_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN=22]="SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_OPEN=23]="SCRIPT_DATA_ESCAPED_END_TAG_OPEN",e[e.SCRIPT_DATA_ESCAPED_END_TAG_NAME=24]="SCRIPT_DATA_ESCAPED_END_TAG_NAME",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_START=25]="SCRIPT_DATA_DOUBLE_ESCAPE_START",e[e.SCRIPT_DATA_DOUBLE_ESCAPED=26]="SCRIPT_DATA_DOUBLE_ESCAPED",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH=27]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH=28]="SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH",e[e.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN=29]="SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN",e[e.SCRIPT_DATA_DOUBLE_ESCAPE_END=30]="SCRIPT_DATA_DOUBLE_ESCAPE_END",e[e.BEFORE_ATTRIBUTE_NAME=31]="BEFORE_ATTRIBUTE_NAME",e[e.ATTRIBUTE_NAME=32]="ATTRIBUTE_NAME",e[e.AFTER_ATTRIBUTE_NAME=33]="AFTER_ATTRIBUTE_NAME",e[e.BEFORE_ATTRIBUTE_VALUE=34]="BEFORE_ATTRIBUTE_VALUE",e[e.ATTRIBUTE_VALUE_DOUBLE_QUOTED=35]="ATTRIBUTE_VALUE_DOUBLE_QUOTED",e[e.ATTRIBUTE_VALUE_SINGLE_QUOTED=36]="ATTRIBUTE_VALUE_SINGLE_QUOTED",e[e.ATTRIBUTE_VALUE_UNQUOTED=37]="ATTRIBUTE_VALUE_UNQUOTED",e[e.AFTER_ATTRIBUTE_VALUE_QUOTED=38]="AFTER_ATTRIBUTE_VALUE_QUOTED",e[e.SELF_CLOSING_START_TAG=39]="SELF_CLOSING_START_TAG",e[e.BOGUS_COMMENT=40]="BOGUS_COMMENT",e[e.MARKUP_DECLARATION_OPEN=41]="MARKUP_DECLARATION_OPEN",e[e.COMMENT_START=42]="COMMENT_START",e[e.COMMENT_START_DASH=43]="COMMENT_START_DASH",e[e.COMMENT=44]="COMMENT",e[e.COMMENT_LESS_THAN_SIGN=45]="COMMENT_LESS_THAN_SIGN",e[e.COMMENT_LESS_THAN_SIGN_BANG=46]="COMMENT_LESS_THAN_SIGN_BANG",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH=47]="COMMENT_LESS_THAN_SIGN_BANG_DASH",e[e.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH=48]="COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH",e[e.COMMENT_END_DASH=49]="COMMENT_END_DASH",e[e.COMMENT_END=50]="COMMENT_END",e[e.COMMENT_END_BANG=51]="COMMENT_END_BANG",e[e.DOCTYPE=52]="DOCTYPE",e[e.BEFORE_DOCTYPE_NAME=53]="BEFORE_DOCTYPE_NAME",e[e.DOCTYPE_NAME=54]="DOCTYPE_NAME",e[e.AFTER_DOCTYPE_NAME=55]="AFTER_DOCTYPE_NAME",e[e.AFTER_DOCTYPE_PUBLIC_KEYWORD=56]="AFTER_DOCTYPE_PUBLIC_KEYWORD",e[e.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER=57]="BEFORE_DOCTYPE_PUBLIC_IDENTIFIER",e[e.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED=58]="DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED=59]="DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_PUBLIC_IDENTIFIER=60]="AFTER_DOCTYPE_PUBLIC_IDENTIFIER",e[e.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS=61]="BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS",e[e.AFTER_DOCTYPE_SYSTEM_KEYWORD=62]="AFTER_DOCTYPE_SYSTEM_KEYWORD",e[e.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER=63]="BEFORE_DOCTYPE_SYSTEM_IDENTIFIER",e[e.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED=64]="DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED",e[e.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED=65]="DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED",e[e.AFTER_DOCTYPE_SYSTEM_IDENTIFIER=66]="AFTER_DOCTYPE_SYSTEM_IDENTIFIER",e[e.BOGUS_DOCTYPE=67]="BOGUS_DOCTYPE",e[e.CDATA_SECTION=68]="CDATA_SECTION",e[e.CDATA_SECTION_BRACKET=69]="CDATA_SECTION_BRACKET",e[e.CDATA_SECTION_END=70]="CDATA_SECTION_END",e[e.CHARACTER_REFERENCE=71]="CHARACTER_REFERENCE",e[e.AMBIGUOUS_AMPERSAND=72]="AMBIGUOUS_AMPERSAND"})(c||(c={}));const F={DATA:c.DATA,RCDATA:c.RCDATA,RAWTEXT:c.RAWTEXT,SCRIPT_DATA:c.SCRIPT_DATA,PLAINTEXT:c.PLAINTEXT,CDATA_SECTION:c.CDATA_SECTION};function gn(e){return e>=o.DIGIT_0&&e<=o.DIGIT_9}function ne(e){return e>=o.LATIN_CAPITAL_A&&e<=o.LATIN_CAPITAL_Z}function Pn(e){return e>=o.LATIN_SMALL_A&&e<=o.LATIN_SMALL_Z}function K(e){return Pn(e)||ne(e)}function dt(e){return K(e)||gn(e)}function Re(e){return e+32}function cs(e){return e===o.SPACE||e===o.LINE_FEED||e===o.TABULATION||e===o.FORM_FEED}function ut(e){return cs(e)||e===o.SOLIDUS||e===o.GREATER_THAN_SIGN}function pn(e){return e===o.NULL?u.nullCharacterReference:e>1114111?u.characterReferenceOutsideUnicodeRange:ns(e)?u.surrogateCharacterReference:os(e)?u.noncharacterCharacterReference:is(e)||e===o.CARRIAGE_RETURN?u.controlCharacterReference:null}class Mn{constructor(t,s){this.options=t,this.handler=s,this.paused=!1,this.inLoop=!1,this.inForeignNode=!1,this.lastStartTagName="",this.active=!1,this.state=c.DATA,this.returnState=c.DATA,this.entityStartPos=0,this.consumedAfterSnapshot=-1,this.currentCharacterToken=null,this.currentToken=null,this.currentAttr={name:"",value:""},this.preprocessor=new On(s),this.currentLocation=this.getCurrentLocation(-1),this.entityDecoder=new ys(xs,(n,T)=>{this.preprocessor.pos=this.entityStartPos+T-1,this._flushCodePointConsumedAsCharacterReference(n)},s.onParseError?{missingSemicolonAfterCharacterReference:()=>{this._err(u.missingSemicolonAfterCharacterReference,1)},absenceOfDigitsInNumericCharacterReference:n=>{this._err(u.absenceOfDigitsInNumericCharacterReference,this.entityStartPos-this.preprocessor.pos+n)},validateNumericCharacterReference:n=>{const T=pn(n);T&&this._err(T,1)}}:void 0)}_err(t,s=0){var n,T;(T=(n=this.handler).onParseError)===null||T===void 0||T.call(n,this.preprocessor.getError(t,s))}getCurrentLocation(t){return this.options.sourceCodeLocationInfo?{startLine:this.preprocessor.line,startCol:this.preprocessor.col-t,startOffset:this.preprocessor.offset-t,endLine:-1,endCol:-1,endOffset:-1}:null}_runParsingLoop(){if(!this.inLoop){for(this.inLoop=!0;this.active&&!this.paused;){this.consumedAfterSnapshot=0;const t=this._consume();this._ensureHibernation()||this._callState(t)}this.inLoop=!1}}pause(){this.paused=!0}resume(t){if(!this.paused)throw new Error("Parser was already resumed");this.paused=!1,!this.inLoop&&(this._runParsingLoop(),this.paused||t==null||t())}write(t,s,n){this.active=!0,this.preprocessor.write(t,s),this._runParsingLoop(),this.paused||n==null||n()}insertHtmlAtCurrentPos(t){this.active=!0,this.preprocessor.insertHtmlAtCurrentPos(t),this._runParsingLoop()}_ensureHibernation(){return this.preprocessor.endOfChunkHit?(this.preprocessor.retreat(this.consumedAfterSnapshot),this.consumedAfterSnapshot=0,this.active=!1,!0):!1}_consume(){return this.consumedAfterSnapshot++,this.preprocessor.advance()}_advanceBy(t){this.consumedAfterSnapshot+=t;for(let s=0;s<t;s++)this.preprocessor.advance()}_consumeSequenceIfMatch(t,s){return this.preprocessor.startsWith(t,s)?(this._advanceBy(t.length-1),!0):!1}_createStartTagToken(){this.currentToken={type:S.START_TAG,tagName:"",tagID:r.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(1)}}_createEndTagToken(){this.currentToken={type:S.END_TAG,tagName:"",tagID:r.UNKNOWN,selfClosing:!1,ackSelfClosing:!1,attrs:[],location:this.getCurrentLocation(2)}}_createCommentToken(t){this.currentToken={type:S.COMMENT,data:"",location:this.getCurrentLocation(t)}}_createDoctypeToken(t){this.currentToken={type:S.DOCTYPE,name:t,forceQuirks:!1,publicId:null,systemId:null,location:this.currentLocation}}_createCharacterToken(t,s){this.currentCharacterToken={type:t,chars:s,location:this.currentLocation}}_createAttr(t){this.currentAttr={name:t,value:""},this.currentLocation=this.getCurrentLocation(0)}_leaveAttrName(){var t,s;const n=this.currentToken;if(Es(n,this.currentAttr.name)===null){if(n.attrs.push(this.currentAttr),n.location&&this.currentLocation){const T=(t=(s=n.location).attrs)!==null&&t!==void 0?t:s.attrs=Object.create(null);T[this.currentAttr.name]=this.currentLocation,this._leaveAttrValue()}}else this._err(u.duplicateAttribute)}_leaveAttrValue(){this.currentLocation&&(this.currentLocation.endLine=this.preprocessor.line,this.currentLocation.endCol=this.preprocessor.col,this.currentLocation.endOffset=this.preprocessor.offset)}prepareToken(t){this._emitCurrentCharacterToken(t.location),this.currentToken=null,t.location&&(t.location.endLine=this.preprocessor.line,t.location.endCol=this.preprocessor.col+1,t.location.endOffset=this.preprocessor.offset+1),this.currentLocation=this.getCurrentLocation(-1)}emitCurrentTagToken(){const t=this.currentToken;this.prepareToken(t),t.tagID=ke(t.tagName),t.type===S.START_TAG?(this.lastStartTagName=t.tagName,this.handler.onStartTag(t)):(t.attrs.length>0&&this._err(u.endTagWithAttributes),t.selfClosing&&this._err(u.endTagWithTrailingSolidus),this.handler.onEndTag(t)),this.preprocessor.dropParsedChunk()}emitCurrentComment(t){this.prepareToken(t),this.handler.onComment(t),this.preprocessor.dropParsedChunk()}emitCurrentDoctype(t){this.prepareToken(t),this.handler.onDoctype(t),this.preprocessor.dropParsedChunk()}_emitCurrentCharacterToken(t){if(this.currentCharacterToken){switch(t&&this.currentCharacterToken.location&&(this.currentCharacterToken.location.endLine=t.startLine,this.currentCharacterToken.location.endCol=t.startCol,this.currentCharacterToken.location.endOffset=t.startOffset),this.currentCharacterToken.type){case S.CHARACTER:{this.handler.onCharacter(this.currentCharacterToken);break}case S.NULL_CHARACTER:{this.handler.onNullCharacter(this.currentCharacterToken);break}case S.WHITESPACE_CHARACTER:{this.handler.onWhitespaceCharacter(this.currentCharacterToken);break}}this.currentCharacterToken=null}}_emitEOFToken(){const t=this.getCurrentLocation(0);t&&(t.endLine=t.startLine,t.endCol=t.startCol,t.endOffset=t.startOffset),this._emitCurrentCharacterToken(t),this.handler.onEof({type:S.EOF,location:t}),this.active=!1}_appendCharToCurrentCharacterToken(t,s){if(this.currentCharacterToken)if(this.currentCharacterToken.type===t){this.currentCharacterToken.chars+=s;return}else this.currentLocation=this.getCurrentLocation(0),this._emitCurrentCharacterToken(this.currentLocation),this.preprocessor.dropParsedChunk();this._createCharacterToken(t,s)}_emitCodePoint(t){const s=cs(t)?S.WHITESPACE_CHARACTER:t===o.NULL?S.NULL_CHARACTER:S.CHARACTER;this._appendCharToCurrentCharacterToken(s,String.fromCodePoint(t))}_emitChars(t){this._appendCharToCurrentCharacterToken(S.CHARACTER,t)}_startCharacterReference(){this.returnState=this.state,this.state=c.CHARACTER_REFERENCE,this.entityStartPos=this.preprocessor.pos,this.entityDecoder.startEntity(this._isCharacterReferenceInAttribute()?it.Attribute:it.Legacy)}_isCharacterReferenceInAttribute(){return this.returnState===c.ATTRIBUTE_VALUE_DOUBLE_QUOTED||this.returnState===c.ATTRIBUTE_VALUE_SINGLE_QUOTED||this.returnState===c.ATTRIBUTE_VALUE_UNQUOTED}_flushCodePointConsumedAsCharacterReference(t){this._isCharacterReferenceInAttribute()?this.currentAttr.value+=String.fromCodePoint(t):this._emitCodePoint(t)}_callState(t){switch(this.state){case c.DATA:{this._stateData(t);break}case c.RCDATA:{this._stateRcdata(t);break}case c.RAWTEXT:{this._stateRawtext(t);break}case c.SCRIPT_DATA:{this._stateScriptData(t);break}case c.PLAINTEXT:{this._statePlaintext(t);break}case c.TAG_OPEN:{this._stateTagOpen(t);break}case c.END_TAG_OPEN:{this._stateEndTagOpen(t);break}case c.TAG_NAME:{this._stateTagName(t);break}case c.RCDATA_LESS_THAN_SIGN:{this._stateRcdataLessThanSign(t);break}case c.RCDATA_END_TAG_OPEN:{this._stateRcdataEndTagOpen(t);break}case c.RCDATA_END_TAG_NAME:{this._stateRcdataEndTagName(t);break}case c.RAWTEXT_LESS_THAN_SIGN:{this._stateRawtextLessThanSign(t);break}case c.RAWTEXT_END_TAG_OPEN:{this._stateRawtextEndTagOpen(t);break}case c.RAWTEXT_END_TAG_NAME:{this._stateRawtextEndTagName(t);break}case c.SCRIPT_DATA_LESS_THAN_SIGN:{this._stateScriptDataLessThanSign(t);break}case c.SCRIPT_DATA_END_TAG_OPEN:{this._stateScriptDataEndTagOpen(t);break}case c.SCRIPT_DATA_END_TAG_NAME:{this._stateScriptDataEndTagName(t);break}case c.SCRIPT_DATA_ESCAPE_START:{this._stateScriptDataEscapeStart(t);break}case c.SCRIPT_DATA_ESCAPE_START_DASH:{this._stateScriptDataEscapeStartDash(t);break}case c.SCRIPT_DATA_ESCAPED:{this._stateScriptDataEscaped(t);break}case c.SCRIPT_DATA_ESCAPED_DASH:{this._stateScriptDataEscapedDash(t);break}case c.SCRIPT_DATA_ESCAPED_DASH_DASH:{this._stateScriptDataEscapedDashDash(t);break}case c.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataEscapedLessThanSign(t);break}case c.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:{this._stateScriptDataEscapedEndTagOpen(t);break}case c.SCRIPT_DATA_ESCAPED_END_TAG_NAME:{this._stateScriptDataEscapedEndTagName(t);break}case c.SCRIPT_DATA_DOUBLE_ESCAPE_START:{this._stateScriptDataDoubleEscapeStart(t);break}case c.SCRIPT_DATA_DOUBLE_ESCAPED:{this._stateScriptDataDoubleEscaped(t);break}case c.SCRIPT_DATA_DOUBLE_ESCAPED_DASH:{this._stateScriptDataDoubleEscapedDash(t);break}case c.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH:{this._stateScriptDataDoubleEscapedDashDash(t);break}case c.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN:{this._stateScriptDataDoubleEscapedLessThanSign(t);break}case c.SCRIPT_DATA_DOUBLE_ESCAPE_END:{this._stateScriptDataDoubleEscapeEnd(t);break}case c.BEFORE_ATTRIBUTE_NAME:{this._stateBeforeAttributeName(t);break}case c.ATTRIBUTE_NAME:{this._stateAttributeName(t);break}case c.AFTER_ATTRIBUTE_NAME:{this._stateAfterAttributeName(t);break}case c.BEFORE_ATTRIBUTE_VALUE:{this._stateBeforeAttributeValue(t);break}case c.ATTRIBUTE_VALUE_DOUBLE_QUOTED:{this._stateAttributeValueDoubleQuoted(t);break}case c.ATTRIBUTE_VALUE_SINGLE_QUOTED:{this._stateAttributeValueSingleQuoted(t);break}case c.ATTRIBUTE_VALUE_UNQUOTED:{this._stateAttributeValueUnquoted(t);break}case c.AFTER_ATTRIBUTE_VALUE_QUOTED:{this._stateAfterAttributeValueQuoted(t);break}case c.SELF_CLOSING_START_TAG:{this._stateSelfClosingStartTag(t);break}case c.BOGUS_COMMENT:{this._stateBogusComment(t);break}case c.MARKUP_DECLARATION_OPEN:{this._stateMarkupDeclarationOpen(t);break}case c.COMMENT_START:{this._stateCommentStart(t);break}case c.COMMENT_START_DASH:{this._stateCommentStartDash(t);break}case c.COMMENT:{this._stateComment(t);break}case c.COMMENT_LESS_THAN_SIGN:{this._stateCommentLessThanSign(t);break}case c.COMMENT_LESS_THAN_SIGN_BANG:{this._stateCommentLessThanSignBang(t);break}case c.COMMENT_LESS_THAN_SIGN_BANG_DASH:{this._stateCommentLessThanSignBangDash(t);break}case c.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:{this._stateCommentLessThanSignBangDashDash(t);break}case c.COMMENT_END_DASH:{this._stateCommentEndDash(t);break}case c.COMMENT_END:{this._stateCommentEnd(t);break}case c.COMMENT_END_BANG:{this._stateCommentEndBang(t);break}case c.DOCTYPE:{this._stateDoctype(t);break}case c.BEFORE_DOCTYPE_NAME:{this._stateBeforeDoctypeName(t);break}case c.DOCTYPE_NAME:{this._stateDoctypeName(t);break}case c.AFTER_DOCTYPE_NAME:{this._stateAfterDoctypeName(t);break}case c.AFTER_DOCTYPE_PUBLIC_KEYWORD:{this._stateAfterDoctypePublicKeyword(t);break}case c.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateBeforeDoctypePublicIdentifier(t);break}case c.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypePublicIdentifierDoubleQuoted(t);break}case c.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypePublicIdentifierSingleQuoted(t);break}case c.AFTER_DOCTYPE_PUBLIC_IDENTIFIER:{this._stateAfterDoctypePublicIdentifier(t);break}case c.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS:{this._stateBetweenDoctypePublicAndSystemIdentifiers(t);break}case c.AFTER_DOCTYPE_SYSTEM_KEYWORD:{this._stateAfterDoctypeSystemKeyword(t);break}case c.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateBeforeDoctypeSystemIdentifier(t);break}case c.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED:{this._stateDoctypeSystemIdentifierDoubleQuoted(t);break}case c.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED:{this._stateDoctypeSystemIdentifierSingleQuoted(t);break}case c.AFTER_DOCTYPE_SYSTEM_IDENTIFIER:{this._stateAfterDoctypeSystemIdentifier(t);break}case c.BOGUS_DOCTYPE:{this._stateBogusDoctype(t);break}case c.CDATA_SECTION:{this._stateCdataSection(t);break}case c.CDATA_SECTION_BRACKET:{this._stateCdataSectionBracket(t);break}case c.CDATA_SECTION_END:{this._stateCdataSectionEnd(t);break}case c.CHARACTER_REFERENCE:{this._stateCharacterReference();break}case c.AMBIGUOUS_AMPERSAND:{this._stateAmbiguousAmpersand(t);break}default:throw new Error("Unknown state")}}_stateData(t){switch(t){case o.LESS_THAN_SIGN:{this.state=c.TAG_OPEN;break}case o.AMPERSAND:{this._startCharacterReference();break}case o.NULL:{this._err(u.unexpectedNullCharacter),this._emitCodePoint(t);break}case o.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRcdata(t){switch(t){case o.AMPERSAND:{this._startCharacterReference();break}case o.LESS_THAN_SIGN:{this.state=c.RCDATA_LESS_THAN_SIGN;break}case o.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(P);break}case o.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateRawtext(t){switch(t){case o.LESS_THAN_SIGN:{this.state=c.RAWTEXT_LESS_THAN_SIGN;break}case o.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(P);break}case o.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptData(t){switch(t){case o.LESS_THAN_SIGN:{this.state=c.SCRIPT_DATA_LESS_THAN_SIGN;break}case o.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(P);break}case o.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_statePlaintext(t){switch(t){case o.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(P);break}case o.EOF:{this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateTagOpen(t){if(K(t))this._createStartTagToken(),this.state=c.TAG_NAME,this._stateTagName(t);else switch(t){case o.EXCLAMATION_MARK:{this.state=c.MARKUP_DECLARATION_OPEN;break}case o.SOLIDUS:{this.state=c.END_TAG_OPEN;break}case o.QUESTION_MARK:{this._err(u.unexpectedQuestionMarkInsteadOfTagName),this._createCommentToken(1),this.state=c.BOGUS_COMMENT,this._stateBogusComment(t);break}case o.EOF:{this._err(u.eofBeforeTagName),this._emitChars("<"),this._emitEOFToken();break}default:this._err(u.invalidFirstCharacterOfTagName),this._emitChars("<"),this.state=c.DATA,this._stateData(t)}}_stateEndTagOpen(t){if(K(t))this._createEndTagToken(),this.state=c.TAG_NAME,this._stateTagName(t);else switch(t){case o.GREATER_THAN_SIGN:{this._err(u.missingEndTagName),this.state=c.DATA;break}case o.EOF:{this._err(u.eofBeforeTagName),this._emitChars("</"),this._emitEOFToken();break}default:this._err(u.invalidFirstCharacterOfTagName),this._createCommentToken(2),this.state=c.BOGUS_COMMENT,this._stateBogusComment(t)}}_stateTagName(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:{this.state=c.BEFORE_ATTRIBUTE_NAME;break}case o.SOLIDUS:{this.state=c.SELF_CLOSING_START_TAG;break}case o.GREATER_THAN_SIGN:{this.state=c.DATA,this.emitCurrentTagToken();break}case o.NULL:{this._err(u.unexpectedNullCharacter),s.tagName+=P;break}case o.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:s.tagName+=String.fromCodePoint(ne(t)?Re(t):t)}}_stateRcdataLessThanSign(t){t===o.SOLIDUS?this.state=c.RCDATA_END_TAG_OPEN:(this._emitChars("<"),this.state=c.RCDATA,this._stateRcdata(t))}_stateRcdataEndTagOpen(t){K(t)?(this.state=c.RCDATA_END_TAG_NAME,this._stateRcdataEndTagName(t)):(this._emitChars("</"),this.state=c.RCDATA,this._stateRcdata(t))}handleSpecialEndTag(t){if(!this.preprocessor.startsWith(this.lastStartTagName,!1))return!this._ensureHibernation();this._createEndTagToken();const s=this.currentToken;switch(s.tagName=this.lastStartTagName,this.preprocessor.peek(this.lastStartTagName.length)){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:return this._advanceBy(this.lastStartTagName.length),this.state=c.BEFORE_ATTRIBUTE_NAME,!1;case o.SOLIDUS:return this._advanceBy(this.lastStartTagName.length),this.state=c.SELF_CLOSING_START_TAG,!1;case o.GREATER_THAN_SIGN:return this._advanceBy(this.lastStartTagName.length),this.emitCurrentTagToken(),this.state=c.DATA,!1;default:return!this._ensureHibernation()}}_stateRcdataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=c.RCDATA,this._stateRcdata(t))}_stateRawtextLessThanSign(t){t===o.SOLIDUS?this.state=c.RAWTEXT_END_TAG_OPEN:(this._emitChars("<"),this.state=c.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagOpen(t){K(t)?(this.state=c.RAWTEXT_END_TAG_NAME,this._stateRawtextEndTagName(t)):(this._emitChars("</"),this.state=c.RAWTEXT,this._stateRawtext(t))}_stateRawtextEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=c.RAWTEXT,this._stateRawtext(t))}_stateScriptDataLessThanSign(t){switch(t){case o.SOLIDUS:{this.state=c.SCRIPT_DATA_END_TAG_OPEN;break}case o.EXCLAMATION_MARK:{this.state=c.SCRIPT_DATA_ESCAPE_START,this._emitChars("<!");break}default:this._emitChars("<"),this.state=c.SCRIPT_DATA,this._stateScriptData(t)}}_stateScriptDataEndTagOpen(t){K(t)?(this.state=c.SCRIPT_DATA_END_TAG_NAME,this._stateScriptDataEndTagName(t)):(this._emitChars("</"),this.state=c.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=c.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStart(t){t===o.HYPHEN_MINUS?(this.state=c.SCRIPT_DATA_ESCAPE_START_DASH,this._emitChars("-")):(this.state=c.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscapeStartDash(t){t===o.HYPHEN_MINUS?(this.state=c.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-")):(this.state=c.SCRIPT_DATA,this._stateScriptData(t))}_stateScriptDataEscaped(t){switch(t){case o.HYPHEN_MINUS:{this.state=c.SCRIPT_DATA_ESCAPED_DASH,this._emitChars("-");break}case o.LESS_THAN_SIGN:{this.state=c.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case o.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(P);break}case o.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataEscapedDash(t){switch(t){case o.HYPHEN_MINUS:{this.state=c.SCRIPT_DATA_ESCAPED_DASH_DASH,this._emitChars("-");break}case o.LESS_THAN_SIGN:{this.state=c.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case o.NULL:{this._err(u.unexpectedNullCharacter),this.state=c.SCRIPT_DATA_ESCAPED,this._emitChars(P);break}case o.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=c.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedDashDash(t){switch(t){case o.HYPHEN_MINUS:{this._emitChars("-");break}case o.LESS_THAN_SIGN:{this.state=c.SCRIPT_DATA_ESCAPED_LESS_THAN_SIGN;break}case o.GREATER_THAN_SIGN:{this.state=c.SCRIPT_DATA,this._emitChars(">");break}case o.NULL:{this._err(u.unexpectedNullCharacter),this.state=c.SCRIPT_DATA_ESCAPED,this._emitChars(P);break}case o.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=c.SCRIPT_DATA_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataEscapedLessThanSign(t){t===o.SOLIDUS?this.state=c.SCRIPT_DATA_ESCAPED_END_TAG_OPEN:K(t)?(this._emitChars("<"),this.state=c.SCRIPT_DATA_DOUBLE_ESCAPE_START,this._stateScriptDataDoubleEscapeStart(t)):(this._emitChars("<"),this.state=c.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagOpen(t){K(t)?(this.state=c.SCRIPT_DATA_ESCAPED_END_TAG_NAME,this._stateScriptDataEscapedEndTagName(t)):(this._emitChars("</"),this.state=c.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataEscapedEndTagName(t){this.handleSpecialEndTag(t)&&(this._emitChars("</"),this.state=c.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscapeStart(t){if(this.preprocessor.startsWith(B.SCRIPT,!1)&&ut(this.preprocessor.peek(B.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<B.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED}else this._ensureHibernation()||(this.state=c.SCRIPT_DATA_ESCAPED,this._stateScriptDataEscaped(t))}_stateScriptDataDoubleEscaped(t){switch(t){case o.HYPHEN_MINUS:{this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED_DASH,this._emitChars("-");break}case o.LESS_THAN_SIGN:{this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case o.NULL:{this._err(u.unexpectedNullCharacter),this._emitChars(P);break}case o.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDash(t){switch(t){case o.HYPHEN_MINUS:{this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED_DASH_DASH,this._emitChars("-");break}case o.LESS_THAN_SIGN:{this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case o.NULL:{this._err(u.unexpectedNullCharacter),this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(P);break}case o.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedDashDash(t){switch(t){case o.HYPHEN_MINUS:{this._emitChars("-");break}case o.LESS_THAN_SIGN:{this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED_LESS_THAN_SIGN,this._emitChars("<");break}case o.GREATER_THAN_SIGN:{this.state=c.SCRIPT_DATA,this._emitChars(">");break}case o.NULL:{this._err(u.unexpectedNullCharacter),this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitChars(P);break}case o.EOF:{this._err(u.eofInScriptHtmlCommentLikeText),this._emitEOFToken();break}default:this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED,this._emitCodePoint(t)}}_stateScriptDataDoubleEscapedLessThanSign(t){t===o.SOLIDUS?(this.state=c.SCRIPT_DATA_DOUBLE_ESCAPE_END,this._emitChars("/")):(this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateScriptDataDoubleEscapeEnd(t){if(this.preprocessor.startsWith(B.SCRIPT,!1)&&ut(this.preprocessor.peek(B.SCRIPT.length))){this._emitCodePoint(t);for(let s=0;s<B.SCRIPT.length;s++)this._emitCodePoint(this._consume());this.state=c.SCRIPT_DATA_ESCAPED}else this._ensureHibernation()||(this.state=c.SCRIPT_DATA_DOUBLE_ESCAPED,this._stateScriptDataDoubleEscaped(t))}_stateBeforeAttributeName(t){switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.SOLIDUS:case o.GREATER_THAN_SIGN:case o.EOF:{this.state=c.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case o.EQUALS_SIGN:{this._err(u.unexpectedEqualsSignBeforeAttributeName),this._createAttr("="),this.state=c.ATTRIBUTE_NAME;break}default:this._createAttr(""),this.state=c.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateAttributeName(t){switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:case o.SOLIDUS:case o.GREATER_THAN_SIGN:case o.EOF:{this._leaveAttrName(),this.state=c.AFTER_ATTRIBUTE_NAME,this._stateAfterAttributeName(t);break}case o.EQUALS_SIGN:{this._leaveAttrName(),this.state=c.BEFORE_ATTRIBUTE_VALUE;break}case o.QUOTATION_MARK:case o.APOSTROPHE:case o.LESS_THAN_SIGN:{this._err(u.unexpectedCharacterInAttributeName),this.currentAttr.name+=String.fromCodePoint(t);break}case o.NULL:{this._err(u.unexpectedNullCharacter),this.currentAttr.name+=P;break}default:this.currentAttr.name+=String.fromCodePoint(ne(t)?Re(t):t)}}_stateAfterAttributeName(t){switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.SOLIDUS:{this.state=c.SELF_CLOSING_START_TAG;break}case o.EQUALS_SIGN:{this.state=c.BEFORE_ATTRIBUTE_VALUE;break}case o.GREATER_THAN_SIGN:{this.state=c.DATA,this.emitCurrentTagToken();break}case o.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this._createAttr(""),this.state=c.ATTRIBUTE_NAME,this._stateAttributeName(t)}}_stateBeforeAttributeValue(t){switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.QUOTATION_MARK:{this.state=c.ATTRIBUTE_VALUE_DOUBLE_QUOTED;break}case o.APOSTROPHE:{this.state=c.ATTRIBUTE_VALUE_SINGLE_QUOTED;break}case o.GREATER_THAN_SIGN:{this._err(u.missingAttributeValue),this.state=c.DATA,this.emitCurrentTagToken();break}default:this.state=c.ATTRIBUTE_VALUE_UNQUOTED,this._stateAttributeValueUnquoted(t)}}_stateAttributeValueDoubleQuoted(t){switch(t){case o.QUOTATION_MARK:{this.state=c.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case o.AMPERSAND:{this._startCharacterReference();break}case o.NULL:{this._err(u.unexpectedNullCharacter),this.currentAttr.value+=P;break}case o.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueSingleQuoted(t){switch(t){case o.APOSTROPHE:{this.state=c.AFTER_ATTRIBUTE_VALUE_QUOTED;break}case o.AMPERSAND:{this._startCharacterReference();break}case o.NULL:{this._err(u.unexpectedNullCharacter),this.currentAttr.value+=P;break}case o.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAttributeValueUnquoted(t){switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:{this._leaveAttrValue(),this.state=c.BEFORE_ATTRIBUTE_NAME;break}case o.AMPERSAND:{this._startCharacterReference();break}case o.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=c.DATA,this.emitCurrentTagToken();break}case o.NULL:{this._err(u.unexpectedNullCharacter),this.currentAttr.value+=P;break}case o.QUOTATION_MARK:case o.APOSTROPHE:case o.LESS_THAN_SIGN:case o.EQUALS_SIGN:case o.GRAVE_ACCENT:{this._err(u.unexpectedCharacterInUnquotedAttributeValue),this.currentAttr.value+=String.fromCodePoint(t);break}case o.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this.currentAttr.value+=String.fromCodePoint(t)}}_stateAfterAttributeValueQuoted(t){switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:{this._leaveAttrValue(),this.state=c.BEFORE_ATTRIBUTE_NAME;break}case o.SOLIDUS:{this._leaveAttrValue(),this.state=c.SELF_CLOSING_START_TAG;break}case o.GREATER_THAN_SIGN:{this._leaveAttrValue(),this.state=c.DATA,this.emitCurrentTagToken();break}case o.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this._err(u.missingWhitespaceBetweenAttributes),this.state=c.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateSelfClosingStartTag(t){switch(t){case o.GREATER_THAN_SIGN:{const s=this.currentToken;s.selfClosing=!0,this.state=c.DATA,this.emitCurrentTagToken();break}case o.EOF:{this._err(u.eofInTag),this._emitEOFToken();break}default:this._err(u.unexpectedSolidusInTag),this.state=c.BEFORE_ATTRIBUTE_NAME,this._stateBeforeAttributeName(t)}}_stateBogusComment(t){const s=this.currentToken;switch(t){case o.GREATER_THAN_SIGN:{this.state=c.DATA,this.emitCurrentComment(s);break}case o.EOF:{this.emitCurrentComment(s),this._emitEOFToken();break}case o.NULL:{this._err(u.unexpectedNullCharacter),s.data+=P;break}default:s.data+=String.fromCodePoint(t)}}_stateMarkupDeclarationOpen(t){this._consumeSequenceIfMatch(B.DASH_DASH,!0)?(this._createCommentToken(B.DASH_DASH.length+1),this.state=c.COMMENT_START):this._consumeSequenceIfMatch(B.DOCTYPE,!1)?(this.currentLocation=this.getCurrentLocation(B.DOCTYPE.length+1),this.state=c.DOCTYPE):this._consumeSequenceIfMatch(B.CDATA_START,!0)?this.inForeignNode?this.state=c.CDATA_SECTION:(this._err(u.cdataInHtmlContent),this._createCommentToken(B.CDATA_START.length+1),this.currentToken.data="[CDATA[",this.state=c.BOGUS_COMMENT):this._ensureHibernation()||(this._err(u.incorrectlyOpenedComment),this._createCommentToken(2),this.state=c.BOGUS_COMMENT,this._stateBogusComment(t))}_stateCommentStart(t){switch(t){case o.HYPHEN_MINUS:{this.state=c.COMMENT_START_DASH;break}case o.GREATER_THAN_SIGN:{this._err(u.abruptClosingOfEmptyComment),this.state=c.DATA;const s=this.currentToken;this.emitCurrentComment(s);break}default:this.state=c.COMMENT,this._stateComment(t)}}_stateCommentStartDash(t){const s=this.currentToken;switch(t){case o.HYPHEN_MINUS:{this.state=c.COMMENT_END;break}case o.GREATER_THAN_SIGN:{this._err(u.abruptClosingOfEmptyComment),this.state=c.DATA,this.emitCurrentComment(s);break}case o.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=c.COMMENT,this._stateComment(t)}}_stateComment(t){const s=this.currentToken;switch(t){case o.HYPHEN_MINUS:{this.state=c.COMMENT_END_DASH;break}case o.LESS_THAN_SIGN:{s.data+="<",this.state=c.COMMENT_LESS_THAN_SIGN;break}case o.NULL:{this._err(u.unexpectedNullCharacter),s.data+=P;break}case o.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+=String.fromCodePoint(t)}}_stateCommentLessThanSign(t){const s=this.currentToken;switch(t){case o.EXCLAMATION_MARK:{s.data+="!",this.state=c.COMMENT_LESS_THAN_SIGN_BANG;break}case o.LESS_THAN_SIGN:{s.data+="<";break}default:this.state=c.COMMENT,this._stateComment(t)}}_stateCommentLessThanSignBang(t){t===o.HYPHEN_MINUS?this.state=c.COMMENT_LESS_THAN_SIGN_BANG_DASH:(this.state=c.COMMENT,this._stateComment(t))}_stateCommentLessThanSignBangDash(t){t===o.HYPHEN_MINUS?this.state=c.COMMENT_LESS_THAN_SIGN_BANG_DASH_DASH:(this.state=c.COMMENT_END_DASH,this._stateCommentEndDash(t))}_stateCommentLessThanSignBangDashDash(t){t!==o.GREATER_THAN_SIGN&&t!==o.EOF&&this._err(u.nestedComment),this.state=c.COMMENT_END,this._stateCommentEnd(t)}_stateCommentEndDash(t){const s=this.currentToken;switch(t){case o.HYPHEN_MINUS:{this.state=c.COMMENT_END;break}case o.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="-",this.state=c.COMMENT,this._stateComment(t)}}_stateCommentEnd(t){const s=this.currentToken;switch(t){case o.GREATER_THAN_SIGN:{this.state=c.DATA,this.emitCurrentComment(s);break}case o.EXCLAMATION_MARK:{this.state=c.COMMENT_END_BANG;break}case o.HYPHEN_MINUS:{s.data+="-";break}case o.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--",this.state=c.COMMENT,this._stateComment(t)}}_stateCommentEndBang(t){const s=this.currentToken;switch(t){case o.HYPHEN_MINUS:{s.data+="--!",this.state=c.COMMENT_END_DASH;break}case o.GREATER_THAN_SIGN:{this._err(u.incorrectlyClosedComment),this.state=c.DATA,this.emitCurrentComment(s);break}case o.EOF:{this._err(u.eofInComment),this.emitCurrentComment(s),this._emitEOFToken();break}default:s.data+="--!",this.state=c.COMMENT,this._stateComment(t)}}_stateDoctype(t){switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:{this.state=c.BEFORE_DOCTYPE_NAME;break}case o.GREATER_THAN_SIGN:{this.state=c.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t);break}case o.EOF:{this._err(u.eofInDoctype),this._createDoctypeToken(null);const s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingWhitespaceBeforeDoctypeName),this.state=c.BEFORE_DOCTYPE_NAME,this._stateBeforeDoctypeName(t)}}_stateBeforeDoctypeName(t){if(ne(t))this._createDoctypeToken(String.fromCharCode(Re(t))),this.state=c.DOCTYPE_NAME;else switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.NULL:{this._err(u.unexpectedNullCharacter),this._createDoctypeToken(P),this.state=c.DOCTYPE_NAME;break}case o.GREATER_THAN_SIGN:{this._err(u.missingDoctypeName),this._createDoctypeToken(null);const s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=c.DATA;break}case o.EOF:{this._err(u.eofInDoctype),this._createDoctypeToken(null);const s=this.currentToken;s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._createDoctypeToken(String.fromCodePoint(t)),this.state=c.DOCTYPE_NAME}}_stateDoctypeName(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:{this.state=c.AFTER_DOCTYPE_NAME;break}case o.GREATER_THAN_SIGN:{this.state=c.DATA,this.emitCurrentDoctype(s);break}case o.NULL:{this._err(u.unexpectedNullCharacter),s.name+=P;break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.name+=String.fromCodePoint(ne(t)?Re(t):t)}}_stateAfterDoctypeName(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.GREATER_THAN_SIGN:{this.state=c.DATA,this.emitCurrentDoctype(s);break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._consumeSequenceIfMatch(B.PUBLIC,!1)?this.state=c.AFTER_DOCTYPE_PUBLIC_KEYWORD:this._consumeSequenceIfMatch(B.SYSTEM,!1)?this.state=c.AFTER_DOCTYPE_SYSTEM_KEYWORD:this._ensureHibernation()||(this._err(u.invalidCharacterSequenceAfterDoctypeName),s.forceQuirks=!0,this.state=c.BOGUS_DOCTYPE,this._stateBogusDoctype(t))}}_stateAfterDoctypePublicKeyword(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:{this.state=c.BEFORE_DOCTYPE_PUBLIC_IDENTIFIER;break}case o.QUOTATION_MARK:{this._err(u.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=c.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case o.APOSTROPHE:{this._err(u.missingWhitespaceAfterDoctypePublicKeyword),s.publicId="",this.state=c.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case o.GREATER_THAN_SIGN:{this._err(u.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=c.DATA,this.emitCurrentDoctype(s);break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=c.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypePublicIdentifier(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.QUOTATION_MARK:{s.publicId="",this.state=c.DOCTYPE_PUBLIC_IDENTIFIER_DOUBLE_QUOTED;break}case o.APOSTROPHE:{s.publicId="",this.state=c.DOCTYPE_PUBLIC_IDENTIFIER_SINGLE_QUOTED;break}case o.GREATER_THAN_SIGN:{this._err(u.missingDoctypePublicIdentifier),s.forceQuirks=!0,this.state=c.DATA,this.emitCurrentDoctype(s);break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypePublicIdentifier),s.forceQuirks=!0,this.state=c.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypePublicIdentifierDoubleQuoted(t){const s=this.currentToken;switch(t){case o.QUOTATION_MARK:{this.state=c.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case o.NULL:{this._err(u.unexpectedNullCharacter),s.publicId+=P;break}case o.GREATER_THAN_SIGN:{this._err(u.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=c.DATA;break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateDoctypePublicIdentifierSingleQuoted(t){const s=this.currentToken;switch(t){case o.APOSTROPHE:{this.state=c.AFTER_DOCTYPE_PUBLIC_IDENTIFIER;break}case o.NULL:{this._err(u.unexpectedNullCharacter),s.publicId+=P;break}case o.GREATER_THAN_SIGN:{this._err(u.abruptDoctypePublicIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=c.DATA;break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.publicId+=String.fromCodePoint(t)}}_stateAfterDoctypePublicIdentifier(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:{this.state=c.BETWEEN_DOCTYPE_PUBLIC_AND_SYSTEM_IDENTIFIERS;break}case o.GREATER_THAN_SIGN:{this.state=c.DATA,this.emitCurrentDoctype(s);break}case o.QUOTATION_MARK:{this._err(u.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=c.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case o.APOSTROPHE:{this._err(u.missingWhitespaceBetweenDoctypePublicAndSystemIdentifiers),s.systemId="",this.state=c.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=c.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBetweenDoctypePublicAndSystemIdentifiers(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=c.DATA;break}case o.QUOTATION_MARK:{s.systemId="",this.state=c.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case o.APOSTROPHE:{s.systemId="",this.state=c.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=c.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateAfterDoctypeSystemKeyword(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:{this.state=c.BEFORE_DOCTYPE_SYSTEM_IDENTIFIER;break}case o.QUOTATION_MARK:{this._err(u.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=c.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case o.APOSTROPHE:{this._err(u.missingWhitespaceAfterDoctypeSystemKeyword),s.systemId="",this.state=c.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case o.GREATER_THAN_SIGN:{this._err(u.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=c.DATA,this.emitCurrentDoctype(s);break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=c.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBeforeDoctypeSystemIdentifier(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.QUOTATION_MARK:{s.systemId="",this.state=c.DOCTYPE_SYSTEM_IDENTIFIER_DOUBLE_QUOTED;break}case o.APOSTROPHE:{s.systemId="",this.state=c.DOCTYPE_SYSTEM_IDENTIFIER_SINGLE_QUOTED;break}case o.GREATER_THAN_SIGN:{this._err(u.missingDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=c.DATA,this.emitCurrentDoctype(s);break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.missingQuoteBeforeDoctypeSystemIdentifier),s.forceQuirks=!0,this.state=c.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateDoctypeSystemIdentifierDoubleQuoted(t){const s=this.currentToken;switch(t){case o.QUOTATION_MARK:{this.state=c.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case o.NULL:{this._err(u.unexpectedNullCharacter),s.systemId+=P;break}case o.GREATER_THAN_SIGN:{this._err(u.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=c.DATA;break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateDoctypeSystemIdentifierSingleQuoted(t){const s=this.currentToken;switch(t){case o.APOSTROPHE:{this.state=c.AFTER_DOCTYPE_SYSTEM_IDENTIFIER;break}case o.NULL:{this._err(u.unexpectedNullCharacter),s.systemId+=P;break}case o.GREATER_THAN_SIGN:{this._err(u.abruptDoctypeSystemIdentifier),s.forceQuirks=!0,this.emitCurrentDoctype(s),this.state=c.DATA;break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:s.systemId+=String.fromCodePoint(t)}}_stateAfterDoctypeSystemIdentifier(t){const s=this.currentToken;switch(t){case o.SPACE:case o.LINE_FEED:case o.TABULATION:case o.FORM_FEED:break;case o.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=c.DATA;break}case o.EOF:{this._err(u.eofInDoctype),s.forceQuirks=!0,this.emitCurrentDoctype(s),this._emitEOFToken();break}default:this._err(u.unexpectedCharacterAfterDoctypeSystemIdentifier),this.state=c.BOGUS_DOCTYPE,this._stateBogusDoctype(t)}}_stateBogusDoctype(t){const s=this.currentToken;switch(t){case o.GREATER_THAN_SIGN:{this.emitCurrentDoctype(s),this.state=c.DATA;break}case o.NULL:{this._err(u.unexpectedNullCharacter);break}case o.EOF:{this.emitCurrentDoctype(s),this._emitEOFToken();break}}}_stateCdataSection(t){switch(t){case o.RIGHT_SQUARE_BRACKET:{this.state=c.CDATA_SECTION_BRACKET;break}case o.EOF:{this._err(u.eofInCdata),this._emitEOFToken();break}default:this._emitCodePoint(t)}}_stateCdataSectionBracket(t){t===o.RIGHT_SQUARE_BRACKET?this.state=c.CDATA_SECTION_END:(this._emitChars("]"),this.state=c.CDATA_SECTION,this._stateCdataSection(t))}_stateCdataSectionEnd(t){switch(t){case o.GREATER_THAN_SIGN:{this.state=c.DATA;break}case o.RIGHT_SQUARE_BRACKET:{this._emitChars("]");break}default:this._emitChars("]]"),this.state=c.CDATA_SECTION,this._stateCdataSection(t)}}_stateCharacterReference(){let t=this.entityDecoder.write(this.preprocessor.html,this.preprocessor.pos);if(t<0)if(this.preprocessor.lastChunkWritten)t=this.entityDecoder.end();else{this.active=!1,this.preprocessor.pos=this.preprocessor.html.length-1,this.consumedAfterSnapshot=0,this.preprocessor.endOfChunkHit=!0;return}t===0?(this.preprocessor.pos=this.entityStartPos,this._flushCodePointConsumedAsCharacterReference(o.AMPERSAND),this.state=!this._isCharacterReferenceInAttribute()&&dt(this.preprocessor.peek(1))?c.AMBIGUOUS_AMPERSAND:this.returnState):this.state=this.returnState}_stateAmbiguousAmpersand(t){dt(t)?this._flushCodePointConsumedAsCharacterReference(t):(t===o.SEMICOLON&&this._err(u.unknownNamedCharacterReference),this.state=this.returnState,this._callState(t))}}const Ts=new Set([r.DD,r.DT,r.LI,r.OPTGROUP,r.OPTION,r.P,r.RB,r.RP,r.RT,r.RTC]),Ct=new Set([...Ts,r.CAPTION,r.COLGROUP,r.TBODY,r.TD,r.TFOOT,r.TH,r.THEAD,r.TR]),Pe=new Set([r.APPLET,r.CAPTION,r.HTML,r.MARQUEE,r.OBJECT,r.TABLE,r.TD,r.TEMPLATE,r.TH]),bn=new Set([...Pe,r.OL,r.UL]),Bn=new Set([...Pe,r.BUTTON]),Nt=new Set([r.ANNOTATION_XML,r.MI,r.MN,r.MO,r.MS,r.MTEXT]),It=new Set([r.DESC,r.FOREIGN_OBJECT,r.TITLE]),Hn=new Set([r.TR,r.TEMPLATE,r.HTML]),Fn=new Set([r.TBODY,r.TFOOT,r.THEAD,r.TEMPLATE,r.HTML]),Un=new Set([r.TABLE,r.TEMPLATE,r.HTML]),kn=new Set([r.TD,r.TH]);class yn{get currentTmplContentOrNode(){return this._isInTemplate()?this.treeAdapter.getTemplateContent(this.current):this.current}constructor(t,s,n){this.treeAdapter=s,this.handler=n,this.items=[],this.tagIDs=[],this.stackTop=-1,this.tmplCount=0,this.currentTagId=r.UNKNOWN,this.current=t}_indexOf(t){return this.items.lastIndexOf(t,this.stackTop)}_isInTemplate(){return this.currentTagId===r.TEMPLATE&&this.treeAdapter.getNamespaceURI(this.current)===N.HTML}_updateCurrentElement(){this.current=this.items[this.stackTop],this.currentTagId=this.tagIDs[this.stackTop]}push(t,s){this.stackTop++,this.items[this.stackTop]=t,this.current=t,this.tagIDs[this.stackTop]=s,this.currentTagId=s,this._isInTemplate()&&this.tmplCount++,this.handler.onItemPush(t,s,!0)}pop(){const t=this.current;this.tmplCount>0&&this._isInTemplate()&&this.tmplCount--,this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!0)}replace(t,s){const n=this._indexOf(t);this.items[n]=s,n===this.stackTop&&(this.current=s)}insertAfter(t,s,n){const T=this._indexOf(t)+1;this.items.splice(T,0,s),this.tagIDs.splice(T,0,n),this.stackTop++,T===this.stackTop&&this._updateCurrentElement(),this.handler.onItemPush(this.current,this.currentTagId,T===this.stackTop)}popUntilTagNamePopped(t){let s=this.stackTop+1;do s=this.tagIDs.lastIndexOf(t,s-1);while(s>0&&this.treeAdapter.getNamespaceURI(this.items[s])!==N.HTML);this.shortenToLength(s<0?0:s)}shortenToLength(t){for(;this.stackTop>=t;){const s=this.current;this.tmplCount>0&&this._isInTemplate()&&(this.tmplCount-=1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(s,this.stackTop<t)}}popUntilElementPopped(t){const s=this._indexOf(t);this.shortenToLength(s<0?0:s)}popUntilPopped(t,s){const n=this._indexOfTagNames(t,s);this.shortenToLength(n<0?0:n)}popUntilNumberedHeaderPopped(){this.popUntilPopped(Ve,N.HTML)}popUntilTableCellPopped(){this.popUntilPopped(kn,N.HTML)}popAllUpToHtmlElement(){this.tmplCount=0,this.shortenToLength(1)}_indexOfTagNames(t,s){for(let n=this.stackTop;n>=0;n--)if(t.has(this.tagIDs[n])&&this.treeAdapter.getNamespaceURI(this.items[n])===s)return n;return-1}clearBackTo(t,s){const n=this._indexOfTagNames(t,s);this.shortenToLength(n+1)}clearBackToTableContext(){this.clearBackTo(Un,N.HTML)}clearBackToTableBodyContext(){this.clearBackTo(Fn,N.HTML)}clearBackToTableRowContext(){this.clearBackTo(Hn,N.HTML)}remove(t){const s=this._indexOf(t);s>=0&&(s===this.stackTop?this.pop():(this.items.splice(s,1),this.tagIDs.splice(s,1),this.stackTop--,this._updateCurrentElement(),this.handler.onItemPop(t,!1)))}tryPeekProperlyNestedBodyElement(){return this.stackTop>=1&&this.tagIDs[1]===r.BODY?this.items[1]:null}contains(t){return this._indexOf(t)>-1}getCommonAncestor(t){const s=this._indexOf(t)-1;return s>=0?this.items[s]:null}isRootHtmlElementCurrent(){return this.stackTop===0&&this.tagIDs[0]===r.HTML}hasInDynamicScope(t,s){for(let n=this.stackTop;n>=0;n--){const T=this.tagIDs[n];switch(this.treeAdapter.getNamespaceURI(this.items[n])){case N.HTML:{if(T===t)return!0;if(s.has(T))return!1;break}case N.SVG:{if(It.has(T))return!1;break}case N.MATHML:{if(Nt.has(T))return!1;break}}}return!0}hasInScope(t){return this.hasInDynamicScope(t,Pe)}hasInListItemScope(t){return this.hasInDynamicScope(t,bn)}hasInButtonScope(t){return this.hasInDynamicScope(t,Bn)}hasNumberedHeaderInScope(){for(let t=this.stackTop;t>=0;t--){const s=this.tagIDs[t];switch(this.treeAdapter.getNamespaceURI(this.items[t])){case N.HTML:{if(Ve.has(s))return!0;if(Pe.has(s))return!1;break}case N.SVG:{if(It.has(s))return!1;break}case N.MATHML:{if(Nt.has(s))return!1;break}}}return!0}hasInTableScope(t){for(let s=this.stackTop;s>=0;s--)if(this.treeAdapter.getNamespaceURI(this.items[s])===N.HTML)switch(this.tagIDs[s]){case t:return!0;case r.TABLE:case r.HTML:return!1}return!0}hasTableBodyContextInTableScope(){for(let t=this.stackTop;t>=0;t--)if(this.treeAdapter.getNamespaceURI(this.items[t])===N.HTML)switch(this.tagIDs[t]){case r.TBODY:case r.THEAD:case r.TFOOT:return!0;case r.TABLE:case r.HTML:return!1}return!0}hasInSelectScope(t){for(let s=this.stackTop;s>=0;s--)if(this.treeAdapter.getNamespaceURI(this.items[s])===N.HTML)switch(this.tagIDs[s]){case t:return!0;case r.OPTION:case r.OPTGROUP:break;default:return!1}return!0}generateImpliedEndTags(){for(;Ts.has(this.currentTagId);)this.pop()}generateImpliedEndTagsThoroughly(){for(;Ct.has(this.currentTagId);)this.pop()}generateImpliedEndTagsWithExclusion(t){for(;this.currentTagId!==t&&Ct.has(this.currentTagId);)this.pop()}}const Xe=3;var v;(function(e){e[e.Marker=0]="Marker",e[e.Element=1]="Element"})(v||(v={}));const ft={type:v.Marker};class xn{constructor(t){this.treeAdapter=t,this.entries=[],this.bookmark=null}_getNoahArkConditionCandidates(t,s){const n=[],T=s.length,m=this.treeAdapter.getTagName(t),O=this.treeAdapter.getNamespaceURI(t);for(let R=0;R<this.entries.length;R++){const D=this.entries[R];if(D.type===v.Marker)break;const{element:U}=D;if(this.treeAdapter.getTagName(U)===m&&this.treeAdapter.getNamespaceURI(U)===O){const Q=this.treeAdapter.getAttrList(U);Q.length===T&&n.push({idx:R,attrs:Q})}}return n}_ensureNoahArkCondition(t){if(this.entries.length<Xe)return;const s=this.treeAdapter.getAttrList(t),n=this._getNoahArkConditionCandidates(t,s);if(n.length<Xe)return;const T=new Map(s.map(O=>[O.name,O.value]));let m=0;for(let O=0;O<n.length;O++){const R=n[O];R.attrs.every(D=>T.get(D.name)===D.value)&&(m+=1,m>=Xe&&this.entries.splice(R.idx,1))}}insertMarker(){this.entries.unshift(ft)}pushElement(t,s){this._ensureNoahArkCondition(t),this.entries.unshift({type:v.Element,element:t,token:s})}insertElementAfterBookmark(t,s){const n=this.entries.indexOf(this.bookmark);this.entries.splice(n,0,{type:v.Element,element:t,token:s})}removeEntry(t){const s=this.entries.indexOf(t);s>=0&&this.entries.splice(s,1)}clearToLastMarker(){const t=this.entries.indexOf(ft);t>=0?this.entries.splice(0,t+1):this.entries.length=0}getElementEntryInScopeWithTagName(t){const s=this.entries.find(n=>n.type===v.Marker||this.treeAdapter.getTagName(n.element)===t);return s&&s.type===v.Element?s:null}getElementEntry(t){return this.entries.find(s=>s.type===v.Element&&s.element===t)}}const X={createDocument(){return{nodeName:"#document",mode:y.NO_QUIRKS,childNodes:[]}},createDocumentFragment(){return{nodeName:"#document-fragment",childNodes:[]}},createElement(e,t,s){return{nodeName:e,tagName:e,attrs:s,namespaceURI:t,childNodes:[],parentNode:null}},createCommentNode(e){return{nodeName:"#comment",data:e,parentNode:null}},createTextNode(e){return{nodeName:"#text",value:e,parentNode:null}},appendChild(e,t){e.childNodes.push(t),t.parentNode=e},insertBefore(e,t,s){const n=e.childNodes.indexOf(s);e.childNodes.splice(n,0,t),t.parentNode=e},setTemplateContent(e,t){e.content=t},getTemplateContent(e){return e.content},setDocumentType(e,t,s,n){const T=e.childNodes.find(m=>m.nodeName==="#documentType");if(T)T.name=t,T.publicId=s,T.systemId=n;else{const m={nodeName:"#documentType",name:t,publicId:s,systemId:n,parentNode:null};X.appendChild(e,m)}},setDocumentMode(e,t){e.mode=t},getDocumentMode(e){return e.mode},detachNode(e){if(e.parentNode){const t=e.parentNode.childNodes.indexOf(e);e.parentNode.childNodes.splice(t,1),e.parentNode=null}},insertText(e,t){if(e.childNodes.length>0){const s=e.childNodes[e.childNodes.length-1];if(X.isTextNode(s)){s.value+=t;return}}X.appendChild(e,X.createTextNode(t))},insertTextBefore(e,t,s){const n=e.childNodes[e.childNodes.indexOf(s)-1];n&&X.isTextNode(n)?n.value+=t:X.insertBefore(e,X.createTextNode(t),s)},adoptAttributes(e,t){const s=new Set(e.attrs.map(n=>n.name));for(let n=0;n<t.length;n++)s.has(t[n].name)||e.attrs.push(t[n])},getFirstChild(e){return e.childNodes[0]},getChildNodes(e){return e.childNodes},getParentNode(e){return e.parentNode},getAttrList(e){return e.attrs},getTagName(e){return e.tagName},getNamespaceURI(e){return e.namespaceURI},getTextNodeContent(e){return e.value},getCommentNodeContent(e){return e.data},getDocumentTypeNodeName(e){return e.name},getDocumentTypeNodePublicId(e){return e.publicId},getDocumentTypeNodeSystemId(e){return e.systemId},isTextNode(e){return e.nodeName==="#text"},isCommentNode(e){return e.nodeName==="#comment"},isDocumentTypeNode(e){return e.nodeName==="#documentType"},isElementNode(e){return Object.prototype.hasOwnProperty.call(e,"tagName")},setNodeSourceCodeLocation(e,t){e.sourceCodeLocation=t},getNodeSourceCodeLocation(e){return e.sourceCodeLocation},updateNodeSourceCodeLocation(e,t){e.sourceCodeLocation={...e.sourceCodeLocation,...t}}},hs="html",Yn="about:legacy-compat",wn="http://www.ibm.com/data/dtd/v11/ibmxhtml1-transitional.dtd",_s=["+//silmaril//dtd html pro v0r11 19970101//","-//as//dtd html 3.0 aswedit + extensions//","-//advasoft ltd//dtd html 3.0 aswedit + extensions//","-//ietf//dtd html 2.0 level 1//","-//ietf//dtd html 2.0 level 2//","-//ietf//dtd html 2.0 strict level 1//","-//ietf//dtd html 2.0 strict level 2//","-//ietf//dtd html 2.0 strict//","-//ietf//dtd html 2.0//","-//ietf//dtd html 2.1e//","-//ietf//dtd html 3.0//","-//ietf//dtd html 3.2 final//","-//ietf//dtd html 3.2//","-//ietf//dtd html 3//","-//ietf//dtd html level 0//","-//ietf//dtd html level 1//","-//ietf//dtd html level 2//","-//ietf//dtd html level 3//","-//ietf//dtd html strict level 0//","-//ietf//dtd html strict level 1//","-//ietf//dtd html strict level 2//","-//ietf//dtd html strict level 3//","-//ietf//dtd html strict//","-//ietf//dtd html//","-//metrius//dtd metrius presentational//","-//microsoft//dtd internet explorer 2.0 html strict//","-//microsoft//dtd internet explorer 2.0 html//","-//microsoft//dtd internet explorer 2.0 tables//","-//microsoft//dtd internet explorer 3.0 html strict//","-//microsoft//dtd internet explorer 3.0 html//","-//microsoft//dtd internet explorer 3.0 tables//","-//netscape comm. corp.//dtd html//","-//netscape comm. corp.//dtd strict html//","-//o'reilly and associates//dtd html 2.0//","-//o'reilly and associates//dtd html extended 1.0//","-//o'reilly and associates//dtd html extended relaxed 1.0//","-//sq//dtd html 2.0 hotmetal + extensions//","-//softquad software//dtd hotmetal pro 6.0::19990601::extensions to html 4.0//","-//softquad//dtd hotmetal pro 4.0::19971010::extensions to html 4.0//","-//spyglass//dtd html 2.0 extended//","-//sun microsystems corp.//dtd hotjava html//","-//sun microsystems corp.//dtd hotjava strict html//","-//w3c//dtd html 3 1995-03-24//","-//w3c//dtd html 3.2 draft//","-//w3c//dtd html 3.2 final//","-//w3c//dtd html 3.2//","-//w3c//dtd html 3.2s draft//","-//w3c//dtd html 4.0 frameset//","-//w3c//dtd html 4.0 transitional//","-//w3c//dtd html experimental 19960712//","-//w3c//dtd html experimental 970421//","-//w3c//dtd w3 html//","-//w3o//dtd w3 html 3.0//","-//webtechs//dtd mozilla html 2.0//","-//webtechs//dtd mozilla html//"],vn=[..._s,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"],Qn=new Set(["-//w3o//dtd w3 html strict 3.0//en//","-/w3c/dtd html 4.0 transitional/en","html"]),ls=["-//w3c//dtd xhtml 1.0 frameset//","-//w3c//dtd xhtml 1.0 transitional//"],Xn=[...ls,"-//w3c//dtd html 4.01 frameset//","-//w3c//dtd html 4.01 transitional//"];function Ot(e,t){return t.some(s=>e.startsWith(s))}function Wn(e){return e.name===hs&&e.publicId===null&&(e.systemId===null||e.systemId===Yn)}function Kn(e){if(e.name!==hs)return y.QUIRKS;const{systemId:t}=e;if(t&&t.toLowerCase()===wn)return y.QUIRKS;let{publicId:s}=e;if(s!==null){if(s=s.toLowerCase(),Qn.has(s))return y.QUIRKS;let n=t===null?vn:_s;if(Ot(s,n))return y.QUIRKS;if(n=t===null?ls:Xn,Ot(s,n))return y.LIMITED_QUIRKS}return y.NO_QUIRKS}const Rt={TEXT_HTML:"text/html",APPLICATION_XML:"application/xhtml+xml"},Gn="definitionurl",$n="definitionURL",Vn=new Map(["attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(e=>[e.toLowerCase(),e])),zn=new Map([["xlink:actuate",{prefix:"xlink",name:"actuate",namespace:N.XLINK}],["xlink:arcrole",{prefix:"xlink",name:"arcrole",namespace:N.XLINK}],["xlink:href",{prefix:"xlink",name:"href",namespace:N.XLINK}],["xlink:role",{prefix:"xlink",name:"role",namespace:N.XLINK}],["xlink:show",{prefix:"xlink",name:"show",namespace:N.XLINK}],["xlink:title",{prefix:"xlink",name:"title",namespace:N.XLINK}],["xlink:type",{prefix:"xlink",name:"type",namespace:N.XLINK}],["xml:lang",{prefix:"xml",name:"lang",namespace:N.XML}],["xml:space",{prefix:"xml",name:"space",namespace:N.XML}],["xmlns",{prefix:"",name:"xmlns",namespace:N.XMLNS}],["xmlns:xlink",{prefix:"xmlns",name:"xlink",namespace:N.XMLNS}]]),qn=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(e=>[e.toLowerCase(),e])),Jn=new Set([r.B,r.BIG,r.BLOCKQUOTE,r.BODY,r.BR,r.CENTER,r.CODE,r.DD,r.DIV,r.DL,r.DT,r.EM,r.EMBED,r.H1,r.H2,r.H3,r.H4,r.H5,r.H6,r.HEAD,r.HR,r.I,r.IMG,r.LI,r.LISTING,r.MENU,r.META,r.NOBR,r.OL,r.P,r.PRE,r.RUBY,r.S,r.SMALL,r.SPAN,r.STRONG,r.STRIKE,r.SUB,r.SUP,r.TABLE,r.TT,r.U,r.UL,r.VAR]);function jn(e){const t=e.tagID;return t===r.FONT&&e.attrs.some(({name:n})=>n===z.COLOR||n===z.SIZE||n===z.FACE)||Jn.has(t)}function As(e){for(let t=0;t<e.attrs.length;t++)if(e.attrs[t].name===Gn){e.attrs[t].name=$n;break}}function ms(e){for(let t=0;t<e.attrs.length;t++){const s=Vn.get(e.attrs[t].name);s!=null&&(e.attrs[t].name=s)}}function tt(e){for(let t=0;t<e.attrs.length;t++){const s=zn.get(e.attrs[t].name);s&&(e.attrs[t].prefix=s.prefix,e.attrs[t].name=s.name,e.attrs[t].namespace=s.namespace)}}function Zn(e){const t=qn.get(e.tagName);t!=null&&(e.tagName=t,e.tagID=ke(e.tagName))}function ei(e,t){return t===N.MATHML&&(e===r.MI||e===r.MO||e===r.MN||e===r.MS||e===r.MTEXT)}function ti(e,t,s){if(t===N.MATHML&&e===r.ANNOTATION_XML){for(let n=0;n<s.length;n++)if(s[n].name===z.ENCODING){const T=s[n].value.toLowerCase();return T===Rt.TEXT_HTML||T===Rt.APPLICATION_XML}}return t===N.SVG&&(e===r.FOREIGN_OBJECT||e===r.DESC||e===r.TITLE)}function si(e,t,s,n){return(!n||n===N.HTML)&&ti(e,t,s)||(!n||n===N.MATHML)&&ei(e,t)}const ai="hidden",ri=8,ni=3;var _;(function(e){e[e.INITIAL=0]="INITIAL",e[e.BEFORE_HTML=1]="BEFORE_HTML",e[e.BEFORE_HEAD=2]="BEFORE_HEAD",e[e.IN_HEAD=3]="IN_HEAD",e[e.IN_HEAD_NO_SCRIPT=4]="IN_HEAD_NO_SCRIPT",e[e.AFTER_HEAD=5]="AFTER_HEAD",e[e.IN_BODY=6]="IN_BODY",e[e.TEXT=7]="TEXT",e[e.IN_TABLE=8]="IN_TABLE",e[e.IN_TABLE_TEXT=9]="IN_TABLE_TEXT",e[e.IN_CAPTION=10]="IN_CAPTION",e[e.IN_COLUMN_GROUP=11]="IN_COLUMN_GROUP",e[e.IN_TABLE_BODY=12]="IN_TABLE_BODY",e[e.IN_ROW=13]="IN_ROW",e[e.IN_CELL=14]="IN_CELL",e[e.IN_SELECT=15]="IN_SELECT",e[e.IN_SELECT_IN_TABLE=16]="IN_SELECT_IN_TABLE",e[e.IN_TEMPLATE=17]="IN_TEMPLATE",e[e.AFTER_BODY=18]="AFTER_BODY",e[e.IN_FRAMESET=19]="IN_FRAMESET",e[e.AFTER_FRAMESET=20]="AFTER_FRAMESET",e[e.AFTER_AFTER_BODY=21]="AFTER_AFTER_BODY",e[e.AFTER_AFTER_FRAMESET=22]="AFTER_AFTER_FRAMESET"})(_||(_={}));const ii={startLine:-1,startCol:-1,startOffset:-1,endLine:-1,endCol:-1,endOffset:-1},ds=new Set([r.TABLE,r.TBODY,r.TFOOT,r.THEAD,r.TR]),Lt={scriptingEnabled:!0,sourceCodeLocationInfo:!1,treeAdapter:X,onParseError:null};class us{constructor(t,s,n=null,T=null){this.fragmentContext=n,this.scriptHandler=T,this.currentToken=null,this.stopped=!1,this.insertionMode=_.INITIAL,this.originalInsertionMode=_.INITIAL,this.headElement=null,this.formElement=null,this.currentNotInHTML=!1,this.tmplInsertionModeStack=[],this.pendingCharacterTokens=[],this.hasNonWhitespacePendingCharacterToken=!1,this.framesetOk=!0,this.skipNextNewLine=!1,this.fosterParentingEnabled=!1,this.options={...Lt,...t},this.treeAdapter=this.options.treeAdapter,this.onParseError=this.options.onParseError,this.onParseError&&(this.options.sourceCodeLocationInfo=!0),this.document=s??this.treeAdapter.createDocument(),this.tokenizer=new Mn(this.options,this),this.activeFormattingElements=new xn(this.treeAdapter),this.fragmentContextID=n?ke(this.treeAdapter.getTagName(n)):r.UNKNOWN,this._setContextModes(n??this.document,this.fragmentContextID),this.openElements=new yn(this.document,this.treeAdapter,this)}static parse(t,s){const n=new this(s);return n.tokenizer.write(t,!0),n.document}static getFragmentParser(t,s){const n={...Lt,...s};t??(t=n.treeAdapter.createElement(l.TEMPLATE,N.HTML,[]));const T=n.treeAdapter.createElement("documentmock",N.HTML,[]),m=new this(n,T,t);return m.fragmentContextID===r.TEMPLATE&&m.tmplInsertionModeStack.unshift(_.IN_TEMPLATE),m._initTokenizerForFragmentParsing(),m._insertFakeRootElement(),m._resetInsertionMode(),m._findFormInFragmentContext(),m}getFragment(){const t=this.treeAdapter.getFirstChild(this.document),s=this.treeAdapter.createDocumentFragment();return this._adoptNodes(t,s),s}_err(t,s,n){var T;if(!this.onParseError)return;const m=(T=t.location)!==null&&T!==void 0?T:ii,O={code:s,startLine:m.startLine,startCol:m.startCol,startOffset:m.startOffset,endLine:n?m.startLine:m.endLine,endCol:n?m.startCol:m.endCol,endOffset:n?m.startOffset:m.endOffset};this.onParseError(O)}onItemPush(t,s,n){var T,m;(m=(T=this.treeAdapter).onItemPush)===null||m===void 0||m.call(T,t),n&&this.openElements.stackTop>0&&this._setContextModes(t,s)}onItemPop(t,s){var n,T;if(this.options.sourceCodeLocationInfo&&this._setEndLocation(t,this.currentToken),(T=(n=this.treeAdapter).onItemPop)===null||T===void 0||T.call(n,t,this.openElements.current),s){let m,O;this.openElements.stackTop===0&&this.fragmentContext?(m=this.fragmentContext,O=this.fragmentContextID):{current:m,currentTagId:O}=this.openElements,this._setContextModes(m,O)}}_setContextModes(t,s){const n=t===this.document||this.treeAdapter.getNamespaceURI(t)===N.HTML;this.currentNotInHTML=!n,this.tokenizer.inForeignNode=!n&&!this._isIntegrationPoint(s,t)}_switchToTextParsing(t,s){this._insertElement(t,N.HTML),this.tokenizer.state=s,this.originalInsertionMode=this.insertionMode,this.insertionMode=_.TEXT}switchToPlaintextParsing(){this.insertionMode=_.TEXT,this.originalInsertionMode=_.IN_BODY,this.tokenizer.state=F.PLAINTEXT}_getAdjustedCurrentElement(){return this.openElements.stackTop===0&&this.fragmentContext?this.fragmentContext:this.openElements.current}_findFormInFragmentContext(){let t=this.fragmentContext;for(;t;){if(this.treeAdapter.getTagName(t)===l.FORM){this.formElement=t;break}t=this.treeAdapter.getParentNode(t)}}_initTokenizerForFragmentParsing(){if(!(!this.fragmentContext||this.treeAdapter.getNamespaceURI(this.fragmentContext)!==N.HTML))switch(this.fragmentContextID){case r.TITLE:case r.TEXTAREA:{this.tokenizer.state=F.RCDATA;break}case r.STYLE:case r.XMP:case r.IFRAME:case r.NOEMBED:case r.NOFRAMES:case r.NOSCRIPT:{this.tokenizer.state=F.RAWTEXT;break}case r.SCRIPT:{this.tokenizer.state=F.SCRIPT_DATA;break}case r.PLAINTEXT:{this.tokenizer.state=F.PLAINTEXT;break}}}_setDocumentType(t){const s=t.name||"",n=t.publicId||"",T=t.systemId||"";if(this.treeAdapter.setDocumentType(this.document,s,n,T),t.location){const O=this.treeAdapter.getChildNodes(this.document).find(R=>this.treeAdapter.isDocumentTypeNode(R));O&&this.treeAdapter.setNodeSourceCodeLocation(O,t.location)}}_attachElementToTree(t,s){if(this.options.sourceCodeLocationInfo){const n=s&&{...s,startTag:s};this.treeAdapter.setNodeSourceCodeLocation(t,n)}if(this._shouldFosterParentOnInsertion())this._fosterParentElement(t);else{const n=this.openElements.currentTmplContentOrNode;this.treeAdapter.appendChild(n,t)}}_appendElement(t,s){const n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location)}_insertElement(t,s){const n=this.treeAdapter.createElement(t.tagName,s,t.attrs);this._attachElementToTree(n,t.location),this.openElements.push(n,t.tagID)}_insertFakeElement(t,s){const n=this.treeAdapter.createElement(t,N.HTML,[]);this._attachElementToTree(n,null),this.openElements.push(n,s)}_insertTemplate(t){const s=this.treeAdapter.createElement(t.tagName,N.HTML,t.attrs),n=this.treeAdapter.createDocumentFragment();this.treeAdapter.setTemplateContent(s,n),this._attachElementToTree(s,t.location),this.openElements.push(s,t.tagID),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,null)}_insertFakeRootElement(){const t=this.treeAdapter.createElement(l.HTML,N.HTML,[]);this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(t,null),this.treeAdapter.appendChild(this.openElements.current,t),this.openElements.push(t,r.HTML)}_appendCommentNode(t,s){const n=this.treeAdapter.createCommentNode(t.data);this.treeAdapter.appendChild(s,n),this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(n,t.location)}_insertCharacters(t){let s,n;if(this._shouldFosterParentOnInsertion()?({parent:s,beforeElement:n}=this._findFosterParentingLocation(),n?this.treeAdapter.insertTextBefore(s,t.chars,n):this.treeAdapter.insertText(s,t.chars)):(s=this.openElements.currentTmplContentOrNode,this.treeAdapter.insertText(s,t.chars)),!t.location)return;const T=this.treeAdapter.getChildNodes(s),m=n?T.lastIndexOf(n):T.length,O=T[m-1];if(this.treeAdapter.getNodeSourceCodeLocation(O)){const{endLine:D,endCol:U,endOffset:Q}=t.location;this.treeAdapter.updateNodeSourceCodeLocation(O,{endLine:D,endCol:U,endOffset:Q})}else this.options.sourceCodeLocationInfo&&this.treeAdapter.setNodeSourceCodeLocation(O,t.location)}_adoptNodes(t,s){for(let n=this.treeAdapter.getFirstChild(t);n;n=this.treeAdapter.getFirstChild(t))this.treeAdapter.detachNode(n),this.treeAdapter.appendChild(s,n)}_setEndLocation(t,s){if(this.treeAdapter.getNodeSourceCodeLocation(t)&&s.location){const n=s.location,T=this.treeAdapter.getTagName(t),m=s.type===S.END_TAG&&T===s.tagName?{endTag:{...n},endLine:n.endLine,endCol:n.endCol,endOffset:n.endOffset}:{endLine:n.startLine,endCol:n.startCol,endOffset:n.startOffset};this.treeAdapter.updateNodeSourceCodeLocation(t,m)}}shouldProcessStartTagTokenInForeignContent(t){if(!this.currentNotInHTML)return!1;let s,n;return this.openElements.stackTop===0&&this.fragmentContext?(s=this.fragmentContext,n=this.fragmentContextID):{current:s,currentTagId:n}=this.openElements,t.tagID===r.SVG&&this.treeAdapter.getTagName(s)===l.ANNOTATION_XML&&this.treeAdapter.getNamespaceURI(s)===N.MATHML?!1:this.tokenizer.inForeignNode||(t.tagID===r.MGLYPH||t.tagID===r.MALIGNMARK)&&!this._isIntegrationPoint(n,s,N.HTML)}_processToken(t){switch(t.type){case S.CHARACTER:{this.onCharacter(t);break}case S.NULL_CHARACTER:{this.onNullCharacter(t);break}case S.COMMENT:{this.onComment(t);break}case S.DOCTYPE:{this.onDoctype(t);break}case S.START_TAG:{this._processStartTag(t);break}case S.END_TAG:{this.onEndTag(t);break}case S.EOF:{this.onEof(t);break}case S.WHITESPACE_CHARACTER:{this.onWhitespaceCharacter(t);break}}}_isIntegrationPoint(t,s,n){const T=this.treeAdapter.getNamespaceURI(s),m=this.treeAdapter.getAttrList(s);return si(t,T,m,n)}_reconstructActiveFormattingElements(){const t=this.activeFormattingElements.entries.length;if(t){const s=this.activeFormattingElements.entries.findIndex(T=>T.type===v.Marker||this.openElements.contains(T.element)),n=s<0?t-1:s-1;for(let T=n;T>=0;T--){const m=this.activeFormattingElements.entries[T];this._insertElement(m.token,this.treeAdapter.getNamespaceURI(m.element)),m.element=this.openElements.current}}}_closeTableCell(){this.openElements.generateImpliedEndTags(),this.openElements.popUntilTableCellPopped(),this.activeFormattingElements.clearToLastMarker(),this.insertionMode=_.IN_ROW}_closePElement(){this.openElements.generateImpliedEndTagsWithExclusion(r.P),this.openElements.popUntilTagNamePopped(r.P)}_resetInsertionMode(){for(let t=this.openElements.stackTop;t>=0;t--)switch(t===0&&this.fragmentContext?this.fragmentContextID:this.openElements.tagIDs[t]){case r.TR:{this.insertionMode=_.IN_ROW;return}case r.TBODY:case r.THEAD:case r.TFOOT:{this.insertionMode=_.IN_TABLE_BODY;return}case r.CAPTION:{this.insertionMode=_.IN_CAPTION;return}case r.COLGROUP:{this.insertionMode=_.IN_COLUMN_GROUP;return}case r.TABLE:{this.insertionMode=_.IN_TABLE;return}case r.BODY:{this.insertionMode=_.IN_BODY;return}case r.FRAMESET:{this.insertionMode=_.IN_FRAMESET;return}case r.SELECT:{this._resetInsertionModeForSelect(t);return}case r.TEMPLATE:{this.insertionMode=this.tmplInsertionModeStack[0];return}case r.HTML:{this.insertionMode=this.headElement?_.AFTER_HEAD:_.BEFORE_HEAD;return}case r.TD:case r.TH:{if(t>0){this.insertionMode=_.IN_CELL;return}break}case r.HEAD:{if(t>0){this.insertionMode=_.IN_HEAD;return}break}}this.insertionMode=_.IN_BODY}_resetInsertionModeForSelect(t){if(t>0)for(let s=t-1;s>0;s--){const n=this.openElements.tagIDs[s];if(n===r.TEMPLATE)break;if(n===r.TABLE){this.insertionMode=_.IN_SELECT_IN_TABLE;return}}this.insertionMode=_.IN_SELECT}_isElementCausesFosterParenting(t){return ds.has(t)}_shouldFosterParentOnInsertion(){return this.fosterParentingEnabled&&this._isElementCausesFosterParenting(this.openElements.currentTagId)}_findFosterParentingLocation(){for(let t=this.openElements.stackTop;t>=0;t--){const s=this.openElements.items[t];switch(this.openElements.tagIDs[t]){case r.TEMPLATE:{if(this.treeAdapter.getNamespaceURI(s)===N.HTML)return{parent:this.treeAdapter.getTemplateContent(s),beforeElement:null};break}case r.TABLE:{const n=this.treeAdapter.getParentNode(s);return n?{parent:n,beforeElement:s}:{parent:this.openElements.items[t-1],beforeElement:null}}}}return{parent:this.openElements.items[0],beforeElement:null}}_fosterParentElement(t){const s=this._findFosterParentingLocation();s.beforeElement?this.treeAdapter.insertBefore(s.parent,t,s.beforeElement):this.treeAdapter.appendChild(s.parent,t)}_isSpecialElement(t,s){const n=this.treeAdapter.getNamespaceURI(t);return Ln[n].has(s)}onCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){yo(this,t);return}switch(this.insertionMode){case _.INITIAL:{se(this,t);break}case _.BEFORE_HTML:{_e(this,t);break}case _.BEFORE_HEAD:{le(this,t);break}case _.IN_HEAD:{Ae(this,t);break}case _.IN_HEAD_NO_SCRIPT:{me(this,t);break}case _.AFTER_HEAD:{de(this,t);break}case _.IN_BODY:case _.IN_CAPTION:case _.IN_CELL:case _.IN_TEMPLATE:{Ns(this,t);break}case _.TEXT:case _.IN_SELECT:case _.IN_SELECT_IN_TABLE:{this._insertCharacters(t);break}case _.IN_TABLE:case _.IN_TABLE_BODY:case _.IN_ROW:{We(this,t);break}case _.IN_TABLE_TEXT:{Ss(this,t);break}case _.IN_COLUMN_GROUP:{pe(this,t);break}case _.AFTER_BODY:{Me(this,t);break}case _.AFTER_AFTER_BODY:{Se(this,t);break}}}onNullCharacter(t){if(this.skipNextNewLine=!1,this.tokenizer.inForeignNode){ko(this,t);return}switch(this.insertionMode){case _.INITIAL:{se(this,t);break}case _.BEFORE_HTML:{_e(this,t);break}case _.BEFORE_HEAD:{le(this,t);break}case _.IN_HEAD:{Ae(this,t);break}case _.IN_HEAD_NO_SCRIPT:{me(this,t);break}case _.AFTER_HEAD:{de(this,t);break}case _.TEXT:{this._insertCharacters(t);break}case _.IN_TABLE:case _.IN_TABLE_BODY:case _.IN_ROW:{We(this,t);break}case _.IN_COLUMN_GROUP:{pe(this,t);break}case _.AFTER_BODY:{Me(this,t);break}case _.AFTER_AFTER_BODY:{Se(this,t);break}}}onComment(t){if(this.skipNextNewLine=!1,this.currentNotInHTML){ze(this,t);return}switch(this.insertionMode){case _.INITIAL:case _.BEFORE_HTML:case _.BEFORE_HEAD:case _.IN_HEAD:case _.IN_HEAD_NO_SCRIPT:case _.AFTER_HEAD:case _.IN_BODY:case _.IN_TABLE:case _.IN_CAPTION:case _.IN_COLUMN_GROUP:case _.IN_TABLE_BODY:case _.IN_ROW:case _.IN_CELL:case _.IN_SELECT:case _.IN_SELECT_IN_TABLE:case _.IN_TEMPLATE:case _.IN_FRAMESET:case _.AFTER_FRAMESET:{ze(this,t);break}case _.IN_TABLE_TEXT:{ae(this,t);break}case _.AFTER_BODY:{li(this,t);break}case _.AFTER_AFTER_BODY:case _.AFTER_AFTER_FRAMESET:{Ai(this,t);break}}}onDoctype(t){switch(this.skipNextNewLine=!1,this.insertionMode){case _.INITIAL:{mi(this,t);break}case _.BEFORE_HEAD:case _.IN_HEAD:case _.IN_HEAD_NO_SCRIPT:case _.AFTER_HEAD:{this._err(t,u.misplacedDoctype);break}case _.IN_TABLE_TEXT:{ae(this,t);break}}}onStartTag(t){this.skipNextNewLine=!1,this.currentToken=t,this._processStartTag(t),t.selfClosing&&!t.ackSelfClosing&&this._err(t,u.nonVoidHtmlElementStartTagWithTrailingSolidus)}_processStartTag(t){this.shouldProcessStartTagTokenInForeignContent(t)?xo(this,t):this._startTagOutsideForeignContent(t)}_startTagOutsideForeignContent(t){switch(this.insertionMode){case _.INITIAL:{se(this,t);break}case _.BEFORE_HTML:{di(this,t);break}case _.BEFORE_HEAD:{Ci(this,t);break}case _.IN_HEAD:{w(this,t);break}case _.IN_HEAD_NO_SCRIPT:{fi(this,t);break}case _.AFTER_HEAD:{Ri(this,t);break}case _.IN_BODY:{M(this,t);break}case _.IN_TABLE:{Z(this,t);break}case _.IN_TABLE_TEXT:{ae(this,t);break}case _.IN_CAPTION:{Io(this,t);break}case _.IN_COLUMN_GROUP:{rt(this,t);break}case _.IN_TABLE_BODY:{Ye(this,t);break}case _.IN_ROW:{we(this,t);break}case _.IN_CELL:{Ro(this,t);break}case _.IN_SELECT:{Ps(this,t);break}case _.IN_SELECT_IN_TABLE:{So(this,t);break}case _.IN_TEMPLATE:{go(this,t);break}case _.AFTER_BODY:{po(this,t);break}case _.IN_FRAMESET:{Mo(this,t);break}case _.AFTER_FRAMESET:{Bo(this,t);break}case _.AFTER_AFTER_BODY:{Fo(this,t);break}case _.AFTER_AFTER_FRAMESET:{Uo(this,t);break}}}onEndTag(t){this.skipNextNewLine=!1,this.currentToken=t,this.currentNotInHTML?Yo(this,t):this._endTagOutsideForeignContent(t)}_endTagOutsideForeignContent(t){switch(this.insertionMode){case _.INITIAL:{se(this,t);break}case _.BEFORE_HTML:{ui(this,t);break}case _.BEFORE_HEAD:{Ni(this,t);break}case _.IN_HEAD:{Ii(this,t);break}case _.IN_HEAD_NO_SCRIPT:{Oi(this,t);break}case _.AFTER_HEAD:{Li(this,t);break}case _.IN_BODY:{xe(this,t);break}case _.TEXT:{co(this,t);break}case _.IN_TABLE:{Ce(this,t);break}case _.IN_TABLE_TEXT:{ae(this,t);break}case _.IN_CAPTION:{fo(this,t);break}case _.IN_COLUMN_GROUP:{Oo(this,t);break}case _.IN_TABLE_BODY:{qe(this,t);break}case _.IN_ROW:{gs(this,t);break}case _.IN_CELL:{Lo(this,t);break}case _.IN_SELECT:{ps(this,t);break}case _.IN_SELECT_IN_TABLE:{Do(this,t);break}case _.IN_TEMPLATE:{Po(this,t);break}case _.AFTER_BODY:{bs(this,t);break}case _.IN_FRAMESET:{bo(this,t);break}case _.AFTER_FRAMESET:{Ho(this,t);break}case _.AFTER_AFTER_BODY:{Se(this,t);break}}}onEof(t){switch(this.insertionMode){case _.INITIAL:{se(this,t);break}case _.BEFORE_HTML:{_e(this,t);break}case _.BEFORE_HEAD:{le(this,t);break}case _.IN_HEAD:{Ae(this,t);break}case _.IN_HEAD_NO_SCRIPT:{me(this,t);break}case _.AFTER_HEAD:{de(this,t);break}case _.IN_BODY:case _.IN_TABLE:case _.IN_CAPTION:case _.IN_COLUMN_GROUP:case _.IN_TABLE_BODY:case _.IN_ROW:case _.IN_CELL:case _.IN_SELECT:case _.IN_SELECT_IN_TABLE:{Rs(this,t);break}case _.TEXT:{To(this,t);break}case _.IN_TABLE_TEXT:{ae(this,t);break}case _.IN_TEMPLATE:{Ms(this,t);break}case _.AFTER_BODY:case _.IN_FRAMESET:case _.AFTER_FRAMESET:case _.AFTER_AFTER_BODY:case _.AFTER_AFTER_FRAMESET:{at(this,t);break}}}onWhitespaceCharacter(t){if(this.skipNextNewLine&&(this.skipNextNewLine=!1,t.chars.charCodeAt(0)===o.LINE_FEED)){if(t.chars.length===1)return;t.chars=t.chars.substr(1)}if(this.tokenizer.inForeignNode){this._insertCharacters(t);return}switch(this.insertionMode){case _.IN_HEAD:case _.IN_HEAD_NO_SCRIPT:case _.AFTER_HEAD:case _.TEXT:case _.IN_COLUMN_GROUP:case _.IN_SELECT:case _.IN_SELECT_IN_TABLE:case _.IN_FRAMESET:case _.AFTER_FRAMESET:{this._insertCharacters(t);break}case _.IN_BODY:case _.IN_CAPTION:case _.IN_CELL:case _.IN_TEMPLATE:case _.AFTER_BODY:case _.AFTER_AFTER_BODY:case _.AFTER_AFTER_FRAMESET:{Cs(this,t);break}case _.IN_TABLE:case _.IN_TABLE_BODY:case _.IN_ROW:{We(this,t);break}case _.IN_TABLE_TEXT:{Ls(this,t);break}}}}function oi(e,t){let s=e.activeFormattingElements.getElementEntryInScopeWithTagName(t.tagName);return s?e.openElements.contains(s.element)?e.openElements.hasInScope(t.tagID)||(s=null):(e.activeFormattingElements.removeEntry(s),s=null):Os(e,t),s}function Ei(e,t){let s=null,n=e.openElements.stackTop;for(;n>=0;n--){const T=e.openElements.items[n];if(T===t.element)break;e._isSpecialElement(T,e.openElements.tagIDs[n])&&(s=T)}return s||(e.openElements.shortenToLength(n<0?0:n),e.activeFormattingElements.removeEntry(t)),s}function ci(e,t,s){let n=t,T=e.openElements.getCommonAncestor(t);for(let m=0,O=T;O!==s;m++,O=T){T=e.openElements.getCommonAncestor(O);const R=e.activeFormattingElements.getElementEntry(O),D=R&&m>=ni;!R||D?(D&&e.activeFormattingElements.removeEntry(R),e.openElements.remove(O)):(O=Ti(e,R),n===t&&(e.activeFormattingElements.bookmark=R),e.treeAdapter.detachNode(n),e.treeAdapter.appendChild(O,n),n=O)}return n}function Ti(e,t){const s=e.treeAdapter.getNamespaceURI(t.element),n=e.treeAdapter.createElement(t.token.tagName,s,t.token.attrs);return e.openElements.replace(t.element,n),t.element=n,n}function hi(e,t,s){const n=e.treeAdapter.getTagName(t),T=ke(n);if(e._isElementCausesFosterParenting(T))e._fosterParentElement(s);else{const m=e.treeAdapter.getNamespaceURI(t);T===r.TEMPLATE&&m===N.HTML&&(t=e.treeAdapter.getTemplateContent(t)),e.treeAdapter.appendChild(t,s)}}function _i(e,t,s){const n=e.treeAdapter.getNamespaceURI(s.element),{token:T}=s,m=e.treeAdapter.createElement(T.tagName,n,T.attrs);e._adoptNodes(t,m),e.treeAdapter.appendChild(t,m),e.activeFormattingElements.insertElementAfterBookmark(m,T),e.activeFormattingElements.removeEntry(s),e.openElements.remove(s.element),e.openElements.insertAfter(t,m,T.tagID)}function st(e,t){for(let s=0;s<ri;s++){const n=oi(e,t);if(!n)break;const T=Ei(e,n);if(!T)break;e.activeFormattingElements.bookmark=n;const m=ci(e,T,n.element),O=e.openElements.getCommonAncestor(n.element);e.treeAdapter.detachNode(m),O&&hi(e,O,m),_i(e,T,n)}}function ze(e,t){e._appendCommentNode(t,e.openElements.currentTmplContentOrNode)}function li(e,t){e._appendCommentNode(t,e.openElements.items[0])}function Ai(e,t){e._appendCommentNode(t,e.document)}function at(e,t){if(e.stopped=!0,t.location){const s=e.fragmentContext?0:2;for(let n=e.openElements.stackTop;n>=s;n--)e._setEndLocation(e.openElements.items[n],t);if(!e.fragmentContext&&e.openElements.stackTop>=0){const n=e.openElements.items[0],T=e.treeAdapter.getNodeSourceCodeLocation(n);if(T&&!T.endTag&&(e._setEndLocation(n,t),e.openElements.stackTop>=1)){const m=e.openElements.items[1],O=e.treeAdapter.getNodeSourceCodeLocation(m);O&&!O.endTag&&e._setEndLocation(m,t)}}}}function mi(e,t){e._setDocumentType(t);const s=t.forceQuirks?y.QUIRKS:Kn(t);Wn(t)||e._err(t,u.nonConformingDoctype),e.treeAdapter.setDocumentMode(e.document,s),e.insertionMode=_.BEFORE_HTML}function se(e,t){e._err(t,u.missingDoctype,!0),e.treeAdapter.setDocumentMode(e.document,y.QUIRKS),e.insertionMode=_.BEFORE_HTML,e._processToken(t)}function di(e,t){t.tagID===r.HTML?(e._insertElement(t,N.HTML),e.insertionMode=_.BEFORE_HEAD):_e(e,t)}function ui(e,t){const s=t.tagID;(s===r.HTML||s===r.HEAD||s===r.BODY||s===r.BR)&&_e(e,t)}function _e(e,t){e._insertFakeRootElement(),e.insertionMode=_.BEFORE_HEAD,e._processToken(t)}function Ci(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.HEAD:{e._insertElement(t,N.HTML),e.headElement=e.openElements.current,e.insertionMode=_.IN_HEAD;break}default:le(e,t)}}function Ni(e,t){const s=t.tagID;s===r.HEAD||s===r.BODY||s===r.HTML||s===r.BR?le(e,t):e._err(t,u.endTagWithoutMatchingOpenElement)}function le(e,t){e._insertFakeElement(l.HEAD,r.HEAD),e.headElement=e.openElements.current,e.insertionMode=_.IN_HEAD,e._processToken(t)}function w(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:{e._appendElement(t,N.HTML),t.ackSelfClosing=!0;break}case r.TITLE:{e._switchToTextParsing(t,F.RCDATA);break}case r.NOSCRIPT:{e.options.scriptingEnabled?e._switchToTextParsing(t,F.RAWTEXT):(e._insertElement(t,N.HTML),e.insertionMode=_.IN_HEAD_NO_SCRIPT);break}case r.NOFRAMES:case r.STYLE:{e._switchToTextParsing(t,F.RAWTEXT);break}case r.SCRIPT:{e._switchToTextParsing(t,F.SCRIPT_DATA);break}case r.TEMPLATE:{e._insertTemplate(t),e.activeFormattingElements.insertMarker(),e.framesetOk=!1,e.insertionMode=_.IN_TEMPLATE,e.tmplInsertionModeStack.unshift(_.IN_TEMPLATE);break}case r.HEAD:{e._err(t,u.misplacedStartTagForHeadElement);break}default:Ae(e,t)}}function Ii(e,t){switch(t.tagID){case r.HEAD:{e.openElements.pop(),e.insertionMode=_.AFTER_HEAD;break}case r.BODY:case r.BR:case r.HTML:{Ae(e,t);break}case r.TEMPLATE:{J(e,t);break}default:e._err(t,u.endTagWithoutMatchingOpenElement)}}function J(e,t){e.openElements.tmplCount>0?(e.openElements.generateImpliedEndTagsThoroughly(),e.openElements.currentTagId!==r.TEMPLATE&&e._err(t,u.closingOfElementWithOpenChildElements),e.openElements.popUntilTagNamePopped(r.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode()):e._err(t,u.endTagWithoutMatchingOpenElement)}function Ae(e,t){e.openElements.pop(),e.insertionMode=_.AFTER_HEAD,e._processToken(t)}function fi(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.BASEFONT:case r.BGSOUND:case r.HEAD:case r.LINK:case r.META:case r.NOFRAMES:case r.STYLE:{w(e,t);break}case r.NOSCRIPT:{e._err(t,u.nestedNoscriptInHead);break}default:me(e,t)}}function Oi(e,t){switch(t.tagID){case r.NOSCRIPT:{e.openElements.pop(),e.insertionMode=_.IN_HEAD;break}case r.BR:{me(e,t);break}default:e._err(t,u.endTagWithoutMatchingOpenElement)}}function me(e,t){const s=t.type===S.EOF?u.openElementsLeftAfterEof:u.disallowedContentInNoscriptInHead;e._err(t,s),e.openElements.pop(),e.insertionMode=_.IN_HEAD,e._processToken(t)}function Ri(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.BODY:{e._insertElement(t,N.HTML),e.framesetOk=!1,e.insertionMode=_.IN_BODY;break}case r.FRAMESET:{e._insertElement(t,N.HTML),e.insertionMode=_.IN_FRAMESET;break}case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:case r.NOFRAMES:case r.SCRIPT:case r.STYLE:case r.TEMPLATE:case r.TITLE:{e._err(t,u.abandonedHeadElementChild),e.openElements.push(e.headElement,r.HEAD),w(e,t),e.openElements.remove(e.headElement);break}case r.HEAD:{e._err(t,u.misplacedStartTagForHeadElement);break}default:de(e,t)}}function Li(e,t){switch(t.tagID){case r.BODY:case r.HTML:case r.BR:{de(e,t);break}case r.TEMPLATE:{J(e,t);break}default:e._err(t,u.endTagWithoutMatchingOpenElement)}}function de(e,t){e._insertFakeElement(l.BODY,r.BODY),e.insertionMode=_.IN_BODY,ye(e,t)}function ye(e,t){switch(t.type){case S.CHARACTER:{Ns(e,t);break}case S.WHITESPACE_CHARACTER:{Cs(e,t);break}case S.COMMENT:{ze(e,t);break}case S.START_TAG:{M(e,t);break}case S.END_TAG:{xe(e,t);break}case S.EOF:{Rs(e,t);break}}}function Cs(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t)}function Ns(e,t){e._reconstructActiveFormattingElements(),e._insertCharacters(t),e.framesetOk=!1}function Si(e,t){e.openElements.tmplCount===0&&e.treeAdapter.adoptAttributes(e.openElements.items[0],t.attrs)}function Di(e,t){const s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e.openElements.tmplCount===0&&(e.framesetOk=!1,e.treeAdapter.adoptAttributes(s,t.attrs))}function gi(e,t){const s=e.openElements.tryPeekProperlyNestedBodyElement();e.framesetOk&&s&&(e.treeAdapter.detachNode(s),e.openElements.popAllUpToHtmlElement(),e._insertElement(t,N.HTML),e.insertionMode=_.IN_FRAMESET)}function Pi(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,N.HTML)}function pi(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),Ve.has(e.openElements.currentTagId)&&e.openElements.pop(),e._insertElement(t,N.HTML)}function Mi(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,N.HTML),e.skipNextNewLine=!0,e.framesetOk=!1}function bi(e,t){const s=e.openElements.tmplCount>0;(!e.formElement||s)&&(e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,N.HTML),s||(e.formElement=e.openElements.current))}function Bi(e,t){e.framesetOk=!1;const s=t.tagID;for(let n=e.openElements.stackTop;n>=0;n--){const T=e.openElements.tagIDs[n];if(s===r.LI&&T===r.LI||(s===r.DD||s===r.DT)&&(T===r.DD||T===r.DT)){e.openElements.generateImpliedEndTagsWithExclusion(T),e.openElements.popUntilTagNamePopped(T);break}if(T!==r.ADDRESS&&T!==r.DIV&&T!==r.P&&e._isSpecialElement(e.openElements.items[n],T))break}e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,N.HTML)}function Hi(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,N.HTML),e.tokenizer.state=F.PLAINTEXT}function Fi(e,t){e.openElements.hasInScope(r.BUTTON)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.BUTTON)),e._reconstructActiveFormattingElements(),e._insertElement(t,N.HTML),e.framesetOk=!1}function Ui(e,t){const s=e.activeFormattingElements.getElementEntryInScopeWithTagName(l.A);s&&(st(e,t),e.openElements.remove(s.element),e.activeFormattingElements.removeEntry(s)),e._reconstructActiveFormattingElements(),e._insertElement(t,N.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function ki(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,N.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function yi(e,t){e._reconstructActiveFormattingElements(),e.openElements.hasInScope(r.NOBR)&&(st(e,t),e._reconstructActiveFormattingElements()),e._insertElement(t,N.HTML),e.activeFormattingElements.pushElement(e.openElements.current,t)}function xi(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,N.HTML),e.activeFormattingElements.insertMarker(),e.framesetOk=!1}function Yi(e,t){e.treeAdapter.getDocumentMode(e.document)!==y.QUIRKS&&e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._insertElement(t,N.HTML),e.framesetOk=!1,e.insertionMode=_.IN_TABLE}function Is(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,N.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function fs(e){const t=Es(e,z.TYPE);return t!=null&&t.toLowerCase()===ai}function wi(e,t){e._reconstructActiveFormattingElements(),e._appendElement(t,N.HTML),fs(t)||(e.framesetOk=!1),t.ackSelfClosing=!0}function vi(e,t){e._appendElement(t,N.HTML),t.ackSelfClosing=!0}function Qi(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._appendElement(t,N.HTML),e.framesetOk=!1,t.ackSelfClosing=!0}function Xi(e,t){t.tagName=l.IMG,t.tagID=r.IMG,Is(e,t)}function Wi(e,t){e._insertElement(t,N.HTML),e.skipNextNewLine=!0,e.tokenizer.state=F.RCDATA,e.originalInsertionMode=e.insertionMode,e.framesetOk=!1,e.insertionMode=_.TEXT}function Ki(e,t){e.openElements.hasInButtonScope(r.P)&&e._closePElement(),e._reconstructActiveFormattingElements(),e.framesetOk=!1,e._switchToTextParsing(t,F.RAWTEXT)}function Gi(e,t){e.framesetOk=!1,e._switchToTextParsing(t,F.RAWTEXT)}function St(e,t){e._switchToTextParsing(t,F.RAWTEXT)}function $i(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,N.HTML),e.framesetOk=!1,e.insertionMode=e.insertionMode===_.IN_TABLE||e.insertionMode===_.IN_CAPTION||e.insertionMode===_.IN_TABLE_BODY||e.insertionMode===_.IN_ROW||e.insertionMode===_.IN_CELL?_.IN_SELECT_IN_TABLE:_.IN_SELECT}function Vi(e,t){e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e._reconstructActiveFormattingElements(),e._insertElement(t,N.HTML)}function zi(e,t){e.openElements.hasInScope(r.RUBY)&&e.openElements.generateImpliedEndTags(),e._insertElement(t,N.HTML)}function qi(e,t){e.openElements.hasInScope(r.RUBY)&&e.openElements.generateImpliedEndTagsWithExclusion(r.RTC),e._insertElement(t,N.HTML)}function Ji(e,t){e._reconstructActiveFormattingElements(),As(t),tt(t),t.selfClosing?e._appendElement(t,N.MATHML):e._insertElement(t,N.MATHML),t.ackSelfClosing=!0}function ji(e,t){e._reconstructActiveFormattingElements(),ms(t),tt(t),t.selfClosing?e._appendElement(t,N.SVG):e._insertElement(t,N.SVG),t.ackSelfClosing=!0}function Dt(e,t){e._reconstructActiveFormattingElements(),e._insertElement(t,N.HTML)}function M(e,t){switch(t.tagID){case r.I:case r.S:case r.B:case r.U:case r.EM:case r.TT:case r.BIG:case r.CODE:case r.FONT:case r.SMALL:case r.STRIKE:case r.STRONG:{ki(e,t);break}case r.A:{Ui(e,t);break}case r.H1:case r.H2:case r.H3:case r.H4:case r.H5:case r.H6:{pi(e,t);break}case r.P:case r.DL:case r.OL:case r.UL:case r.DIV:case r.DIR:case r.NAV:case r.MAIN:case r.MENU:case r.ASIDE:case r.CENTER:case r.FIGURE:case r.FOOTER:case r.HEADER:case r.HGROUP:case r.DIALOG:case r.DETAILS:case r.ADDRESS:case r.ARTICLE:case r.SEARCH:case r.SECTION:case r.SUMMARY:case r.FIELDSET:case r.BLOCKQUOTE:case r.FIGCAPTION:{Pi(e,t);break}case r.LI:case r.DD:case r.DT:{Bi(e,t);break}case r.BR:case r.IMG:case r.WBR:case r.AREA:case r.EMBED:case r.KEYGEN:{Is(e,t);break}case r.HR:{Qi(e,t);break}case r.RB:case r.RTC:{zi(e,t);break}case r.RT:case r.RP:{qi(e,t);break}case r.PRE:case r.LISTING:{Mi(e,t);break}case r.XMP:{Ki(e,t);break}case r.SVG:{ji(e,t);break}case r.HTML:{Si(e,t);break}case r.BASE:case r.LINK:case r.META:case r.STYLE:case r.TITLE:case r.SCRIPT:case r.BGSOUND:case r.BASEFONT:case r.TEMPLATE:{w(e,t);break}case r.BODY:{Di(e,t);break}case r.FORM:{bi(e,t);break}case r.NOBR:{yi(e,t);break}case r.MATH:{Ji(e,t);break}case r.TABLE:{Yi(e,t);break}case r.INPUT:{wi(e,t);break}case r.PARAM:case r.TRACK:case r.SOURCE:{vi(e,t);break}case r.IMAGE:{Xi(e,t);break}case r.BUTTON:{Fi(e,t);break}case r.APPLET:case r.OBJECT:case r.MARQUEE:{xi(e,t);break}case r.IFRAME:{Gi(e,t);break}case r.SELECT:{$i(e,t);break}case r.OPTION:case r.OPTGROUP:{Vi(e,t);break}case r.NOEMBED:case r.NOFRAMES:{St(e,t);break}case r.FRAMESET:{gi(e,t);break}case r.TEXTAREA:{Wi(e,t);break}case r.NOSCRIPT:{e.options.scriptingEnabled?St(e,t):Dt(e,t);break}case r.PLAINTEXT:{Hi(e,t);break}case r.COL:case r.TH:case r.TD:case r.TR:case r.HEAD:case r.FRAME:case r.TBODY:case r.TFOOT:case r.THEAD:case r.CAPTION:case r.COLGROUP:break;default:Dt(e,t)}}function Zi(e,t){if(e.openElements.hasInScope(r.BODY)&&(e.insertionMode=_.AFTER_BODY,e.options.sourceCodeLocationInfo)){const s=e.openElements.tryPeekProperlyNestedBodyElement();s&&e._setEndLocation(s,t)}}function eo(e,t){e.openElements.hasInScope(r.BODY)&&(e.insertionMode=_.AFTER_BODY,bs(e,t))}function to(e,t){const s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s))}function so(e){const t=e.openElements.tmplCount>0,{formElement:s}=e;t||(e.formElement=null),(s||t)&&e.openElements.hasInScope(r.FORM)&&(e.openElements.generateImpliedEndTags(),t?e.openElements.popUntilTagNamePopped(r.FORM):s&&e.openElements.remove(s))}function ao(e){e.openElements.hasInButtonScope(r.P)||e._insertFakeElement(l.P,r.P),e._closePElement()}function ro(e){e.openElements.hasInListItemScope(r.LI)&&(e.openElements.generateImpliedEndTagsWithExclusion(r.LI),e.openElements.popUntilTagNamePopped(r.LI))}function no(e,t){const s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTagsWithExclusion(s),e.openElements.popUntilTagNamePopped(s))}function io(e){e.openElements.hasNumberedHeaderInScope()&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilNumberedHeaderPopped())}function oo(e,t){const s=t.tagID;e.openElements.hasInScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker())}function Eo(e){e._reconstructActiveFormattingElements(),e._insertFakeElement(l.BR,r.BR),e.openElements.pop(),e.framesetOk=!1}function Os(e,t){const s=t.tagName,n=t.tagID;for(let T=e.openElements.stackTop;T>0;T--){const m=e.openElements.items[T],O=e.openElements.tagIDs[T];if(n===O&&(n!==r.UNKNOWN||e.treeAdapter.getTagName(m)===s)){e.openElements.generateImpliedEndTagsWithExclusion(n),e.openElements.stackTop>=T&&e.openElements.shortenToLength(T);break}if(e._isSpecialElement(m,O))break}}function xe(e,t){switch(t.tagID){case r.A:case r.B:case r.I:case r.S:case r.U:case r.EM:case r.TT:case r.BIG:case r.CODE:case r.FONT:case r.NOBR:case r.SMALL:case r.STRIKE:case r.STRONG:{st(e,t);break}case r.P:{ao(e);break}case r.DL:case r.UL:case r.OL:case r.DIR:case r.DIV:case r.NAV:case r.PRE:case r.MAIN:case r.MENU:case r.ASIDE:case r.BUTTON:case r.CENTER:case r.FIGURE:case r.FOOTER:case r.HEADER:case r.HGROUP:case r.DIALOG:case r.ADDRESS:case r.ARTICLE:case r.DETAILS:case r.SEARCH:case r.SECTION:case r.SUMMARY:case r.LISTING:case r.FIELDSET:case r.BLOCKQUOTE:case r.FIGCAPTION:{to(e,t);break}case r.LI:{ro(e);break}case r.DD:case r.DT:{no(e,t);break}case r.H1:case r.H2:case r.H3:case r.H4:case r.H5:case r.H6:{io(e);break}case r.BR:{Eo(e);break}case r.BODY:{Zi(e,t);break}case r.HTML:{eo(e,t);break}case r.FORM:{so(e);break}case r.APPLET:case r.OBJECT:case r.MARQUEE:{oo(e,t);break}case r.TEMPLATE:{J(e,t);break}default:Os(e,t)}}function Rs(e,t){e.tmplInsertionModeStack.length>0?Ms(e,t):at(e,t)}function co(e,t){var s;t.tagID===r.SCRIPT&&((s=e.scriptHandler)===null||s===void 0||s.call(e,e.openElements.current)),e.openElements.pop(),e.insertionMode=e.originalInsertionMode}function To(e,t){e._err(t,u.eofInElementThatCanContainOnlyText),e.openElements.pop(),e.insertionMode=e.originalInsertionMode,e.onEof(t)}function We(e,t){if(ds.has(e.openElements.currentTagId))switch(e.pendingCharacterTokens.length=0,e.hasNonWhitespacePendingCharacterToken=!1,e.originalInsertionMode=e.insertionMode,e.insertionMode=_.IN_TABLE_TEXT,t.type){case S.CHARACTER:{Ss(e,t);break}case S.WHITESPACE_CHARACTER:{Ls(e,t);break}}else Ie(e,t)}function ho(e,t){e.openElements.clearBackToTableContext(),e.activeFormattingElements.insertMarker(),e._insertElement(t,N.HTML),e.insertionMode=_.IN_CAPTION}function _o(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,N.HTML),e.insertionMode=_.IN_COLUMN_GROUP}function lo(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(l.COLGROUP,r.COLGROUP),e.insertionMode=_.IN_COLUMN_GROUP,rt(e,t)}function Ao(e,t){e.openElements.clearBackToTableContext(),e._insertElement(t,N.HTML),e.insertionMode=_.IN_TABLE_BODY}function mo(e,t){e.openElements.clearBackToTableContext(),e._insertFakeElement(l.TBODY,r.TBODY),e.insertionMode=_.IN_TABLE_BODY,Ye(e,t)}function uo(e,t){e.openElements.hasInTableScope(r.TABLE)&&(e.openElements.popUntilTagNamePopped(r.TABLE),e._resetInsertionMode(),e._processStartTag(t))}function Co(e,t){fs(t)?e._appendElement(t,N.HTML):Ie(e,t),t.ackSelfClosing=!0}function No(e,t){!e.formElement&&e.openElements.tmplCount===0&&(e._insertElement(t,N.HTML),e.formElement=e.openElements.current,e.openElements.pop())}function Z(e,t){switch(t.tagID){case r.TD:case r.TH:case r.TR:{mo(e,t);break}case r.STYLE:case r.SCRIPT:case r.TEMPLATE:{w(e,t);break}case r.COL:{lo(e,t);break}case r.FORM:{No(e,t);break}case r.TABLE:{uo(e,t);break}case r.TBODY:case r.TFOOT:case r.THEAD:{Ao(e,t);break}case r.INPUT:{Co(e,t);break}case r.CAPTION:{ho(e,t);break}case r.COLGROUP:{_o(e,t);break}default:Ie(e,t)}}function Ce(e,t){switch(t.tagID){case r.TABLE:{e.openElements.hasInTableScope(r.TABLE)&&(e.openElements.popUntilTagNamePopped(r.TABLE),e._resetInsertionMode());break}case r.TEMPLATE:{J(e,t);break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TBODY:case r.TD:case r.TFOOT:case r.TH:case r.THEAD:case r.TR:break;default:Ie(e,t)}}function Ie(e,t){const s=e.fosterParentingEnabled;e.fosterParentingEnabled=!0,ye(e,t),e.fosterParentingEnabled=s}function Ls(e,t){e.pendingCharacterTokens.push(t)}function Ss(e,t){e.pendingCharacterTokens.push(t),e.hasNonWhitespacePendingCharacterToken=!0}function ae(e,t){let s=0;if(e.hasNonWhitespacePendingCharacterToken)for(;s<e.pendingCharacterTokens.length;s++)Ie(e,e.pendingCharacterTokens[s]);else for(;s<e.pendingCharacterTokens.length;s++)e._insertCharacters(e.pendingCharacterTokens[s]);e.insertionMode=e.originalInsertionMode,e._processToken(t)}const Ds=new Set([r.CAPTION,r.COL,r.COLGROUP,r.TBODY,r.TD,r.TFOOT,r.TH,r.THEAD,r.TR]);function Io(e,t){const s=t.tagID;Ds.has(s)?e.openElements.hasInTableScope(r.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=_.IN_TABLE,Z(e,t)):M(e,t)}function fo(e,t){const s=t.tagID;switch(s){case r.CAPTION:case r.TABLE:{e.openElements.hasInTableScope(r.CAPTION)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(r.CAPTION),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=_.IN_TABLE,s===r.TABLE&&Ce(e,t));break}case r.BODY:case r.COL:case r.COLGROUP:case r.HTML:case r.TBODY:case r.TD:case r.TFOOT:case r.TH:case r.THEAD:case r.TR:break;default:xe(e,t)}}function rt(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.COL:{e._appendElement(t,N.HTML),t.ackSelfClosing=!0;break}case r.TEMPLATE:{w(e,t);break}default:pe(e,t)}}function Oo(e,t){switch(t.tagID){case r.COLGROUP:{e.openElements.currentTagId===r.COLGROUP&&(e.openElements.pop(),e.insertionMode=_.IN_TABLE);break}case r.TEMPLATE:{J(e,t);break}case r.COL:break;default:pe(e,t)}}function pe(e,t){e.openElements.currentTagId===r.COLGROUP&&(e.openElements.pop(),e.insertionMode=_.IN_TABLE,e._processToken(t))}function Ye(e,t){switch(t.tagID){case r.TR:{e.openElements.clearBackToTableBodyContext(),e._insertElement(t,N.HTML),e.insertionMode=_.IN_ROW;break}case r.TH:case r.TD:{e.openElements.clearBackToTableBodyContext(),e._insertFakeElement(l.TR,r.TR),e.insertionMode=_.IN_ROW,we(e,t);break}case r.CAPTION:case r.COL:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=_.IN_TABLE,Z(e,t));break}default:Z(e,t)}}function qe(e,t){const s=t.tagID;switch(t.tagID){case r.TBODY:case r.TFOOT:case r.THEAD:{e.openElements.hasInTableScope(s)&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=_.IN_TABLE);break}case r.TABLE:{e.openElements.hasTableBodyContextInTableScope()&&(e.openElements.clearBackToTableBodyContext(),e.openElements.pop(),e.insertionMode=_.IN_TABLE,Ce(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TD:case r.TH:case r.TR:break;default:Ce(e,t)}}function we(e,t){switch(t.tagID){case r.TH:case r.TD:{e.openElements.clearBackToTableRowContext(),e._insertElement(t,N.HTML),e.insertionMode=_.IN_CELL,e.activeFormattingElements.insertMarker();break}case r.CAPTION:case r.COL:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:case r.TR:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=_.IN_TABLE_BODY,Ye(e,t));break}default:Z(e,t)}}function gs(e,t){switch(t.tagID){case r.TR:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=_.IN_TABLE_BODY);break}case r.TABLE:{e.openElements.hasInTableScope(r.TR)&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=_.IN_TABLE_BODY,qe(e,t));break}case r.TBODY:case r.TFOOT:case r.THEAD:{(e.openElements.hasInTableScope(t.tagID)||e.openElements.hasInTableScope(r.TR))&&(e.openElements.clearBackToTableRowContext(),e.openElements.pop(),e.insertionMode=_.IN_TABLE_BODY,qe(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:case r.TD:case r.TH:break;default:Ce(e,t)}}function Ro(e,t){const s=t.tagID;Ds.has(s)?(e.openElements.hasInTableScope(r.TD)||e.openElements.hasInTableScope(r.TH))&&(e._closeTableCell(),we(e,t)):M(e,t)}function Lo(e,t){const s=t.tagID;switch(s){case r.TD:case r.TH:{e.openElements.hasInTableScope(s)&&(e.openElements.generateImpliedEndTags(),e.openElements.popUntilTagNamePopped(s),e.activeFormattingElements.clearToLastMarker(),e.insertionMode=_.IN_ROW);break}case r.TABLE:case r.TBODY:case r.TFOOT:case r.THEAD:case r.TR:{e.openElements.hasInTableScope(s)&&(e._closeTableCell(),gs(e,t));break}case r.BODY:case r.CAPTION:case r.COL:case r.COLGROUP:case r.HTML:break;default:xe(e,t)}}function Ps(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.OPTION:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e._insertElement(t,N.HTML);break}case r.OPTGROUP:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop(),e._insertElement(t,N.HTML);break}case r.HR:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop(),e._appendElement(t,N.HTML),t.ackSelfClosing=!0;break}case r.INPUT:case r.KEYGEN:case r.TEXTAREA:case r.SELECT:{e.openElements.hasInSelectScope(r.SELECT)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),t.tagID!==r.SELECT&&e._processStartTag(t));break}case r.SCRIPT:case r.TEMPLATE:{w(e,t);break}}}function ps(e,t){switch(t.tagID){case r.OPTGROUP:{e.openElements.stackTop>0&&e.openElements.currentTagId===r.OPTION&&e.openElements.tagIDs[e.openElements.stackTop-1]===r.OPTGROUP&&e.openElements.pop(),e.openElements.currentTagId===r.OPTGROUP&&e.openElements.pop();break}case r.OPTION:{e.openElements.currentTagId===r.OPTION&&e.openElements.pop();break}case r.SELECT:{e.openElements.hasInSelectScope(r.SELECT)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode());break}case r.TEMPLATE:{J(e,t);break}}}function So(e,t){const s=t.tagID;s===r.CAPTION||s===r.TABLE||s===r.TBODY||s===r.TFOOT||s===r.THEAD||s===r.TR||s===r.TD||s===r.TH?(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),e._processStartTag(t)):Ps(e,t)}function Do(e,t){const s=t.tagID;s===r.CAPTION||s===r.TABLE||s===r.TBODY||s===r.TFOOT||s===r.THEAD||s===r.TR||s===r.TD||s===r.TH?e.openElements.hasInTableScope(s)&&(e.openElements.popUntilTagNamePopped(r.SELECT),e._resetInsertionMode(),e.onEndTag(t)):ps(e,t)}function go(e,t){switch(t.tagID){case r.BASE:case r.BASEFONT:case r.BGSOUND:case r.LINK:case r.META:case r.NOFRAMES:case r.SCRIPT:case r.STYLE:case r.TEMPLATE:case r.TITLE:{w(e,t);break}case r.CAPTION:case r.COLGROUP:case r.TBODY:case r.TFOOT:case r.THEAD:{e.tmplInsertionModeStack[0]=_.IN_TABLE,e.insertionMode=_.IN_TABLE,Z(e,t);break}case r.COL:{e.tmplInsertionModeStack[0]=_.IN_COLUMN_GROUP,e.insertionMode=_.IN_COLUMN_GROUP,rt(e,t);break}case r.TR:{e.tmplInsertionModeStack[0]=_.IN_TABLE_BODY,e.insertionMode=_.IN_TABLE_BODY,Ye(e,t);break}case r.TD:case r.TH:{e.tmplInsertionModeStack[0]=_.IN_ROW,e.insertionMode=_.IN_ROW,we(e,t);break}default:e.tmplInsertionModeStack[0]=_.IN_BODY,e.insertionMode=_.IN_BODY,M(e,t)}}function Po(e,t){t.tagID===r.TEMPLATE&&J(e,t)}function Ms(e,t){e.openElements.tmplCount>0?(e.openElements.popUntilTagNamePopped(r.TEMPLATE),e.activeFormattingElements.clearToLastMarker(),e.tmplInsertionModeStack.shift(),e._resetInsertionMode(),e.onEof(t)):at(e,t)}function po(e,t){t.tagID===r.HTML?M(e,t):Me(e,t)}function bs(e,t){var s;if(t.tagID===r.HTML){if(e.fragmentContext||(e.insertionMode=_.AFTER_AFTER_BODY),e.options.sourceCodeLocationInfo&&e.openElements.tagIDs[0]===r.HTML){e._setEndLocation(e.openElements.items[0],t);const n=e.openElements.items[1];n&&!(!((s=e.treeAdapter.getNodeSourceCodeLocation(n))===null||s===void 0)&&s.endTag)&&e._setEndLocation(n,t)}}else Me(e,t)}function Me(e,t){e.insertionMode=_.IN_BODY,ye(e,t)}function Mo(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.FRAMESET:{e._insertElement(t,N.HTML);break}case r.FRAME:{e._appendElement(t,N.HTML),t.ackSelfClosing=!0;break}case r.NOFRAMES:{w(e,t);break}}}function bo(e,t){t.tagID===r.FRAMESET&&!e.openElements.isRootHtmlElementCurrent()&&(e.openElements.pop(),!e.fragmentContext&&e.openElements.currentTagId!==r.FRAMESET&&(e.insertionMode=_.AFTER_FRAMESET))}function Bo(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.NOFRAMES:{w(e,t);break}}}function Ho(e,t){t.tagID===r.HTML&&(e.insertionMode=_.AFTER_AFTER_FRAMESET)}function Fo(e,t){t.tagID===r.HTML?M(e,t):Se(e,t)}function Se(e,t){e.insertionMode=_.IN_BODY,ye(e,t)}function Uo(e,t){switch(t.tagID){case r.HTML:{M(e,t);break}case r.NOFRAMES:{w(e,t);break}}}function ko(e,t){t.chars=P,e._insertCharacters(t)}function yo(e,t){e._insertCharacters(t),e.framesetOk=!1}function Bs(e){for(;e.treeAdapter.getNamespaceURI(e.openElements.current)!==N.HTML&&!e._isIntegrationPoint(e.openElements.currentTagId,e.openElements.current);)e.openElements.pop()}function xo(e,t){if(jn(t))Bs(e),e._startTagOutsideForeignContent(t);else{const s=e._getAdjustedCurrentElement(),n=e.treeAdapter.getNamespaceURI(s);n===N.MATHML?As(t):n===N.SVG&&(Zn(t),ms(t)),tt(t),t.selfClosing?e._appendElement(t,n):e._insertElement(t,n),t.ackSelfClosing=!0}}function Yo(e,t){if(t.tagID===r.P||t.tagID===r.BR){Bs(e),e._endTagOutsideForeignContent(t);return}for(let s=e.openElements.stackTop;s>0;s--){const n=e.openElements.items[s];if(e.treeAdapter.getNamespaceURI(n)===N.HTML){e._endTagOutsideForeignContent(t);break}const T=e.treeAdapter.getTagName(n);if(T.toLowerCase()===t.tagName){t.tagName=T,e.openElements.shortenToLength(s);break}}}const wo=new Set([l.AREA,l.BASE,l.BASEFONT,l.BGSOUND,l.BR,l.COL,l.EMBED,l.FRAME,l.HR,l.IMG,l.INPUT,l.KEYGEN,l.LINK,l.META,l.PARAM,l.SOURCE,l.TRACK,l.WBR]);function vo(e,t){return t.treeAdapter.isElementNode(e)&&t.treeAdapter.getNamespaceURI(e)===N.HTML&&wo.has(t.treeAdapter.getTagName(e))}const Qo={treeAdapter:X,scriptingEnabled:!0};function rE(e,t){const s={...Qo,...t};return Hs(e,s)}function Xo(e,t){let s="";const n=t.treeAdapter.isElementNode(e)&&t.treeAdapter.getTagName(e)===l.TEMPLATE&&t.treeAdapter.getNamespaceURI(e)===N.HTML?t.treeAdapter.getTemplateContent(e):e,T=t.treeAdapter.getChildNodes(n);if(T)for(const m of T)s+=Hs(m,t);return s}function Hs(e,t){return t.treeAdapter.isElementNode(e)?Wo(e,t):t.treeAdapter.isTextNode(e)?Go(e,t):t.treeAdapter.isCommentNode(e)?$o(e,t):t.treeAdapter.isDocumentTypeNode(e)?Vo(e,t):""}function Wo(e,t){const s=t.treeAdapter.getTagName(e);return`<${s}${Ko(e,t)}>${vo(e,t)?"":`${Xo(e,t)}</${s}>`}`}function Ko(e,{treeAdapter:t}){let s="";for(const n of t.getAttrList(e)){if(s+=" ",n.namespace)switch(n.namespace){case N.XML:{s+=`xml:${n.name}`;break}case N.XMLNS:{n.name!=="xmlns"&&(s+="xmlns:"),s+=n.name;break}case N.XLINK:{s+=`xlink:${n.name}`;break}default:s+=`${n.prefix}:${n.name}`}else s+=n.name;s+=`="${Ys(n.value)}"`}return s}function Go(e,t){const{treeAdapter:s}=t,n=s.getTextNodeContent(e),T=s.getParentNode(e),m=T&&s.isElementNode(T)&&s.getTagName(T);return m&&s.getNamespaceURI(T)===N.HTML&&Dn(m,t.scriptingEnabled)?n:ws(n)}function $o(e,{treeAdapter:t}){return`<!--${t.getCommentNodeContent(e)}-->`}function Vo(e,{treeAdapter:t}){return`<!DOCTYPE ${t.getDocumentTypeNodeName(e)}>`}function nE(e,t){return us.parse(e,t)}function iE(e,t,s){typeof e=="string"&&(s=t,t=e,e=null);const n=us.getFragmentParser(e,s);return n.tokenizer.write(t,!0),n.getFragment()}export{k as D,aE as a,rE as b,nE as c,iE as d,y as e,sE as p,tE as s};
