const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["js/PopCollectionSelectorBo26MlBL.js","js/CreateCollectionC2CAQQ8x.js","js/components.globalSAVxUKYX.js","js/@vueC3Nhqlrl.js","js/vue3-toastifyDll2FbVh.js","assets/vue3-toastify.css","js/@capacitorCjBcbZvA.js","js/bootstrap-vue-nextDnMzdrWQ.js","assets/bootstrap-vue-next.css","assets/components.css","js/TIIconDefaultBACySpee.js","assets/TIIconDefault.css","js/ai_lookup_utilszDX_hcwM.js","assets/CreateCollection.css","js/ItemImageB4O-XpFn.js","assets/PopCollectionSelector.css"])))=>i.map(i=>d[i]);
import{_ as v}from"./@capacitorCjBcbZvA.js";import{a as b,a0 as _,d as w,_ as S}from"./components.globalSAVxUKYX.js";import{d as B,aa as T,j as d,K as m,z as p,k as r,R as u,L as P,m as L,Q as a,s as h,r as k,ac as M,i as c}from"./@vueC3Nhqlrl.js";const R=B({name:"ImportBookmarks",mixins:[b],components:{PopCollectionSelector:T(()=>v(()=>import("./PopCollectionSelectorBo26MlBL.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15])))},data(){return{showLogs:!1,currentlySelectedCollectionId:null,resultMessage:null,logOutput:null,loading:!1,parsedItems:null,rawTree:null,errorMessage:null}},mounted(){},computed:{},methods:{loadFile(e){return[]},loadBookmarkTree(e){console.log("Tree",e);let t=[];for(let l=0;l<e.length;l++){const s=e[l];if(console.log("Element",s),s.url)console.log("URL",s.url),t.push({type:"link",title:s.title,url:s.url});else if(s.children&&s.children.length>0){let o=this.loadBookmarkTree(s.children);const n={type:s.id=="0"?"root":"col",title:s.id=="0"?"root":s.title,children:o};t.push(n)}}return t},async runImport(){this.loading=!0,this.resultMessage="Importing...",this.logOutput=null;const e=await this._importBookmarks(this.currentlySelectedCollectionId,this.parsedItems);this.logOutput=e.join(`
`),this.resultMessage="Import Complete",this.loading=!1,this.RefreshIndexQuick()},async _importBookmarks(e=null,t){let l=[];for(let s=0;s<t.length;s++){const o=t[s];if(o.type=="root")l=l.concat(await this._importBookmarks(e,o.children));else if(o.type=="col")try{const n=await this.createCollection({name:o.title},e);o.internalItemId=n;const i="created collection: "+o.title+" id: "+n;l.push(i),l=l.concat(await this._importBookmarks(n,o.children))}catch(n){const i="Error creating collection: "+o.title+" "+n;l.push(i)}else try{const n=[_(o.url)],i=await this.createItem({name:o.title,url:o.url,type:"link",patterns:n},e);o.internalItemId=i;const g="created item: "+o.title+" id: "+i;l.push(g)}catch(n){const i="Error creating item: "+o.title+" "+n;l.push(i)}}return l},async createCollection(e,t=null){return(await this.apiReq("/client/collection/create",{data:{name:e.name,visibility:"private"},collectionIds:t?[t]:null})).result},async createItem(e,t=null){return(await this.apiReq("/client/item/save",{details:e,collectionIds:t?[t]:null},{skipMetaFetch:!0})).result},loadPage(){if(this.isExtension){if(!chrome.bookmarks){this.resultMessage="This feature is only available in the Chrome browser.";return}chrome.bookmarks.getTree().then(e=>{w("Bookmarks",e),this.rawTree=e,this.parsedItems=this.loadBookmarkTree(e)})}}},created(){this.loadPage()}}),E={class:"my-3"},O={class:"my-2"},D={class:"my-2"},V={key:0},N={class:"mt-3"},$={key:0,class:"my-4 alert alert-info"},z={key:0,class:"my-5"},F={key:0,class:"my-2"};function j(e,t,l,s,o,n){const i=k("PopCollectionSelector"),g=k("b-modal"),y=k("b-button"),I=k("b-link"),C=M("b-modal");return c(),d("div",null,[m(g,{id:"select-collection-modal",size:"lg",title:"Select Collection"},{default:p(()=>[m(i,{hideFooterButtons:!0,collectionIdToLoad:e.currentlySelectedCollectionId,onChange:t[0]||(t[0]=f=>e.currentlySelectedCollectionId=f),onClear:t[1]||(t[1]=f=>e.currentlySelectedCollectionId=void 0)},null,8,["collectionIdToLoad"])]),_:1}),r("div",E,[r("div",null,[r("div",O,u(e.currentlySelectedCollectionId?"Parent Collection Selected":"No Parent Collection Selected (will import into top of library)"),1),P((c(),L(y,{variant:"outline-primary"},{default:p(()=>t[2]||(t[2]=[a(" Select Collection")])),_:1})),[[C,void 0,void 0,{"select-collection-modal":!0}]]),t[3]||(t[3]=r("div",{class:"text-muted small mt-1"}," Select a collection to import the bookmarks into. If no collection is selected, the bookmarks will be imported into the top of your library. ",-1))]),r("div",null,[m(y,{disabled:!e.parsedItems||e.loading,class:"mt-5",size:"lg",variant:"primary",onClick:e.runImport},{default:p(()=>t[4]||(t[4]=[a("Run Import")])),_:1},8,["disabled","onClick"])]),r("div",D,[e.showLogs?(c(),d("div",V,[a(" currentlySelectedCollectionId: "+u(e.currentlySelectedCollectionId)+" ",1),r("div",N,[t[5]||(t[5]=a(" Raw Bookmark data ")),r("pre",null,u(e.rawTree),1)])])):h("",!0)])]),e.resultMessage?(c(),d("div",$,[a(u(e.resultMessage)+" ",1),e.logOutput?(c(),d("div",z,[e.currentlySelectedCollectionId?(c(),d("div",F,[m(I,{to:"/collection/"+e.currentlySelectedCollectionId},{default:p(()=>t[6]||(t[6]=[a("View Parent Collection")])),_:1},8,["to"])])):h("",!0),t[7]||(t[7]=a(" Log Output: ")),t[8]||(t[8]=r("br",null,null,-1)),r("pre",null,u(e.logOutput),1)])):h("",!0)])):h("",!0)])}const K=S(R,[["render",j]]);export{K as I};
