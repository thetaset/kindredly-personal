import{a as I,J as $,_ as E}from"./components.globalBic2x0kT.js";import{P as V}from"./PublicProfileEditD4B_jFiw.js";import{P as C}from"./PublishedItemDetailspd3pIi4_.js";import{d as F,r as a,i as l,j as n,k as r,m as c,z as s,K as o,Q as f,R as p,s as i,F as M,P as N}from"./@vueC3Nhqlrl.js";import"./vue3-toastifyDll2FbVh.js";import"./@capacitorCjBcbZvA.js";import"./bootstrap-vue-nextDnMzdrWQ.js";import"./AddPublishedToLibraryA9thKyFu.js";import"./PopCollectionSelectorCwff-9C9.js";import"./CreateCollectionDxlS16jr.js";import"./TIIconDefaultCMdnLD-P.js";import"./ai_lookup_utilszDX_hcwM.js";import"./ItemImagelPteIRA_.js";import"./SelectAccountUsersBAeUorit.js";const z=F({name:"ReviewsForItem",mixins:[I],components:{PublishedItemDetails:C,PublicProfileEdit:V},data(){return{item:void 0,accessDenied:!0,overallRating:null,comment:null,results:[],loadAmount:15,itemId:void 0,easyId:void 0,loading:!1,errorMessage:null,currentPage:0,perPage:12,totalRows:null}},mounted(){},computed:{outputResults(){return this.results.length==0?[]:this.results.slice(0,this.loadAmount)}},methods:{async loadReviews(e=!1){const t=await this.sendReq("/review/listForItem",{publishId:this.itemId,pageInfo:{currentPage:this.currentPage,perPage:this.perPage,includeTotalRows:e}});if(t.success&&t.result){const{records:h,count:v}=t.result;this.results=h,e&&(this.totalRows=t.result.count)}else console.error("Error:",t),this.loading=!1,this.errorMessage="Error loading reviews"},async loadPublished(){const e=await this.sendReq("/published/view",{itemId:this.itemId});e.success&&e.result?(this.item=$(e.result.info),this.loading=!1):(console.error("Error:",e),this.loading=!1)},async load(){await this.loadPublicProfile(),await this.loadPublished(),await this.loadReviews(!0)}},created(){this.isAdminUser?(this.itemId=this.$route.params.itemId,this.load()):(this.showToast("You are not authorized to view this page.  Redirecting to home"),this.$router.push("/"))}}),A={key:0,class:"card"},B={class:"p-2"},D={class:"h4"},T={class:"small text-muted"},U={key:0,class:"mt-4 alert alert-danger"},q={key:0},L={key:1},j={key:2,class:"text-center mt-4 pb-4"};function J(e,t,h,v,K,Q){const d=a("b-col"),m=a("b-row"),g=a("router-link"),b=a("TruncateExpand"),_=a("b-container"),P=a("b-rating"),R=a("b-pagination"),k=a("b-icon"),y=a("b-button");return l(),n("div",null,[r("div",null,[e.item?(l(),c(_,{key:0},{default:s(()=>[o(m,{class:"row"},{default:s(()=>[o(d,{class:"col"},{default:s(()=>t[2]||(t[2]=[r("div",{class:"my-4"},[r("h3",null," Reviews")],-1)])),_:1})]),_:1}),o(m,{class:"row"},{default:s(()=>[o(d,{class:"col"},{default:s(()=>[e.item?(l(),n("div",A,[r("div",B,[r("div",D,[o(g,{to:`/v/${e.itemId}`},{default:s(()=>[f(p(e.item.name),1)]),_:1},8,["to"])]),r("div",T,[o(b,{content:e.item.description,class:"wwrap"},{default:s(()=>t[3]||(t[3]=[r("span",{class:"linklike ms-1",role:"button"},"more",-1)])),_:1},8,["content"])])])])):i("",!0)]),_:1})]),_:1}),o(m,{class:"row"},{default:s(()=>[o(d,{class:"col"},{default:s(()=>[e.errorMessage?(l(),n("div",U,p(e.errorMessage),1)):i("",!0)]),_:1})]),_:1})]),_:1})):i("",!0)]),e.loading?i("",!0):(l(),c(_,{key:0,class:"mt-5"},{default:s(()=>[o(m,{class:"row"},{default:s(()=>[o(d,{class:"col"},{default:s(()=>t[4]||(t[4]=[r("div",{class:"h5"},null,-1)])),_:1})]),_:1}),(l(!0),n(M,null,N(e.outputResults,(u,w)=>(l(),n("div",{key:w},[o(m,{class:"row"},{default:s(()=>[o(d,{class:"col"},{default:s(()=>[r("div",null,[o(g,{to:`/profile/${u.publicUserId}`},{default:s(()=>[f(p(u.username),1)]),_:2},1032,["to"]),r("div",null,[o(P,{class:"ps-0 pe-1","no-border":"",readonly:"",size:"sm",inline:"",value:u.overallRating},null,8,["value"])]),r("p",null,p(u.comment),1)])]),_:2},1024)]),_:2},1024),w!=e.outputResults.length-1?(l(),n("hr",q)):i("",!0)]))),128)),e.totalRows&&e.totalRows>e.perPage?(l(),c(R,{key:0,modelValue:e.currentPage,"onUpdate:modelValue":t[0]||(t[0]=u=>e.currentPage=u),"total-rows":e.totalRows,"per-page":e.perPage,class:"my-2"},null,8,["modelValue","total-rows","per-page"])):i("",!0),e.results.length==0?(l(),n("div",L,t[5]||(t[5]=[r("div",{class:"small text-center"}," No items found. ",-1)]))):i("",!0),e.results&&e.outputResults.length<e.results.length?(l(),n("div",j,[o(y,{variant:"primary",size:"sm",onClick:t[1]||(t[1]=u=>e.loadAmount+=10)},{default:s(()=>[o(k,{icon:"arrow-down"}),t[6]||(t[6]=f(" Load More "))]),_:1})])):i("",!0)]),_:1}))])}const le=E(z,[["render",J]]);export{le as default};
