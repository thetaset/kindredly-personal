import{I as k}from"./ImportDataBflKE2tr.js";import w from"./VersionInfoBoQVATYo.js";import{a as E,o as h,_ as T}from"./components.global5n24RCIC.js";import{d as x,j as m,K as n,z as s,k as o,R as u,s as y,L as b,m as D,r as d,ac as I,i as c,ab as M,Q as l}from"./@vueC3Nhqlrl.js";import"./vue3-toastifyDll2FbVh.js";import"./@capacitorCjBcbZvA.js";import"./bootstrap-vue-nextDnMzdrWQ.js";const S=x({name:"ManageAccount",mixins:[E],components:{ImportData:k,VersionInfo:w},data(){return{options:null,accountStats:null,deleteAccountConfirmation:null,errorMessage:null}},mounted(){},computed:{},methods:{prettyFilesize(e){return e<1e3?e+" B":e<1e6?(e/1e3).toFixed(2)+" KB":e<1e9?(e/1e6).toFixed(2)+" MB":(e/1e9).toFixed(2)+" GB"},loadData(){this.RefreshAccountInfo(!0,!0),this.sendReq("/account/stats").then(e=>{e.success?(this.accountStats=e.result,this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message)})},showAccountId(){this.confirmModal(this.account._id,{title:"Account Id",okVariant:"primary",okTitle:"Done",cancelTitle:"Cancel"},!0)},download(e,t){var i=document.createElement("a");i.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(t)),i.setAttribute("download",e),i.style.display="none",document.body.appendChild(i),i.click(),document.body.removeChild(i)},accountExport(){this.sendReq("/account/export").then(e=>{e.success?(this.download("export.json",JSON.stringify(e.result,null,2)),this.errorMessage=null):(console.error("Error:",e.message),this.errorMessage=e.message)})},async getToken(){const e=await this.sendReq("/authInfo");return e.success?e.result.token:null},async deleteAccount(){if(this.deleteAccountConfirmation!=="DELETE"){this.showToast("Please type 'DELETE' to confirm",{title:"Error",variant:"danger",solid:!0});return}try{const e=await this.apiReq("/account/delete",{confirmation:this.deleteAccountConfirmation});if(e.success)this.showToast("Account deleted",{title:"Success",variant:"success",solid:!0}),await this.LogOut(!0),this.$router.push("/");else throw new Error(e.message)}catch(e){this.showToast("Error deleting account:"+e.message,{title:"Error",variant:"danger",solid:!0})}},async changePlan(){if(this.isBrowserMode){let e=`${this.config.serverHostname}/support`;window.document.location=e}else{const e=await this.getToken();let t=e?`${this.config.serverHostname}/auth/tokenLoginRequest?token=${e}&target=/support`:this.config.serverHostname;await h(t,"_blank")}}},created(){this.loadData()}}),$={class:"alert alert-danger"},B={class:"mt-4 d-flex justify-content-between"},L={class:"container-fluid-max1200"},V={class:"mt-3 mb-2"},R={key:0,class:""},U={class:"d-flex flex-gap-1 flex-wrap"},q={key:0},N={class:"d-flex flex-gap-1 mt-4"},P={class:"mt-4"};function j(e,t,i,F,H,O){var g;const A=d("VersionInfo"),f=d("b-modal"),p=d("b-icon"),a=d("b-button"),v=d("b-link"),C=I("b-modal");return c(),m("div",null,[n(f,{lazy:"true",id:"version-info-modal",title:"Version Info","ok-only":"","no-close-on-backdrop":"","no-close-on-esc":""},{default:s(()=>[n(A)]),_:1}),n(f,{lazy:"true",size:"lg",id:"delete-account-modal",title:"Delete Account","hide-footer":""},{default:s(()=>[o("div",$,[n(p,{icon:"exclamation-triangle"}),t[6]||(t[6]=o("b",null,"Warning:",-1)),t[7]||(t[7]=o("div",null,"You are about to delete your account and all users within it.",-1)),t[8]||(t[8]=o("div",{class:"mt-2"},[o("b",null,"This will delete all collections and items within your account. This cannot be undone.")],-1))]),b(o("input",{type:"text",class:"form-control","onUpdate:modelValue":t[0]||(t[0]=r=>e.deleteAccountConfirmation=r),placeholder:"Type 'DELETE' to confirm"},null,512),[[M,e.deleteAccountConfirmation]]),o("div",B,[n(a,{variant:"secondary",onClick:t[1]||(t[1]=r=>e.closeModal("delete-account-modal"))},{default:s(()=>t[9]||(t[9]=[l("Cancel")])),_:1}),n(a,{"data-test-id":"deleteAccountConfirmButton",variant:"danger",onClick:t[2]||(t[2]=r=>e.deleteAccount())},{default:s(()=>t[10]||(t[10]=[l("Delete Account")])),_:1})])]),_:1}),o("div",L,[t[22]||(t[22]=o("h2",{class:"my-3"},"Account Settings",-1)),o("div",V,[t[11]||(t[11]=o("div",{class:"text-muted"},"Account Plan",-1)),o("div",null,u((g=e.account)==null?void 0:g.accountType),1)]),e.accountStats?(c(),m("div",R,[o("div",null,[t[12]||(t[12]=o("div",{class:"text-muted mt-2"},"Created",-1)),o("div",null,u(e.accountStats.createdAt),1)]),o("div",null,[t[13]||(t[13]=o("div",{class:"text-muted mt-2"}," Users",-1)),o("div",null,u(e.accountStats.userCount),1)]),o("div",null,[t[14]||(t[14]=o("div",{class:"text-muted mt-2"}," Collections",-1)),o("div",null,u(e.accountStats.collectionCount),1)])])):y("",!0),t[23]||(t[23]=o("hr",null,null,-1)),t[24]||(t[24]=o("div",{class:"mt-3"},[o("div",{class:"larger mb-1"},"Account Limits"),o("div",null,"Collections: *"),o("div",null,"Items: *"),o("div",null,"Storage: *"),o("div",{class:"my-2 text-muted"},"* Limits are not established yet.")],-1)),t[25]||(t[25]=o("hr",null,null,-1)),o("div",U,[o("div",null,[n(a,{variant:"outline-primary",class:"",to:"/settings/manageusers"},{default:s(()=>[n(p,{icon:"people"}),t[15]||(t[15]=l(" Users "))]),_:1})]),o("div",null,[b((c(),D(a,{variant:"outline-primary"},{default:s(()=>t[16]||(t[16]=[l(" Version Details ")])),_:1})),[[C,void 0,void 0,{"version-info-modal":!0}]])]),o("div",null,[n(a,{variant:"outline-primary",class:"",onClick:t[3]||(t[3]=r=>e.showAccountId())},{default:s(()=>t[17]||(t[17]=[l(" Account Id ")])),_:1})]),e.config.distMarketplace!="apple"?(c(),m("div",q,[n(a,{variant:"outline-primary",class:"",onClick:t[4]||(t[4]=r=>e.changePlan())},{default:s(()=>t[18]||(t[18]=[l(" Change Plan ")])),_:1})])):y("",!0),o("div",null,[n(v,{class:"btn btn-outline-primary",to:"/settings/spaceUsage"},{default:s(()=>t[19]||(t[19]=[l(" Cloud Storage ")])),_:1})])]),o("div",N,[n(v,{class:"btn btn-outline-primary",to:"/setup/account"},{default:s(()=>t[20]||(t[20]=[l("Open Account Setup Guide ")])),_:1})]),o("div",P,[n(a,{"data-test-id":"deleteAccountButton",variant:"danger",onClick:t[5]||(t[5]=r=>{e.deleteAccountConfirmation=null,e.showModal("delete-account-modal")})},{default:s(()=>t[21]||(t[21]=[l(" Delete Account ")])),_:1})])])])}const Z=T(S,[["render",j]]);export{Z as default};
