import{a as u,az as b,_ as m}from"./components.globalSAVxUKYX.js";import{d as h,j as o,k as a,p as n,K as f,m as d,s as r,F as p,P as v,Q as k,N as R,r as y,i as t}from"./@vueC3Nhqlrl.js";const L=h({name:"TIFeedbackInfo",mixins:[u],emits:["newItemFeedback","input"],components:{},props:{value:{type:Object,required:!1},newItem:{type:Boolean,default:!1},class:{type:String,default:""},mainIconClass:{type:String,default:"text-muted-extra"},outerClass:{type:String,default:""},shiftLeft:{type:Boolean,default:!1}},data(){return{compId:this.$.uid,reactionOptions:b,showOptions:!1,item:null,feedback:{isLiked:!1,isReadLater:!1,isRead:!1,isArchived:!1,isStarred:!1,reaction:null},errorMessage:""}},computed:{currentReaction(){return!this.feedback||!this.feedback.reaction?null:this.reactionOptions.find(e=>e.value==this.feedback.reaction)},noFeedback(){return!this.feedback||!this.feedback.isRead&&!this.feedback.isReadLater&&!this.feedback.reaction&&!this.feedback.isStarred}},mounted(){document.addEventListener("click",this.deselectMenu)},beforeUnmount(){document.removeEventListener("click",this.deselectMenu)},methods:{toggleShow(){this.showOptions=!this.showOptions},deselectMenu(e){this.item&&(e.target.closest(`#reactionContainer${this.compId}`)||(this.showOptions=!1))},async loadInfo(){var e;(e=this.item)!=null&&e.feedback?(this.feedback.isReadLater=this.item.feedback.isReadLaterDate!=null,this.feedback.isRead=this.item.feedback.isReadDate!=null,this.feedback.isArchived=this.item.feedback.archivedDate!=null,this.feedback.reaction=this.item.feedback.reaction,this.feedback.isStarred=this.item.feedback.starredDate!=null):(this.feedback.isReadLater=!1,this.feedback.isRead=!1,this.feedback.reaction=null,this.feedback.isStarred=!1,this.feedback.isArchived=!1)},async updateFeedbackValue(e,s){if(this.feedback[e]=s,this.newItem){this.$emit("newItemFeedback",{attr:e,value:s});return}const c=await this.sendReq("/item/feedback/value/update",{itemId:this.item._id,attr:e,value:s});if(c.success)this.item.feedback=c.result,this.$emit("input",this.item),this.RefreshIndexQuick();else{this.errorMessage=c.message,console.error(this.errorMessage);return}}},created(){this.item=this.value,this.loadInfo()}}),w=["id"],I={key:1,class:"d-flex flex-gap-sm"},C={class:""},$={class:"d-flex justify-content-around"},S=["title","onClick"],g=["title"],F=["title"],O=["title"];function M(e,s,c,V,B,D){const i=y("b-icon");return e.newItem||e.item&&e.feedback?(t(),o("div",{key:0,class:n(["",e.outerClass]),role:"button",onClick:s[3]||(s[3]=R(l=>e.toggleShow(),["prevent","stop"]))},[a("div",{id:`reactionContainer${e.compId}`,class:n(["reactionContainer",e.class])},[a("div",null,[e.noFeedback?(t(),o("div",{key:0,class:n(["bi-stacked-icons xsmall",e.mainIconClass])},[f(i,{icon:"heart"}),f(i,{icon:"plus",style:{display:"absolute",left:"9px",bottom:"-8px"}})],2)):(t(),o("div",I,[e.currentReaction?(t(),d(i,{key:0,title:e.currentReaction.title,icon:`${e.currentReaction.icon}-fill`,class:n(["fb-link-filled",e.currentReaction.classes])},null,8,["title","icon","class"])):r("",!0),e.feedback.isRead?(t(),d(i,{key:1,title:"completed/read",icon:"check-square-fill",class:"fb-link-filled"})):r("",!0),e.feedback.isReadLater?(t(),d(i,{key:2,title:"read later",icon:"book-fill",class:"fb-link-filled"})):r("",!0),e.feedback.isStarred?(t(),d(i,{key:3,title:"starred",icon:"star-fill",class:"fb-link-filled yellow-color"})):r("",!0)]))]),e.showOptions?(t(),o("div",{key:0,class:n(["reactionOptions border",e.shiftLeft?"shiftLeft":""])},[a("div",C,[s[9]||(s[9]=a("div",{class:"text-muted xsmall mt-2 mb-1"}," Shared ",-1)),a("div",$,[(t(!0),o(p,null,v(e.reactionOptions,l=>(t(),o("div",{key:l.value,role:"button",title:l.title,onClick:q=>e.updateFeedbackValue("reaction",e.feedback.reaction==l.value?null:l.value),class:"hoverrow fb-link py-1 px-2 d-flex flex-gap-sm justify-content-between"},[a("div",null,[e.feedback.reaction!=l.value?(t(),d(i,{key:0,class:n(l.classes),icon:`${l.icon}`},null,8,["class","icon"])):(t(),d(i,{key:1,icon:`${l.icon}-fill`,class:n(l.classes)},null,8,["icon","class"]))])],8,S))),128))]),s[10]||(s[10]=a("hr",{class:"my-1"},null,-1)),s[11]||(s[11]=a("div",{class:"text-muted xsmall mt-2 mb-1"}," Private ",-1)),a("div",null,[a("div",{role:"button",title:e.feedback.isStarred?"Remove from Read Later":"Add to Read Later",onClick:s[0]||(s[0]=l=>e.updateFeedbackValue("isStarred",!e.feedback.isStarred)),class:"hoverrow fb-link py-1 px-2"},[e.feedback.isStarred?(t(),d(i,{key:1,icon:"star-fill",class:"yellow-color"})):(t(),d(i,{key:0,icon:"star",class:"yellow-color"})),s[4]||(s[4]=k()),s[5]||(s[5]=a("span",{class:"small ms-1"},"Star",-1))],8,g)]),a("div",null,[a("div",{role:"button",class:n([{active:e.feedback.isReadLater},"hoverrow fb-link py-1 px-2"]),title:e.feedback.isReadLater?"Remove from Read Later":"Add to Read Later",onClick:s[1]||(s[1]=l=>e.updateFeedbackValue("isReadLater",!e.feedback.isReadLater))},[e.feedback.isReadLater?(t(),d(i,{key:1,icon:"book-fill"})):(t(),d(i,{key:0,icon:"book"})),s[6]||(s[6]=k()),s[7]||(s[7]=a("span",{class:"small ms-1"}," Read Later",-1))],10,F)]),a("div",null,[a("div",{role:"button",class:n([{active:e.feedback.isRead},"hoverrow fb-link py-1 px-2"]),title:e.feedback.isRead?"Mark as Unread/Incomplete":"Mark as Read/Complete",onClick:s[2]||(s[2]=l=>e.updateFeedbackValue("isRead",!e.feedback.isRead))},[e.feedback.isRead?(t(),d(i,{key:1,icon:"check-square-fill"})):(t(),d(i,{key:0,icon:"check-square",class:"text-muted-extra2"})),s[8]||(s[8]=a("span",{class:"small ms-1"}," Done / Read",-1))],10,O)])])],2)):r("",!0)],10,w)],2)):r("",!0)}const j=m(L,[["render",M]]);export{j as T};
