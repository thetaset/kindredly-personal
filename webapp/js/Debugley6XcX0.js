import{I as T}from"./IDBStoreobYAVGyT.js";import{aq as v,_ as C}from"./components.globalSAVxUKYX.js";import{d as I,j as b,K as s,z as l,s as w,r as u,i as y,k as n,Q as a,R as o,L as h,ab as S}from"./@vueC3Nhqlrl.js";import"./vue3-toastifyDll2FbVh.js";import"./@capacitorCjBcbZvA.js";import"./bootstrap-vue-nextDnMzdrWQ.js";const k=I({name:"TestPage",mixins:[v],data(){return{path:"/user/debug",data:null,logOutput:"",loading:!1,clientDebugInfo:null,currentTabs:null,output:null,url:null,userSystemTestResult:null,errorMessage:null,storageInfo:null}},mounted(){},computed:{},methods:{parsedData(){try{return JSON.parse(this.data)}catch(e){return console.error(e),null}},async runIDBTest(){await(await T.getInstance("testStore")).put({id:1,name:"test"})},async getCurrentTabs(){let e={active:!0};this.currentTabs=await chrome.tabs.query(e)},async loadStorageInfo(){this.storageInfo=await navigator.storage.estimate()},async getMetaData(){this.url=this.url.trim(),this.url.startsWith("http")||(this.url="https://"+this.url);const e=await this.sendReq("/client/fetchMetadata",{url:this.url,force:!0});this.output=e.result},async getChanges(){const e=this.data?this.parsedData():null,t=await this.sendReq(this.path,e);t.success?(this.logOutput=t.result,this.loading=!1):(console.error("Error:",t.message),this.errorMessage=t.message,this.loading=!1)},async loadClientDebug(){const e=await this.sendReq("/client/debugInfo",{});this.clientDebugInfo=e.result,this.loadStorageInfo()},async runUserSystemTest(){const e=await this.sendReq("/user/debug/statusCheck",{});e.success?this.userSystemTestResult=e.result:this.errorMessage=e.message},async run(){this.loading=!0;const e=this.data?this.parsedData():null,t=await this.sendReq(this.path,e);t.success?(this.logOutput=t.result,this.loading=!1):(console.error("Error:",t.message),this.errorMessage=t.message,this.loading=!1)}},created(){this.loadClientDebug()}}),M={class:"my-2"},R={key:0,class:"mt-3"};function V(e,t,B,q,j,O){const f=u("b-col"),p=u("b-row"),r=u("b-container"),d=u("b-tab"),m=u("b-button"),g=u("BFormInput"),c=u("b-tabs"),D=u("b-alert");return y(),b("div",null,[s(r,{class:"container"},{default:l(()=>[s(p,{class:"row"},{default:l(()=>[s(f,{class:"col"},{default:l(()=>t[5]||(t[5]=[n("h1",null,"Debug",-1)])),_:1})]),_:1}),t[20]||(t[20]=n("div",{class:"mb-3"},null,-1)),s(p,{class:"row"},{default:l(()=>[s(f,{class:"col"},{default:l(()=>[s(c,{"content-class":"mt-3"},{default:l(()=>[s(d,{title:"Info",active:""},{default:l(()=>[n("div",null,[s(r,{class:"mt-5 justify-content-center"},{default:l(()=>[t[6]||(t[6]=a(" clientDebugInfo ")),t[7]||(t[7]=n("br",null,null,-1)),n("pre",null,o(e.clientDebugInfo),1),n("pre",null,"                                        "+o(e.storageInfo)+`
                                    `,1)]),_:1})])]),_:1}),s(d,{title:"Tests"},{default:l(()=>[n("div",null,[s(r,{class:"mt-5 justify-content-center"},{default:l(()=>[t[9]||(t[9]=a(" Current Tabs ")),s(m,{onClick:e.getCurrentTabs},{default:l(()=>t[8]||(t[8]=[a("Get Current Tabs")])),_:1},8,["onClick"]),n("pre",null,o(e.currentTabs),1)]),_:1})])]),_:1}),s(d,{title:"TestIDB"},{default:l(()=>[n("div",null,[s(r,{class:"mt-5 justify-content-center"},{default:l(()=>[t[11]||(t[11]=a(" Run IDB test ")),s(m,{onClick:e.runIDBTest},{default:l(()=>t[10]||(t[10]=[a("Get Current Tabs")])),_:1},8,["onClick"]),n("pre",null,o(e.output),1)]),_:1})])]),_:1}),s(d,{title:"MetaData Test"},{default:l(()=>[n("div",null,[s(r,{class:"mt-5 justify-content-center"},{default:l(()=>[t[13]||(t[13]=a(" Get Metadata ")),s(g,{modelValue:e.url,"onUpdate:modelValue":t[0]||(t[0]=i=>e.url=i),class:"my-2"},null,8,["modelValue"]),s(m,{onClick:t[1]||(t[1]=i=>e.getMetaData())},{default:l(()=>t[12]||(t[12]=[a("Go")])),_:1}),n("pre",null,o(e.output),1)]),_:1})])]),_:1}),s(d,{title:"UserSystem Test"},{default:l(()=>[n("div",null,[s(r,{class:"mt-5 justify-content-center"},{default:l(()=>[t[15]||(t[15]=a(" User System Test ")),s(m,{onClick:t[2]||(t[2]=i=>e.runUserSystemTest())},{default:l(()=>t[14]||(t[14]=[a("Go")])),_:1}),n("pre",null,o(e.userSystemTestResult),1)]),_:1})])]),_:1}),s(d,{title:"Custom Request"},{default:l(()=>[s(r,{class:"container"},{default:l(()=>[s(p,{class:"mb-2"},{default:l(()=>[s(f,{class:"col"},{default:l(()=>[n("div",null,[t[17]||(t[17]=n("div",{class:"my-2"}," Path ",-1)),s(g,{modelValue:e.path,"onUpdate:modelValue":t[3]||(t[3]=i=>e.path=i),class:"my-2"},null,8,["modelValue"]),t[18]||(t[18]=n("div",{class:"my-2"}," Data (JSON formatted) ",-1)),h(n("textarea",{"onUpdate:modelValue":t[4]||(t[4]=i=>e.data=i),class:"my-2"},null,512),[[S,e.data]]),n("div",M,[s(m,{disabled:e.loading,onClick:e.run},{default:l(()=>t[16]||(t[16]=[a("Run ")])),_:1},8,["disabled","onClick"])])])]),_:1})]),_:1})]),_:1}),s(r,{class:"mt-5 justify-content-center"},{default:l(()=>[a(" Loading:"+o(e.loading)+" ",1),t[19]||(t[19]=n("br",null,null,-1)),n("pre",null,o(e.logOutput),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),e.errorMessage?(y(),b("div",R,[s(D,{variant:"danger","model-value":!0},{default:l(()=>[a(o(e.errorMessage),1)]),_:1})])):w("",!0)])}const J=C(k,[["render",V]]);export{J as default};
