import{P as U}from"./TIIconDefaultBACySpee.js";import{U as P}from"./UpdatePinD8X1bciL.js";import{a as C,_ as w}from"./components.globalSAVxUKYX.js";import{d as x,j as n,K as r,z as l,N as I,k as a,F as m,P as $,m as M,s as p,r as i,i as t,X as V,Q as u,R as f}from"./@vueC3Nhqlrl.js";const N=x({name:"PermissionOverride",mixins:[C],components:{UpdatePin:P,ProfileImage:U},data(){return{loading:!1,errorMessage:null,pinpass:null,selectedUser:null,loginType:null,loginPayload:null}},mounted(){},computed:{adminUsers(){var e;return(e=this.users)==null?void 0:e.filter(s=>s.type=="admin")}},methods:{async executeCheck(){var e;try{const s=await this.apiReq("/client/auth/permissionOverride",{userId:(e=this.selectedUser)==null?void 0:e._id,pinpass:this.pinpass});console.log("Permission Override Response",s);const{tokenData:d,targetUserId:c}=s.result;await this.setPermissionOverrideInfo({tokenData:d,targetUserId:c}),this.$emit("success")}catch(s){this.errorMessage=s.message}},selectUser(e){this.pinpass=null,this.errorMessage=null,e&&(this.selectedUser=e)},loadPage(){this.loading=!1,this.selectedUser=null,this.pinpass=null,this.errorMessage=null,this.RefreshUsers()}},created(){this.loadPage()}}),O={key:0},j={key:0},B={class:"d-flex justify-content-end"},R={key:1},D={key:0},K={key:1},L={class:"d-flex justify-content-around align-items-center flex-wrap mt-4"},S=["data-test-id","onClick"],T={class:"d-flex flex-column justify-content-center p-3"},E={class:"text-center"},F={class:"mt-2 text-center"},q={key:1,class:"text-center m-4"};function z(e,s,d,c,Q,X){const h=i("b-form-input"),_=i("b-button"),g=i("b-form"),v=i("ProfileImage"),y=i("b-spinner"),k=i("b-alert");return t(),n("div",null,[e.loading?(t(),n("div",q,[r(y,{class:"spinnerxl",label:"Loading..."})])):(t(),n("div",O,[e.selectedUser?(t(),n("div",j,[r(g,{onSubmit:I(e.executeCheck,["prevent"])},{default:l(()=>[r(h,{autofocus:"",type:"password",modelValue:e.pinpass,"onUpdate:modelValue":s[0]||(s[0]=o=>e.pinpass=o),placeholder:"Enter PIN or Password",onKeyup:s[1]||(s[1]=V(o=>e.executeCheck(),["enter"]))},null,8,["modelValue"]),a("div",B,[r(_,{variant:"outline-primary",class:"mt-4",onClick:s[2]||(s[2]=o=>e.executeCheck())},{default:l(()=>s[3]||(s[3]=[u("Continue")])),_:1})])]),_:1},8,["onSubmit"])])):(t(),n("div",R,[e.loadingUsers?(t(),n("div",D,"Loading...")):(t(),n("div",K,[a("div",L,[(t(!0),n(m,null,$(e.adminUsers,(o,b)=>(t(),n(m,null,[e.currentUser&&o._id!=e.currentUser._id?(t(),n("div",{"data-test-id":`switch${o.username}Option`,onClick:A=>e.selectUser(o),role:"button",key:b,class:"d-flex justify-content-center m-2 p-2 border rounded",style:{"max-width":"120px",height:"120px"}},[a("div",T,[a("div",E,[r(v,{profileImage:o.profileImage,width:50},null,8,["profileImage"])]),a("div",F,f(e.textTruncate(o.username,10)),1)])],8,S)):p("",!0)],64))),256))])]))]))])),e.errorMessage?(t(),M(k,{key:2,class:"m-4",variant:"danger","model-value":!0},{default:l(()=>[u(f(e.errorMessage),1)]),_:1})):p("",!0)])}const Y=w(N,[["render",z]]);export{Y as P};
