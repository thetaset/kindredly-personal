import{a as _,ao as T,t as z,p as F,x as B,av as C,_ as y,A}from"./components.globalBic2x0kT.js";import{d as h,j as n,F as k,P as b,s as r,r as m,i as t,k as o,m as l,R as u,K as g,z as v}from"./@vueC3Nhqlrl.js";import{u as P}from"./upload.mixinCdGnd8mT.js";const I=h({name:"SharePrompt",mixins:[_],components:{},data(){return{showDebug:!1,loading:!1,processing:!1}},mounted(){},computed:{itemList(){return this.tempShareData}},methods:{removeShareData:T,textTruncate:z,prettyTimePast:F,clearTempShareData:B,getItemPreview(e){var s;return(s=e==null?void 0:e.preppedData)!=null&&s.imagePreview?C(e.preppedData.imagePreview,e.preppedData.imageType||"image/png"):null},tooBig(e){return e>1024*1024*this.config.maxUploadSizeMB},displaySize(e){return(e/1024/1024).toFixed(2)+" MB"}},created(){}}),L={key:0,class:""},U={class:"d-flex flex-gap-1 align-items-center justify-content-between"},j={class:"text-muted small d-flex align-items-center flex-gap-sm"},M={class:"wwrap"},N={key:3,class:"text-danger"},V=["onClick"],E={key:0},R=["src"];function q(e,s,$,w,x,S){const d=m("b-icon");return t(),n("div",null,[e.tempShareData&&e.tempShareData.length>0?(t(),n("div",L,[(t(!0),n(k,null,b(e.itemList,(i,c)=>{var p,a;return t(),n("div",{class:"staticcontainer-sm my-2 mx-2",key:c},[o("div",U,[o("div",null,[o("div",j,[i.data.mimeType.includes("image")?(t(),l(d,{key:0,icon:"image"})):i.data.mimeType.includes("video")?(t(),l(d,{key:1,icon:"film"})):(t(),l(d,{key:2,icon:"file-earmark"})),o("div",M,u(i.data.filename)+" "+u(i.data.size?`(${e.displaySize(i.data.size)})`:""),1),e.tooBig((p=i==null?void 0:i.data)==null?void 0:p.size)?(t(),n("div",N," File too big ")):r("",!0)])]),o("div",{role:"button",onClick:f=>e.removeShareData(c),class:"p-2"},[g(d,{icon:"x-lg"})],8,V)]),(a=i==null?void 0:i.preppedData)!=null&&a.imageType&&i.preppedData.imageType.includes("image")?(t(),n("div",E,[o("img",{src:e.getItemPreview(i),class:"img-fluid rounded",alt:"image"},null,8,R)])):r("",!0)])}),128))])):r("",!0)])}const ie=y(I,[["render",q],["__scopeId","data-v-7adafc69"]]),K=h({name:"UploadItemAttachment",mixins:[_,P],emits:["update"],data(){return{files:null,loading:!1}},mounted(){},computed:{},methods:{selectFiles(e){this.files=e.target.files},async upload(){try{this.loading=!0;for(let e=0;e<this.files.length;e++){const s=this.files[e];await A({type:"file",data:{filename:s.name,size:s.size,mimeType:s.type,path:"",file:s}})}this.showToast("Attachment(s) uploaded successfully",{variant:"success"}),this.$emit("update")}catch(e){console.error(e),this.showToast("Error uploading attachment(s)",{variant:"danger"})}finally{this.loading=!1}},mounted(){},close(){}},created(){}}),G={class:"mt-4"},H={key:0,class:"mt-4"},J={class:"me-2"},O={class:"w-100"},Q={class:"small"},W={key:0,class:"small text"},X={class:"mt-4 d-flex align-items-center justify-content-between"},Y={key:1};function Z(e,s,$,w,x,S){const d=m("b-form-group"),i=m("b-icon"),c=m("b-spinner"),p=m("b-button");return t(),n("div",null,[o("div",G,[g(d,{class:"form-group",label:"",description:"upload one or more attachments for this item"},{default:v(()=>[o("input",{ref:"fileInput",multiple:"",class:"form-control",type:"file",onChange:s[0]||(s[0]=(...a)=>e.selectFiles&&e.selectFiles(...a)),accept:"image/jpeg, image/png, image/gif, video/mp4, video/quicktime, video/x-msvideo, video/x-ms-wmv, video/x-flv, video/webm, video/3gpp, video/3gpp2, video/avi, video/mpeg, video/ogg, video/x-matroska, video/x-ms-asf"},null,544)]),_:1}),e.files&&e.files.length?(t(),n("div",H,[(t(!0),n(k,null,b(e.files,(a,f)=>(t(),n("div",{key:f,class:"d-flex align-items-center"},[o("div",J,[a.type.includes("image")?(t(),l(i,{key:0,icon:"image",variant:"primary"})):a.type.includes("video")?(t(),l(i,{key:1,icon:"film",variant:"primary"})):(t(),l(i,{key:2,icon:"file-earmark",variant:"primary"}))]),o("div",O,[o("div",Q,u(a.name),1),a.size>4e7?(t(),n("div",W,s[1]||(s[1]=[o("span",{class:"text-danger"},"File size exceeds 40MB",-1)]))):r("",!0)])]))),128))])):r("",!0),o("div",X,[g(p,{class:"ms-auto",onClick:e.upload,variant:"primary",disabled:e.loading},{default:v(()=>[e.loading?(t(),l(c,{key:0,small:""})):(t(),n("span",Y,"Select"))]),_:1},8,["onClick","disabled"])])])])}const se=y(K,[["render",Z]]);export{ie as S,se as U};
